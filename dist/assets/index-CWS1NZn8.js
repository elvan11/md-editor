var Nu=n=>{throw TypeError(n)};var ho=(n,t,e)=>t.has(n)||Nu("Cannot "+e);var Bt=(n,t,e)=>(ho(n,t,"read from private field"),e?e.call(n):t.get(n)),sn=(n,t,e)=>t.has(n)?Nu("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),De=(n,t,e,i)=>(ho(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e),rn=(n,t,e)=>(ho(n,t,"access private method"),e);var Bu=(n,t,e,i)=>({set _(s){De(n,t,s,e)},get _(){return Bt(n,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();function Pa(n){const t=Object.create(null);for(const e of n.split(","))t[e]=1;return e=>e in t}const Pt={},ki=[],gn=()=>{},Ec=()=>!1,Nr=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Fa=n=>n.startsWith("onUpdate:"),ge=Object.assign,Ra=(n,t)=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)},df=Object.prototype.hasOwnProperty,kt=(n,t)=>df.call(n,t),ht=Array.isArray,Di=n=>Br(n)==="[object Map]",Cc=n=>Br(n)==="[object Set]",ft=n=>typeof n=="function",Jt=n=>typeof n=="string",Ln=n=>typeof n=="symbol",Gt=n=>n!==null&&typeof n=="object",Sc=n=>(Gt(n)||ft(n))&&ft(n.then)&&ft(n.catch),Tc=Object.prototype.toString,Br=n=>Tc.call(n),ff=n=>Br(n).slice(8,-1),kc=n=>Br(n)==="[object Object]",Ia=n=>Jt(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,fs=Pa(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ur=n=>{const t=Object.create(null);return(e=>t[e]||(t[e]=n(e)))},pf=/-\w/g,qn=Ur(n=>n.replace(pf,t=>t.slice(1).toUpperCase())),gf=/\B([A-Z])/g,ci=Ur(n=>n.replace(gf,"-$1").toLowerCase()),Dc=Ur(n=>n.charAt(0).toUpperCase()+n.slice(1)),fo=Ur(n=>n?`on${Dc(n)}`:""),Wn=(n,t)=>!Object.is(n,t),hr=(n,...t)=>{for(let e=0;e<n.length;e++)n[e](...t)},Mc=(n,t,e,i=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:i,value:e})},Zo=n=>{const t=parseFloat(n);return isNaN(t)?n:t};let Uu;const Hr=()=>Uu||(Uu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function La(n){if(ht(n)){const t={};for(let e=0;e<n.length;e++){const i=n[e],s=Jt(i)?Af(i):La(i);if(s)for(const r in s)t[r]=s[r]}return t}else if(Jt(n)||Gt(n))return n}const mf=/;(?![^(]*\))/g,bf=/:([^]+)/,yf=/\/\*[^]*?\*\//g;function Af(n){const t={};return n.replace(yf,"").split(mf).forEach(e=>{if(e){const i=e.split(bf);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function ri(n){let t="";if(Jt(n))t=n;else if(ht(n))for(let e=0;e<n.length;e++){const i=ri(n[e]);i&&(t+=i+" ")}else if(Gt(n))for(const e in n)n[e]&&(t+=e+" ");return t.trim()}const _f="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",xf=Pa(_f);function Pc(n){return!!n||n===""}const Fc=n=>!!(n&&n.__v_isRef===!0),dr=n=>Jt(n)?n:n==null?"":ht(n)||Gt(n)&&(n.toString===Tc||!ft(n.toString))?Fc(n)?dr(n.value):JSON.stringify(n,Rc,2):String(n),Rc=(n,t)=>Fc(t)?Rc(n,t.value):Di(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[i,s],r)=>(e[po(i,r)+" =>"]=s,e),{})}:Cc(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>po(e))}:Ln(t)?po(t):Gt(t)&&!ht(t)&&!kc(t)?String(t):t,po=(n,t="")=>{var e;return Ln(n)?`Symbol(${(e=n.description)!=null?e:t})`:n};let Pe;class wf{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Pe,!t&&Pe&&(this.index=(Pe.scopes||(Pe.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Pe;try{return Pe=this,t()}finally{Pe=e}}}on(){++this._on===1&&(this.prevScope=Pe,Pe=this)}off(){this._on>0&&--this._on===0&&(Pe=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let e,i;for(e=0,i=this.effects.length;e<i;e++)this.effects[e].stop();for(this.effects.length=0,e=0,i=this.cleanups.length;e<i;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function vf(){return Pe}let Rt;const go=new WeakSet;class Ic{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Pe&&Pe.active&&Pe.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,go.has(this)&&(go.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Oc(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Hu(this),Nc(this);const t=Rt,e=Ze;Rt=this,Ze=!0;try{return this.fn()}finally{Bc(this),Rt=t,Ze=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Ba(t);this.deps=this.depsTail=void 0,Hu(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?go.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Jo(this)&&this.run()}get dirty(){return Jo(this)}}let Lc=0,ps,gs;function Oc(n,t=!1){if(n.flags|=8,t){n.next=gs,gs=n;return}n.next=ps,ps=n}function Oa(){Lc++}function Na(){if(--Lc>0)return;if(gs){let t=gs;for(gs=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let n;for(;ps;){let t=ps;for(ps=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){n||(n=i)}t=e}}if(n)throw n}function Nc(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Bc(n){let t,e=n.depsTail,i=e;for(;i;){const s=i.prevDep;i.version===-1?(i===e&&(e=s),Ba(i),Ef(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}n.deps=t,n.depsTail=e}function Jo(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Uc(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function Uc(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===xs)||(n.globalVersion=xs,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!Jo(n))))return;n.flags|=2;const t=n.dep,e=Rt,i=Ze;Rt=n,Ze=!0;try{Nc(n);const s=n.fn(n._value);(t.version===0||Wn(s,n._value))&&(n.flags|=128,n._value=s,t.version++)}catch(s){throw t.version++,s}finally{Rt=e,Ze=i,Bc(n),n.flags&=-3}}function Ba(n,t=!1){const{dep:e,prevSub:i,nextSub:s}=n;if(i&&(i.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=i,n.nextSub=void 0),e.subs===n&&(e.subs=i,!i&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)Ba(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function Ef(n){const{prevDep:t,nextDep:e}=n;t&&(t.nextDep=e,n.prevDep=void 0),e&&(e.prevDep=t,n.nextDep=void 0)}let Ze=!0;const Hc=[];function Fn(){Hc.push(Ze),Ze=!1}function Rn(){const n=Hc.pop();Ze=n===void 0?!0:n}function Hu(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const e=Rt;Rt=void 0;try{t()}finally{Rt=e}}}let xs=0;class Cf{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ua{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Rt||!Ze||Rt===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==Rt)e=this.activeLink=new Cf(Rt,this),Rt.deps?(e.prevDep=Rt.depsTail,Rt.depsTail.nextDep=e,Rt.depsTail=e):Rt.deps=Rt.depsTail=e,zc(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const i=e.nextDep;i.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=i),e.prevDep=Rt.depsTail,e.nextDep=void 0,Rt.depsTail.nextDep=e,Rt.depsTail=e,Rt.deps===e&&(Rt.deps=i)}return e}trigger(t){this.version++,xs++,this.notify(t)}notify(t){Oa();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Na()}}}function zc(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)zc(i)}const e=n.dep.subs;e!==n&&(n.prevSub=e,e&&(e.nextSub=n)),n.dep.subs=n}}const Qo=new WeakMap,oi=Symbol(""),ta=Symbol(""),ws=Symbol("");function de(n,t,e){if(Ze&&Rt){let i=Qo.get(n);i||Qo.set(n,i=new Map);let s=i.get(e);s||(i.set(e,s=new Ua),s.map=i,s.key=e),s.track()}}function Dn(n,t,e,i,s,r){const o=Qo.get(n);if(!o){xs++;return}const a=u=>{u&&u.trigger()};if(Oa(),t==="clear")o.forEach(a);else{const u=ht(n),l=u&&Ia(e);if(u&&e==="length"){const c=Number(i);o.forEach((h,d)=>{(d==="length"||d===ws||!Ln(d)&&d>=c)&&a(h)})}else switch((e!==void 0||o.has(void 0))&&a(o.get(e)),l&&a(o.get(ws)),t){case"add":u?l&&a(o.get("length")):(a(o.get(oi)),Di(n)&&a(o.get(ta)));break;case"delete":u||(a(o.get(oi)),Di(n)&&a(o.get(ta)));break;case"set":Di(n)&&a(o.get(oi));break}}Na()}function mi(n){const t=Tt(n);return t===n?t:(de(t,"iterate",ws),Je(n)?t:t.map(xe))}function Ha(n){return de(n=Tt(n),"iterate",ws),n}const Sf={__proto__:null,[Symbol.iterator](){return mo(this,Symbol.iterator,xe)},concat(...n){return mi(this).concat(...n.map(t=>ht(t)?mi(t):t))},entries(){return mo(this,"entries",n=>(n[1]=xe(n[1]),n))},every(n,t){return wn(this,"every",n,t,void 0,arguments)},filter(n,t){return wn(this,"filter",n,t,e=>e.map(xe),arguments)},find(n,t){return wn(this,"find",n,t,xe,arguments)},findIndex(n,t){return wn(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return wn(this,"findLast",n,t,xe,arguments)},findLastIndex(n,t){return wn(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return wn(this,"forEach",n,t,void 0,arguments)},includes(...n){return bo(this,"includes",n)},indexOf(...n){return bo(this,"indexOf",n)},join(n){return mi(this).join(n)},lastIndexOf(...n){return bo(this,"lastIndexOf",n)},map(n,t){return wn(this,"map",n,t,void 0,arguments)},pop(){return Yi(this,"pop")},push(...n){return Yi(this,"push",n)},reduce(n,...t){return zu(this,"reduce",n,t)},reduceRight(n,...t){return zu(this,"reduceRight",n,t)},shift(){return Yi(this,"shift")},some(n,t){return wn(this,"some",n,t,void 0,arguments)},splice(...n){return Yi(this,"splice",n)},toReversed(){return mi(this).toReversed()},toSorted(n){return mi(this).toSorted(n)},toSpliced(...n){return mi(this).toSpliced(...n)},unshift(...n){return Yi(this,"unshift",n)},values(){return mo(this,"values",xe)}};function mo(n,t,e){const i=Ha(n),s=i[t]();return i!==n&&!Je(n)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.value&&(r.value=e(r.value)),r}),s}const Tf=Array.prototype;function wn(n,t,e,i,s,r){const o=Ha(n),a=o!==n&&!Je(n),u=o[t];if(u!==Tf[t]){const h=u.apply(n,r);return a?xe(h):h}let l=e;o!==n&&(a?l=function(h,d){return e.call(this,xe(h),d,n)}:e.length>2&&(l=function(h,d){return e.call(this,h,d,n)}));const c=u.call(o,l,i);return a&&s?s(c):c}function zu(n,t,e,i){const s=Ha(n);let r=e;return s!==n&&(Je(n)?e.length>3&&(r=function(o,a,u){return e.call(this,o,a,u,n)}):r=function(o,a,u){return e.call(this,o,xe(a),u,n)}),s[t](r,...i)}function bo(n,t,e){const i=Tt(n);de(i,"iterate",ws);const s=i[t](...e);return(s===-1||s===!1)&&Ga(e[0])?(e[0]=Tt(e[0]),i[t](...e)):s}function Yi(n,t,e=[]){Fn(),Oa();const i=Tt(n)[t].apply(n,e);return Na(),Rn(),i}const kf=Pa("__proto__,__v_isRef,__isVue"),$c=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Ln));function Df(n){Ln(n)||(n=String(n));const t=Tt(this);return de(t,"has",n),t.hasOwnProperty(n)}class jc{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,i){if(e==="__v_skip")return t.__v_skip;const s=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!s;if(e==="__v_isReadonly")return s;if(e==="__v_isShallow")return r;if(e==="__v_raw")return i===(s?r?Uf:qc:r?Wc:Vc).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const o=ht(t);if(!s){let u;if(o&&(u=Sf[e]))return u;if(e==="hasOwnProperty")return Df}const a=Reflect.get(t,e,pe(t)?t:i);return(Ln(e)?$c.has(e):kf(e))||(s||de(t,"get",e),r)?a:pe(a)?o&&Ia(e)?a:a.value:Gt(a)?s?Xc(a):$a(a):a}}class Gc extends jc{constructor(t=!1){super(!1,t)}set(t,e,i,s){let r=t[e];if(!this._isShallow){const u=ai(r);if(!Je(i)&&!ai(i)&&(r=Tt(r),i=Tt(i)),!ht(t)&&pe(r)&&!pe(i))return u||(r.value=i),!0}const o=ht(t)&&Ia(e)?Number(e)<t.length:kt(t,e),a=Reflect.set(t,e,i,pe(t)?t:s);return t===Tt(s)&&(o?Wn(i,r)&&Dn(t,"set",e,i):Dn(t,"add",e,i)),a}deleteProperty(t,e){const i=kt(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&i&&Dn(t,"delete",e,void 0),s}has(t,e){const i=Reflect.has(t,e);return(!Ln(e)||!$c.has(e))&&de(t,"has",e),i}ownKeys(t){return de(t,"iterate",ht(t)?"length":oi),Reflect.ownKeys(t)}}class Mf extends jc{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const Pf=new Gc,Ff=new Mf,Rf=new Gc(!0);const ea=n=>n,Xs=n=>Reflect.getPrototypeOf(n);function If(n,t,e){return function(...i){const s=this.__v_raw,r=Tt(s),o=Di(r),a=n==="entries"||n===Symbol.iterator&&o,u=n==="keys"&&o,l=s[n](...i),c=e?ea:t?na:xe;return!t&&de(r,"iterate",u?ta:oi),{next(){const{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:a?[c(h[0]),c(h[1])]:c(h),done:d}},[Symbol.iterator](){return this}}}}function Ys(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function Lf(n,t){const e={get(s){const r=this.__v_raw,o=Tt(r),a=Tt(s);n||(Wn(s,a)&&de(o,"get",s),de(o,"get",a));const{has:u}=Xs(o),l=t?ea:n?na:xe;if(u.call(o,s))return l(r.get(s));if(u.call(o,a))return l(r.get(a));r!==o&&r.get(s)},get size(){const s=this.__v_raw;return!n&&de(Tt(s),"iterate",oi),s.size},has(s){const r=this.__v_raw,o=Tt(r),a=Tt(s);return n||(Wn(s,a)&&de(o,"has",s),de(o,"has",a)),s===a?r.has(s):r.has(s)||r.has(a)},forEach(s,r){const o=this,a=o.__v_raw,u=Tt(a),l=t?ea:n?na:xe;return!n&&de(u,"iterate",oi),a.forEach((c,h)=>s.call(r,l(c),l(h),o))}};return ge(e,n?{add:Ys("add"),set:Ys("set"),delete:Ys("delete"),clear:Ys("clear")}:{add(s){!t&&!Je(s)&&!ai(s)&&(s=Tt(s));const r=Tt(this);return Xs(r).has.call(r,s)||(r.add(s),Dn(r,"add",s,s)),this},set(s,r){!t&&!Je(r)&&!ai(r)&&(r=Tt(r));const o=Tt(this),{has:a,get:u}=Xs(o);let l=a.call(o,s);l||(s=Tt(s),l=a.call(o,s));const c=u.call(o,s);return o.set(s,r),l?Wn(r,c)&&Dn(o,"set",s,r):Dn(o,"add",s,r),this},delete(s){const r=Tt(this),{has:o,get:a}=Xs(r);let u=o.call(r,s);u||(s=Tt(s),u=o.call(r,s)),a&&a.call(r,s);const l=r.delete(s);return u&&Dn(r,"delete",s,void 0),l},clear(){const s=Tt(this),r=s.size!==0,o=s.clear();return r&&Dn(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=If(s,n,t)}),e}function za(n,t){const e=Lf(n,t);return(i,s,r)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?i:Reflect.get(kt(e,s)&&s in i?e:i,s,r)}const Of={get:za(!1,!1)},Nf={get:za(!1,!0)},Bf={get:za(!0,!1)};const Vc=new WeakMap,Wc=new WeakMap,qc=new WeakMap,Uf=new WeakMap;function Hf(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function zf(n){return n.__v_skip||!Object.isExtensible(n)?0:Hf(ff(n))}function $a(n){return ai(n)?n:ja(n,!1,Pf,Of,Vc)}function $f(n){return ja(n,!1,Rf,Nf,Wc)}function Xc(n){return ja(n,!0,Ff,Bf,qc)}function ja(n,t,e,i,s){if(!Gt(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const r=zf(n);if(r===0)return n;const o=s.get(n);if(o)return o;const a=new Proxy(n,r===2?i:e);return s.set(n,a),a}function ms(n){return ai(n)?ms(n.__v_raw):!!(n&&n.__v_isReactive)}function ai(n){return!!(n&&n.__v_isReadonly)}function Je(n){return!!(n&&n.__v_isShallow)}function Ga(n){return n?!!n.__v_raw:!1}function Tt(n){const t=n&&n.__v_raw;return t?Tt(t):n}function jf(n){return!kt(n,"__v_skip")&&Object.isExtensible(n)&&Mc(n,"__v_skip",!0),n}const xe=n=>Gt(n)?$a(n):n,na=n=>Gt(n)?Xc(n):n;function pe(n){return n?n.__v_isRef===!0:!1}function Zn(n){return Gf(n,!1)}function Gf(n,t){return pe(n)?n:new Vf(n,t)}class Vf{constructor(t,e){this.dep=new Ua,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:Tt(t),this._value=e?t:xe(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,i=this.__v_isShallow||Je(t)||ai(t);t=i?t:Tt(t),Wn(t,e)&&(this._rawValue=t,this._value=i?t:xe(t),this.dep.trigger())}}function Wf(n){return pe(n)?n.value:n}const qf={get:(n,t,e)=>t==="__v_raw"?n:Wf(Reflect.get(n,t,e)),set:(n,t,e,i)=>{const s=n[t];return pe(s)&&!pe(e)?(s.value=e,!0):Reflect.set(n,t,e,i)}};function Yc(n){return ms(n)?n:new Proxy(n,qf)}class Xf{constructor(t,e,i){this.fn=t,this.setter=e,this._value=void 0,this.dep=new Ua(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=xs-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Rt!==this)return Oc(this,!0),!0}get value(){const t=this.dep.track();return Uc(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Yf(n,t,e=!1){let i,s;return ft(n)?i=n:(i=n.get,s=n.set),new Xf(i,s,e)}const Ks={},xr=new WeakMap;let ti;function Kf(n,t=!1,e=ti){if(e){let i=xr.get(e);i||xr.set(e,i=[]),i.push(n)}}function Zf(n,t,e=Pt){const{immediate:i,deep:s,once:r,scheduler:o,augmentJob:a,call:u}=e,l=_=>s?_:Je(_)||s===!1||s===0?Mn(_,1):Mn(_);let c,h,d,f,p=!1,g=!1;if(pe(n)?(h=()=>n.value,p=Je(n)):ms(n)?(h=()=>l(n),p=!0):ht(n)?(g=!0,p=n.some(_=>ms(_)||Je(_)),h=()=>n.map(_=>{if(pe(_))return _.value;if(ms(_))return l(_);if(ft(_))return u?u(_,2):_()})):ft(n)?t?h=u?()=>u(n,2):n:h=()=>{if(d){Fn();try{d()}finally{Rn()}}const _=ti;ti=c;try{return u?u(n,3,[f]):n(f)}finally{ti=_}}:h=gn,t&&s){const _=h,x=s===!0?1/0:s;h=()=>Mn(_(),x)}const b=vf(),m=()=>{c.stop(),b&&b.active&&Ra(b.effects,c)};if(r&&t){const _=t;t=(...x)=>{_(...x),m()}}let A=g?new Array(n.length).fill(Ks):Ks;const y=_=>{if(!(!(c.flags&1)||!c.dirty&&!_))if(t){const x=c.run();if(s||p||(g?x.some((v,S)=>Wn(v,A[S])):Wn(x,A))){d&&d();const v=ti;ti=c;try{const S=[x,A===Ks?void 0:g&&A[0]===Ks?[]:A,f];A=x,u?u(t,3,S):t(...S)}finally{ti=v}}}else c.run()};return a&&a(y),c=new Ic(h),c.scheduler=o?()=>o(y,!1):y,f=_=>Kf(_,!1,c),d=c.onStop=()=>{const _=xr.get(c);if(_){if(u)u(_,4);else for(const x of _)x();xr.delete(c)}},t?i?y(!0):A=c.run():o?o(y.bind(null,!0),!0):c.run(),m.pause=c.pause.bind(c),m.resume=c.resume.bind(c),m.stop=m,m}function Mn(n,t=1/0,e){if(t<=0||!Gt(n)||n.__v_skip||(e=e||new Map,(e.get(n)||0)>=t))return n;if(e.set(n,t),t--,pe(n))Mn(n.value,t,e);else if(ht(n))for(let i=0;i<n.length;i++)Mn(n[i],t,e);else if(Cc(n)||Di(n))n.forEach(i=>{Mn(i,t,e)});else if(kc(n)){for(const i in n)Mn(n[i],t,e);for(const i of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,i)&&Mn(n[i],t,e)}return n}function Ls(n,t,e,i){try{return i?n(...i):n()}catch(s){zr(s,t,e)}}function mn(n,t,e,i){if(ft(n)){const s=Ls(n,t,e,i);return s&&Sc(s)&&s.catch(r=>{zr(r,t,e)}),s}if(ht(n)){const s=[];for(let r=0;r<n.length;r++)s.push(mn(n[r],t,e,i));return s}}function zr(n,t,e,i=!0){const s=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||Pt;if(t){let a=t.parent;const u=t.proxy,l=`https://vuejs.org/error-reference/#runtime-${e}`;for(;a;){const c=a.ec;if(c){for(let h=0;h<c.length;h++)if(c[h](n,u,l)===!1)return}a=a.parent}if(r){Fn(),Ls(r,null,10,[n,u,l]),Rn();return}}Jf(n,e,s,i,o)}function Jf(n,t,e,i=!0,s=!1){if(s)throw n;console.error(n)}const we=[];let ln=-1;const Mi=[];let Un=null,Ai=0;const Kc=Promise.resolve();let wr=null;function Qf(n){const t=wr||Kc;return n?t.then(this?n.bind(this):n):t}function t0(n){let t=ln+1,e=we.length;for(;t<e;){const i=t+e>>>1,s=we[i],r=vs(s);r<n||r===n&&s.flags&2?t=i+1:e=i}return t}function Va(n){if(!(n.flags&1)){const t=vs(n),e=we[we.length-1];!e||!(n.flags&2)&&t>=vs(e)?we.push(n):we.splice(t0(t),0,n),n.flags|=1,Zc()}}function Zc(){wr||(wr=Kc.then(Qc))}function e0(n){ht(n)?Mi.push(...n):Un&&n.id===-1?Un.splice(Ai+1,0,n):n.flags&1||(Mi.push(n),n.flags|=1),Zc()}function $u(n,t,e=ln+1){for(;e<we.length;e++){const i=we[e];if(i&&i.flags&2){if(n&&i.id!==n.uid)continue;we.splice(e,1),e--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Jc(n){if(Mi.length){const t=[...new Set(Mi)].sort((e,i)=>vs(e)-vs(i));if(Mi.length=0,Un){Un.push(...t);return}for(Un=t,Ai=0;Ai<Un.length;Ai++){const e=Un[Ai];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}Un=null,Ai=0}}const vs=n=>n.id==null?n.flags&2?-1:1/0:n.id;function Qc(n){try{for(ln=0;ln<we.length;ln++){const t=we[ln];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ls(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;ln<we.length;ln++){const t=we[ln];t&&(t.flags&=-2)}ln=-1,we.length=0,Jc(),wr=null,(we.length||Mi.length)&&Qc()}}let fe=null,th=null;function vr(n){const t=fe;return fe=n,th=n&&n.type.__scopeId||null,t}function eh(n,t=fe,e){if(!t||n._n)return n;const i=(...s)=>{i._d&&Ju(-1);const r=vr(t);let o;try{o=n(...s)}finally{vr(r),i._d&&Ju(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function n0(n,t){if(fe===null)return n;const e=Vr(fe),i=n.dirs||(n.dirs=[]);for(let s=0;s<t.length;s++){let[r,o,a,u=Pt]=t[s];r&&(ft(r)&&(r={mounted:r,updated:r}),r.deep&&Mn(o),i.push({dir:r,instance:e,value:o,oldValue:void 0,arg:a,modifiers:u}))}return n}function Jn(n,t,e,i){const s=n.dirs,r=t&&t.dirs;for(let o=0;o<s.length;o++){const a=s[o];r&&(a.oldValue=r[o].value);let u=a.dir[i];u&&(Fn(),mn(u,e,8,[n.el,a,n,t]),Rn())}}const i0=Symbol("_vte"),s0=n=>n.__isTeleport,r0=Symbol("_leaveCb");function Wa(n,t){n.shapeFlag&6&&n.component?(n.transition=t,Wa(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function nh(n,t){return ft(n)?ge({name:n.name},t,{setup:n}):n}function ih(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}const Er=new WeakMap;function bs(n,t,e,i,s=!1){if(ht(n)){n.forEach((p,g)=>bs(p,t&&(ht(t)?t[g]:t),e,i,s));return}if(Pi(i)&&!s){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&bs(n,t,e,i.component.subTree);return}const r=i.shapeFlag&4?Vr(i.component):i.el,o=s?null:r,{i:a,r:u}=n,l=t&&t.r,c=a.refs===Pt?a.refs={}:a.refs,h=a.setupState,d=Tt(h),f=h===Pt?Ec:p=>kt(d,p);if(l!=null&&l!==u){if(ju(t),Jt(l))c[l]=null,f(l)&&(h[l]=null);else if(pe(l)){l.value=null;const p=t;p.k&&(c[p.k]=null)}}if(ft(u))Ls(u,a,12,[o,c]);else{const p=Jt(u),g=pe(u);if(p||g){const b=()=>{if(n.f){const m=p?f(u)?h[u]:c[u]:u.value;if(s)ht(m)&&Ra(m,r);else if(ht(m))m.includes(r)||m.push(r);else if(p)c[u]=[r],f(u)&&(h[u]=c[u]);else{const A=[r];u.value=A,n.k&&(c[n.k]=A)}}else p?(c[u]=o,f(u)&&(h[u]=o)):g&&(u.value=o,n.k&&(c[n.k]=o))};if(o){const m=()=>{b(),Er.delete(n)};m.id=-1,Er.set(n,m),Le(m,e)}else ju(n),b()}}}function ju(n){const t=Er.get(n);t&&(t.flags|=8,Er.delete(n))}Hr().requestIdleCallback;Hr().cancelIdleCallback;const Pi=n=>!!n.type.__asyncLoader,sh=n=>n.type.__isKeepAlive;function o0(n,t){rh(n,"a",t)}function a0(n,t){rh(n,"da",t)}function rh(n,t,e=ve){const i=n.__wdc||(n.__wdc=()=>{let s=e;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if($r(t,i,e),e){let s=e.parent;for(;s&&s.parent;)sh(s.parent.vnode)&&u0(i,t,e,s),s=s.parent}}function u0(n,t,e,i){const s=$r(t,n,i,!0);uh(()=>{Ra(i[t],s)},e)}function $r(n,t,e=ve,i=!1){if(e){const s=e[n]||(e[n]=[]),r=t.__weh||(t.__weh=(...o)=>{Fn();const a=Os(e),u=mn(t,e,n,o);return a(),Rn(),u});return i?s.unshift(r):s.push(r),r}}const On=n=>(t,e=ve)=>{(!Cs||n==="sp")&&$r(n,(...i)=>t(...i),e)},l0=On("bm"),oh=On("m"),c0=On("bu"),h0=On("u"),ah=On("bum"),uh=On("um"),d0=On("sp"),f0=On("rtg"),p0=On("rtc");function g0(n,t=ve){$r("ec",n,t)}const m0=Symbol.for("v-ndc");function b0(n,t,e={},i,s){if(fe.ce||fe.parent&&Pi(fe.parent)&&fe.parent.ce)return Pn(),aa(Ve,null,[Qe("slot",e,i)],64);let r=n[t];r&&r._c&&(r._d=!1),Pn();const o=r&&lh(r(e)),a=e.key||o&&o.key,u=aa(Ve,{key:(a&&!Ln(a)?a:`_${t}`)+(!o&&i?"_fb":"")},o||[],o&&n._===1?64:-2);return u.scopeId&&(u.slotScopeIds=[u.scopeId+"-s"]),r&&r._c&&(r._d=!0),u}function lh(n){return n.some(t=>Ya(t)?!(t.type===In||t.type===Ve&&!lh(t.children)):!0)?n:null}const ia=n=>n?Mh(n)?Vr(n):ia(n.parent):null,ys=ge(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>ia(n.parent),$root:n=>ia(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>hh(n),$forceUpdate:n=>n.f||(n.f=()=>{Va(n.update)}),$nextTick:n=>n.n||(n.n=Qf.bind(n.proxy)),$watch:n=>U0.bind(n)}),yo=(n,t)=>n!==Pt&&!n.__isScriptSetup&&kt(n,t),y0={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:i,data:s,props:r,accessCache:o,type:a,appContext:u}=n;let l;if(t[0]!=="$"){const f=o[t];if(f!==void 0)switch(f){case 1:return i[t];case 2:return s[t];case 4:return e[t];case 3:return r[t]}else{if(yo(i,t))return o[t]=1,i[t];if(s!==Pt&&kt(s,t))return o[t]=2,s[t];if((l=n.propsOptions[0])&&kt(l,t))return o[t]=3,r[t];if(e!==Pt&&kt(e,t))return o[t]=4,e[t];sa&&(o[t]=0)}}const c=ys[t];let h,d;if(c)return t==="$attrs"&&de(n.attrs,"get",""),c(n);if((h=a.__cssModules)&&(h=h[t]))return h;if(e!==Pt&&kt(e,t))return o[t]=4,e[t];if(d=u.config.globalProperties,kt(d,t))return d[t]},set({_:n},t,e){const{data:i,setupState:s,ctx:r}=n;return yo(s,t)?(s[t]=e,!0):i!==Pt&&kt(i,t)?(i[t]=e,!0):kt(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(r[t]=e,!0)},has({_:{data:n,setupState:t,accessCache:e,ctx:i,appContext:s,propsOptions:r,type:o}},a){let u,l;return!!(e[a]||n!==Pt&&a[0]!=="$"&&kt(n,a)||yo(t,a)||(u=r[0])&&kt(u,a)||kt(i,a)||kt(ys,a)||kt(s.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(n,t,e){return e.get!=null?n._.accessCache[t]=0:kt(e,"value")&&this.set(n,t,e.value,null),Reflect.defineProperty(n,t,e)}};function Gu(n){return ht(n)?n.reduce((t,e)=>(t[e]=null,t),{}):n}let sa=!0;function A0(n){const t=hh(n),e=n.proxy,i=n.ctx;sa=!1,t.beforeCreate&&Vu(t.beforeCreate,n,"bc");const{data:s,computed:r,methods:o,watch:a,provide:u,inject:l,created:c,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:g,deactivated:b,beforeDestroy:m,beforeUnmount:A,destroyed:y,unmounted:_,render:x,renderTracked:v,renderTriggered:S,errorCaptured:M,serverPrefetch:R,expose:j,inheritAttrs:I,components:Y,directives:dt,filters:et}=t;if(l&&_0(l,i,null),o)for(const O in o){const q=o[O];ft(q)&&(i[O]=q.bind(e))}if(s){const O=s.call(e,e);Gt(O)&&(n.data=$a(O))}if(sa=!0,r)for(const O in r){const q=r[O],At=ft(q)?q.bind(e,e):ft(q.get)?q.get.bind(e,e):gn,Ot=!ft(q)&&ft(q.set)?q.set.bind(e):gn,T=Tr({get:At,set:Ot});Object.defineProperty(i,O,{enumerable:!0,configurable:!0,get:()=>T.value,set:D=>T.value=D})}if(a)for(const O in a)ch(a[O],i,e,O);if(u){const O=ft(u)?u.call(e):u;Reflect.ownKeys(O).forEach(q=>{S0(q,O[q])})}c&&Vu(c,n,"c");function U(O,q){ht(q)?q.forEach(At=>O(At.bind(e))):q&&O(q.bind(e))}if(U(l0,h),U(oh,d),U(c0,f),U(h0,p),U(o0,g),U(a0,b),U(g0,M),U(p0,v),U(f0,S),U(ah,A),U(uh,_),U(d0,R),ht(j))if(j.length){const O=n.exposed||(n.exposed={});j.forEach(q=>{Object.defineProperty(O,q,{get:()=>e[q],set:At=>e[q]=At,enumerable:!0})})}else n.exposed||(n.exposed={});x&&n.render===gn&&(n.render=x),I!=null&&(n.inheritAttrs=I),Y&&(n.components=Y),dt&&(n.directives=dt),R&&ih(n)}function _0(n,t,e=gn){ht(n)&&(n=ra(n));for(const i in n){const s=n[i];let r;Gt(s)?"default"in s?r=fr(s.from||i,s.default,!0):r=fr(s.from||i):r=fr(s),pe(r)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):t[i]=r}}function Vu(n,t,e){mn(ht(n)?n.map(i=>i.bind(t.proxy)):n.bind(t.proxy),t,e)}function ch(n,t,e,i){let s=i.includes(".")?Eh(e,i):()=>e[i];if(Jt(n)){const r=t[n];ft(r)&&pr(s,r)}else if(ft(n))pr(s,n.bind(e));else if(Gt(n))if(ht(n))n.forEach(r=>ch(r,t,e,i));else{const r=ft(n.handler)?n.handler.bind(e):t[n.handler];ft(r)&&pr(s,r,n)}}function hh(n){const t=n.type,{mixins:e,extends:i}=t,{mixins:s,optionsCache:r,config:{optionMergeStrategies:o}}=n.appContext,a=r.get(t);let u;return a?u=a:!s.length&&!e&&!i?u=t:(u={},s.length&&s.forEach(l=>Cr(u,l,o,!0)),Cr(u,t,o)),Gt(t)&&r.set(t,u),u}function Cr(n,t,e,i=!1){const{mixins:s,extends:r}=t;r&&Cr(n,r,e,!0),s&&s.forEach(o=>Cr(n,o,e,!0));for(const o in t)if(!(i&&o==="expose")){const a=x0[o]||e&&e[o];n[o]=a?a(n[o],t[o]):t[o]}return n}const x0={data:Wu,props:qu,emits:qu,methods:ls,computed:ls,beforeCreate:Ae,created:Ae,beforeMount:Ae,mounted:Ae,beforeUpdate:Ae,updated:Ae,beforeDestroy:Ae,beforeUnmount:Ae,destroyed:Ae,unmounted:Ae,activated:Ae,deactivated:Ae,errorCaptured:Ae,serverPrefetch:Ae,components:ls,directives:ls,watch:v0,provide:Wu,inject:w0};function Wu(n,t){return t?n?function(){return ge(ft(n)?n.call(this,this):n,ft(t)?t.call(this,this):t)}:t:n}function w0(n,t){return ls(ra(n),ra(t))}function ra(n){if(ht(n)){const t={};for(let e=0;e<n.length;e++)t[n[e]]=n[e];return t}return n}function Ae(n,t){return n?[...new Set([].concat(n,t))]:t}function ls(n,t){return n?ge(Object.create(null),n,t):t}function qu(n,t){return n?ht(n)&&ht(t)?[...new Set([...n,...t])]:ge(Object.create(null),Gu(n),Gu(t??{})):t}function v0(n,t){if(!n)return t;if(!t)return n;const e=ge(Object.create(null),n);for(const i in t)e[i]=Ae(n[i],t[i]);return e}function dh(){return{app:null,config:{isNativeTag:Ec,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let E0=0;function C0(n,t){return function(i,s=null){ft(i)||(i=ge({},i)),s!=null&&!Gt(s)&&(s=null);const r=dh(),o=new WeakSet,a=[];let u=!1;const l=r.app={_uid:E0++,_component:i,_props:s,_container:null,_context:r,_instance:null,version:ap,get config(){return r.config},set config(c){},use(c,...h){return o.has(c)||(c&&ft(c.install)?(o.add(c),c.install(l,...h)):ft(c)&&(o.add(c),c(l,...h))),l},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),l},component(c,h){return h?(r.components[c]=h,l):r.components[c]},directive(c,h){return h?(r.directives[c]=h,l):r.directives[c]},mount(c,h,d){if(!u){const f=l._ceVNode||Qe(i,s);return f.appContext=r,d===!0?d="svg":d===!1&&(d=void 0),n(f,c,d),u=!0,l._container=c,c.__vue_app__=l,Vr(f.component)}},onUnmount(c){a.push(c)},unmount(){u&&(mn(a,l._instance,16),n(null,l._container),delete l._container.__vue_app__)},provide(c,h){return r.provides[c]=h,l},runWithContext(c){const h=Fi;Fi=l;try{return c()}finally{Fi=h}}};return l}}let Fi=null;function S0(n,t){if(ve){let e=ve.provides;const i=ve.parent&&ve.parent.provides;i===e&&(e=ve.provides=Object.create(i)),e[n]=t}}function fr(n,t,e=!1){const i=ep();if(i||Fi){let s=Fi?Fi._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return e&&ft(t)?t.call(i&&i.proxy):t}}const fh={},ph=()=>Object.create(fh),gh=n=>Object.getPrototypeOf(n)===fh;function T0(n,t,e,i=!1){const s={},r=ph();n.propsDefaults=Object.create(null),mh(n,t,s,r);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);e?n.props=i?s:$f(s):n.type.props?n.props=s:n.props=r,n.attrs=r}function k0(n,t,e,i){const{props:s,attrs:r,vnode:{patchFlag:o}}=n,a=Tt(s),[u]=n.propsOptions;let l=!1;if((i||o>0)&&!(o&16)){if(o&8){const c=n.vnode.dynamicProps;for(let h=0;h<c.length;h++){let d=c[h];if(jr(n.emitsOptions,d))continue;const f=t[d];if(u)if(kt(r,d))f!==r[d]&&(r[d]=f,l=!0);else{const p=qn(d);s[p]=oa(u,a,p,f,n,!1)}else f!==r[d]&&(r[d]=f,l=!0)}}}else{mh(n,t,s,r)&&(l=!0);let c;for(const h in a)(!t||!kt(t,h)&&((c=ci(h))===h||!kt(t,c)))&&(u?e&&(e[h]!==void 0||e[c]!==void 0)&&(s[h]=oa(u,a,h,void 0,n,!0)):delete s[h]);if(r!==a)for(const h in r)(!t||!kt(t,h))&&(delete r[h],l=!0)}l&&Dn(n.attrs,"set","")}function mh(n,t,e,i){const[s,r]=n.propsOptions;let o=!1,a;if(t)for(let u in t){if(fs(u))continue;const l=t[u];let c;s&&kt(s,c=qn(u))?!r||!r.includes(c)?e[c]=l:(a||(a={}))[c]=l:jr(n.emitsOptions,u)||(!(u in i)||l!==i[u])&&(i[u]=l,o=!0)}if(r){const u=Tt(e),l=a||Pt;for(let c=0;c<r.length;c++){const h=r[c];e[h]=oa(s,u,h,l[h],n,!kt(l,h))}}return o}function oa(n,t,e,i,s,r){const o=n[e];if(o!=null){const a=kt(o,"default");if(a&&i===void 0){const u=o.default;if(o.type!==Function&&!o.skipFactory&&ft(u)){const{propsDefaults:l}=s;if(e in l)i=l[e];else{const c=Os(s);i=l[e]=u.call(null,t),c()}}else i=u;s.ce&&s.ce._setProp(e,i)}o[0]&&(r&&!a?i=!1:o[1]&&(i===""||i===ci(e))&&(i=!0))}return i}const D0=new WeakMap;function bh(n,t,e=!1){const i=e?D0:t.propsCache,s=i.get(n);if(s)return s;const r=n.props,o={},a=[];let u=!1;if(!ft(n)){const c=h=>{u=!0;const[d,f]=bh(h,t,!0);ge(o,d),f&&a.push(...f)};!e&&t.mixins.length&&t.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}if(!r&&!u)return Gt(n)&&i.set(n,ki),ki;if(ht(r))for(let c=0;c<r.length;c++){const h=qn(r[c]);Xu(h)&&(o[h]=Pt)}else if(r)for(const c in r){const h=qn(c);if(Xu(h)){const d=r[c],f=o[h]=ht(d)||ft(d)?{type:d}:ge({},d),p=f.type;let g=!1,b=!0;if(ht(p))for(let m=0;m<p.length;++m){const A=p[m],y=ft(A)&&A.name;if(y==="Boolean"){g=!0;break}else y==="String"&&(b=!1)}else g=ft(p)&&p.name==="Boolean";f[0]=g,f[1]=b,(g||kt(f,"default"))&&a.push(h)}}const l=[o,a];return Gt(n)&&i.set(n,l),l}function Xu(n){return n[0]!=="$"&&!fs(n)}const qa=n=>n==="_"||n==="_ctx"||n==="$stable",Xa=n=>ht(n)?n.map(dn):[dn(n)],M0=(n,t,e)=>{if(t._n)return t;const i=eh((...s)=>Xa(t(...s)),e);return i._c=!1,i},yh=(n,t,e)=>{const i=n._ctx;for(const s in n){if(qa(s))continue;const r=n[s];if(ft(r))t[s]=M0(s,r,i);else if(r!=null){const o=Xa(r);t[s]=()=>o}}},Ah=(n,t)=>{const e=Xa(t);n.slots.default=()=>e},_h=(n,t,e)=>{for(const i in t)(e||!qa(i))&&(n[i]=t[i])},P0=(n,t,e)=>{const i=n.slots=ph();if(n.vnode.shapeFlag&32){const s=t._;s?(_h(i,t,e),e&&Mc(i,"_",s,!0)):yh(t,i)}else t&&Ah(n,t)},F0=(n,t,e)=>{const{vnode:i,slots:s}=n;let r=!0,o=Pt;if(i.shapeFlag&32){const a=t._;a?e&&a===1?r=!1:_h(s,t,e):(r=!t.$stable,yh(t,s)),o=t}else t&&(Ah(n,t),o={default:1});if(r)for(const a in s)!qa(a)&&o[a]==null&&delete s[a]},Le=q0;function R0(n){return I0(n)}function I0(n,t){const e=Hr();e.__VUE__=!0;const{insert:i,remove:s,patchProp:r,createElement:o,createText:a,createComment:u,setText:l,setElementText:c,parentNode:h,nextSibling:d,setScopeId:f=gn,insertStaticContent:p}=n,g=(w,E,k,L=null,P=null,F=null,G=void 0,$=null,z=!!E.dynamicChildren)=>{if(w===E)return;w&&!Ki(w,E)&&(L=nt(w),D(w,P,F,!0),w=null),E.patchFlag===-2&&(z=!1,E.dynamicChildren=null);const{type:N,ref:it,shapeFlag:V}=E;switch(N){case Gr:b(w,E,k,L);break;case In:m(w,E,k,L);break;case _o:w==null&&A(E,k,L,G);break;case Ve:Y(w,E,k,L,P,F,G,$,z);break;default:V&1?x(w,E,k,L,P,F,G,$,z):V&6?dt(w,E,k,L,P,F,G,$,z):(V&64||V&128)&&N.process(w,E,k,L,P,F,G,$,z,lt)}it!=null&&P?bs(it,w&&w.ref,F,E||w,!E):it==null&&w&&w.ref!=null&&bs(w.ref,null,F,w,!0)},b=(w,E,k,L)=>{if(w==null)i(E.el=a(E.children),k,L);else{const P=E.el=w.el;E.children!==w.children&&l(P,E.children)}},m=(w,E,k,L)=>{w==null?i(E.el=u(E.children||""),k,L):E.el=w.el},A=(w,E,k,L)=>{[w.el,w.anchor]=p(w.children,E,k,L,w.el,w.anchor)},y=({el:w,anchor:E},k,L)=>{let P;for(;w&&w!==E;)P=d(w),i(w,k,L),w=P;i(E,k,L)},_=({el:w,anchor:E})=>{let k;for(;w&&w!==E;)k=d(w),s(w),w=k;s(E)},x=(w,E,k,L,P,F,G,$,z)=>{E.type==="svg"?G="svg":E.type==="math"&&(G="mathml"),w==null?v(E,k,L,P,F,G,$,z):R(w,E,P,F,G,$,z)},v=(w,E,k,L,P,F,G,$)=>{let z,N;const{props:it,shapeFlag:V,transition:J,dirs:st}=w;if(z=w.el=o(w.type,F,it&&it.is,it),V&8?c(z,w.children):V&16&&M(w.children,z,null,L,P,Ao(w,F),G,$),st&&Jn(w,null,L,"created"),S(z,w,w.scopeId,G,L),it){for(const Dt in it)Dt!=="value"&&!fs(Dt)&&r(z,Dt,null,it[Dt],F,L);"value"in it&&r(z,"value",null,it.value,F),(N=it.onVnodeBeforeMount)&&on(N,L,w)}st&&Jn(w,null,L,"beforeMount");const pt=L0(P,J);pt&&J.beforeEnter(z),i(z,E,k),((N=it&&it.onVnodeMounted)||pt||st)&&Le(()=>{N&&on(N,L,w),pt&&J.enter(z),st&&Jn(w,null,L,"mounted")},P)},S=(w,E,k,L,P)=>{if(k&&f(w,k),L)for(let F=0;F<L.length;F++)f(w,L[F]);if(P){let F=P.subTree;if(E===F||Sh(F.type)&&(F.ssContent===E||F.ssFallback===E)){const G=P.vnode;S(w,G,G.scopeId,G.slotScopeIds,P.parent)}}},M=(w,E,k,L,P,F,G,$,z=0)=>{for(let N=z;N<w.length;N++){const it=w[N]=$?Hn(w[N]):dn(w[N]);g(null,it,E,k,L,P,F,G,$)}},R=(w,E,k,L,P,F,G)=>{const $=E.el=w.el;let{patchFlag:z,dynamicChildren:N,dirs:it}=E;z|=w.patchFlag&16;const V=w.props||Pt,J=E.props||Pt;let st;if(k&&Qn(k,!1),(st=J.onVnodeBeforeUpdate)&&on(st,k,E,w),it&&Jn(E,w,k,"beforeUpdate"),k&&Qn(k,!0),(V.innerHTML&&J.innerHTML==null||V.textContent&&J.textContent==null)&&c($,""),N?j(w.dynamicChildren,N,$,k,L,Ao(E,P),F):G||q(w,E,$,null,k,L,Ao(E,P),F,!1),z>0){if(z&16)I($,V,J,k,P);else if(z&2&&V.class!==J.class&&r($,"class",null,J.class,P),z&4&&r($,"style",V.style,J.style,P),z&8){const pt=E.dynamicProps;for(let Dt=0;Dt<pt.length;Dt++){const _t=pt[Dt],oe=V[_t],Qt=J[_t];(Qt!==oe||_t==="value")&&r($,_t,oe,Qt,P,k)}}z&1&&w.children!==E.children&&c($,E.children)}else!G&&N==null&&I($,V,J,k,P);((st=J.onVnodeUpdated)||it)&&Le(()=>{st&&on(st,k,E,w),it&&Jn(E,w,k,"updated")},L)},j=(w,E,k,L,P,F,G)=>{for(let $=0;$<E.length;$++){const z=w[$],N=E[$],it=z.el&&(z.type===Ve||!Ki(z,N)||z.shapeFlag&198)?h(z.el):k;g(z,N,it,null,L,P,F,G,!0)}},I=(w,E,k,L,P)=>{if(E!==k){if(E!==Pt)for(const F in E)!fs(F)&&!(F in k)&&r(w,F,E[F],null,P,L);for(const F in k){if(fs(F))continue;const G=k[F],$=E[F];G!==$&&F!=="value"&&r(w,F,$,G,P,L)}"value"in k&&r(w,"value",E.value,k.value,P)}},Y=(w,E,k,L,P,F,G,$,z)=>{const N=E.el=w?w.el:a(""),it=E.anchor=w?w.anchor:a("");let{patchFlag:V,dynamicChildren:J,slotScopeIds:st}=E;st&&($=$?$.concat(st):st),w==null?(i(N,k,L),i(it,k,L),M(E.children||[],k,it,P,F,G,$,z)):V>0&&V&64&&J&&w.dynamicChildren?(j(w.dynamicChildren,J,k,P,F,G,$),(E.key!=null||P&&E===P.subTree)&&xh(w,E,!0)):q(w,E,k,it,P,F,G,$,z)},dt=(w,E,k,L,P,F,G,$,z)=>{E.slotScopeIds=$,w==null?E.shapeFlag&512?P.ctx.activate(E,k,L,G,z):et(E,k,L,P,F,G,z):mt(w,E,z)},et=(w,E,k,L,P,F,G)=>{const $=w.component=tp(w,L,P);if(sh(w)&&($.ctx.renderer=lt),np($,!1,G),$.asyncDep){if(P&&P.registerDep($,U,G),!w.el){const z=$.subTree=Qe(In);m(null,z,E,k),w.placeholder=z.el}}else U($,w,E,k,P,F,G)},mt=(w,E,k)=>{const L=E.component=w.component;if(V0(w,E,k))if(L.asyncDep&&!L.asyncResolved){O(L,E,k);return}else L.next=E,L.update();else E.el=w.el,L.vnode=E},U=(w,E,k,L,P,F,G)=>{const $=()=>{if(w.isMounted){let{next:V,bu:J,u:st,parent:pt,vnode:Dt}=w;{const be=wh(w);if(be){V&&(V.el=Dt.el,O(w,V,G)),be.asyncDep.then(()=>{w.isUnmounted||$()});return}}let _t=V,oe;Qn(w,!1),V?(V.el=Dt.el,O(w,V,G)):V=Dt,J&&hr(J),(oe=V.props&&V.props.onVnodeBeforeUpdate)&&on(oe,pt,V,Dt),Qn(w,!0);const Qt=Ku(w),Ie=w.subTree;w.subTree=Qt,g(Ie,Qt,h(Ie.el),nt(Ie),w,P,F),V.el=Qt.el,_t===null&&W0(w,Qt.el),st&&Le(st,P),(oe=V.props&&V.props.onVnodeUpdated)&&Le(()=>on(oe,pt,V,Dt),P)}else{let V;const{el:J,props:st}=E,{bm:pt,m:Dt,parent:_t,root:oe,type:Qt}=w,Ie=Pi(E);Qn(w,!1),pt&&hr(pt),!Ie&&(V=st&&st.onVnodeBeforeMount)&&on(V,_t,E),Qn(w,!0);{oe.ce&&oe.ce._def.shadowRoot!==!1&&oe.ce._injectChildStyle(Qt);const be=w.subTree=Ku(w);g(null,be,k,L,w,P,F),E.el=be.el}if(Dt&&Le(Dt,P),!Ie&&(V=st&&st.onVnodeMounted)){const be=E;Le(()=>on(V,_t,be),P)}(E.shapeFlag&256||_t&&Pi(_t.vnode)&&_t.vnode.shapeFlag&256)&&w.a&&Le(w.a,P),w.isMounted=!0,E=k=L=null}};w.scope.on();const z=w.effect=new Ic($);w.scope.off();const N=w.update=z.run.bind(z),it=w.job=z.runIfDirty.bind(z);it.i=w,it.id=w.uid,z.scheduler=()=>Va(it),Qn(w,!0),N()},O=(w,E,k)=>{E.component=w;const L=w.vnode.props;w.vnode=E,w.next=null,k0(w,E.props,L,k),F0(w,E.children,k),Fn(),$u(w),Rn()},q=(w,E,k,L,P,F,G,$,z=!1)=>{const N=w&&w.children,it=w?w.shapeFlag:0,V=E.children,{patchFlag:J,shapeFlag:st}=E;if(J>0){if(J&128){Ot(N,V,k,L,P,F,G,$,z);return}else if(J&256){At(N,V,k,L,P,F,G,$,z);return}}st&8?(it&16&&ot(N,P,F),V!==N&&c(k,V)):it&16?st&16?Ot(N,V,k,L,P,F,G,$,z):ot(N,P,F,!0):(it&8&&c(k,""),st&16&&M(V,k,L,P,F,G,$,z))},At=(w,E,k,L,P,F,G,$,z)=>{w=w||ki,E=E||ki;const N=w.length,it=E.length,V=Math.min(N,it);let J;for(J=0;J<V;J++){const st=E[J]=z?Hn(E[J]):dn(E[J]);g(w[J],st,k,null,P,F,G,$,z)}N>it?ot(w,P,F,!0,!1,V):M(E,k,L,P,F,G,$,z,V)},Ot=(w,E,k,L,P,F,G,$,z)=>{let N=0;const it=E.length;let V=w.length-1,J=it-1;for(;N<=V&&N<=J;){const st=w[N],pt=E[N]=z?Hn(E[N]):dn(E[N]);if(Ki(st,pt))g(st,pt,k,null,P,F,G,$,z);else break;N++}for(;N<=V&&N<=J;){const st=w[V],pt=E[J]=z?Hn(E[J]):dn(E[J]);if(Ki(st,pt))g(st,pt,k,null,P,F,G,$,z);else break;V--,J--}if(N>V){if(N<=J){const st=J+1,pt=st<it?E[st].el:L;for(;N<=J;)g(null,E[N]=z?Hn(E[N]):dn(E[N]),k,pt,P,F,G,$,z),N++}}else if(N>J)for(;N<=V;)D(w[N],P,F,!0),N++;else{const st=N,pt=N,Dt=new Map;for(N=pt;N<=J;N++){const Wt=E[N]=z?Hn(E[N]):dn(E[N]);Wt.key!=null&&Dt.set(Wt.key,N)}let _t,oe=0;const Qt=J-pt+1;let Ie=!1,be=0;const en=new Array(Qt);for(N=0;N<Qt;N++)en[N]=0;for(N=st;N<=V;N++){const Wt=w[N];if(oe>=Qt){D(Wt,P,F,!0);continue}let Te;if(Wt.key!=null)Te=Dt.get(Wt.key);else for(_t=pt;_t<=J;_t++)if(en[_t-pt]===0&&Ki(Wt,E[_t])){Te=_t;break}Te===void 0?D(Wt,P,F,!0):(en[Te-pt]=N+1,Te>=be?be=Te:Ie=!0,g(Wt,E[Te],k,null,P,F,G,$,z),oe++)}const ze=Ie?O0(en):ki;for(_t=ze.length-1,N=Qt-1;N>=0;N--){const Wt=pt+N,Te=E[Wt],fi=E[Wt+1],Vs=Wt+1<it?fi.el||fi.placeholder:L;en[N]===0?g(null,Te,k,Vs,P,F,G,$,z):Ie&&(_t<0||N!==ze[_t]?T(Te,k,Vs,2):_t--)}}},T=(w,E,k,L,P=null)=>{const{el:F,type:G,transition:$,children:z,shapeFlag:N}=w;if(N&6){T(w.component.subTree,E,k,L);return}if(N&128){w.suspense.move(E,k,L);return}if(N&64){G.move(w,E,k,lt);return}if(G===Ve){i(F,E,k);for(let V=0;V<z.length;V++)T(z[V],E,k,L);i(w.anchor,E,k);return}if(G===_o){y(w,E,k);return}if(L!==2&&N&1&&$)if(L===0)$.beforeEnter(F),i(F,E,k),Le(()=>$.enter(F),P);else{const{leave:V,delayLeave:J,afterLeave:st}=$,pt=()=>{w.ctx.isUnmounted?s(F):i(F,E,k)},Dt=()=>{F._isLeaving&&F[r0](!0),V(F,()=>{pt(),st&&st()})};J?J(F,pt,Dt):Dt()}else i(F,E,k)},D=(w,E,k,L=!1,P=!1)=>{const{type:F,props:G,ref:$,children:z,dynamicChildren:N,shapeFlag:it,patchFlag:V,dirs:J,cacheIndex:st}=w;if(V===-2&&(P=!1),$!=null&&(Fn(),bs($,null,k,w,!0),Rn()),st!=null&&(E.renderCache[st]=void 0),it&256){E.ctx.deactivate(w);return}const pt=it&1&&J,Dt=!Pi(w);let _t;if(Dt&&(_t=G&&G.onVnodeBeforeUnmount)&&on(_t,E,w),it&6)W(w.component,k,L);else{if(it&128){w.suspense.unmount(k,L);return}pt&&Jn(w,null,E,"beforeUnmount"),it&64?w.type.remove(w,E,k,lt,L):N&&!N.hasOnce&&(F!==Ve||V>0&&V&64)?ot(N,E,k,!1,!0):(F===Ve&&V&384||!P&&it&16)&&ot(z,E,k),L&&B(w)}(Dt&&(_t=G&&G.onVnodeUnmounted)||pt)&&Le(()=>{_t&&on(_t,E,w),pt&&Jn(w,null,E,"unmounted")},k)},B=w=>{const{type:E,el:k,anchor:L,transition:P}=w;if(E===Ve){rt(k,L);return}if(E===_o){_(w);return}const F=()=>{s(k),P&&!P.persisted&&P.afterLeave&&P.afterLeave()};if(w.shapeFlag&1&&P&&!P.persisted){const{leave:G,delayLeave:$}=P,z=()=>G(k,F);$?$(w.el,F,z):z()}else F()},rt=(w,E)=>{let k;for(;w!==E;)k=d(w),s(w),w=k;s(E)},W=(w,E,k)=>{const{bum:L,scope:P,job:F,subTree:G,um:$,m:z,a:N}=w;Yu(z),Yu(N),L&&hr(L),P.stop(),F&&(F.flags|=8,D(G,w,E,k)),$&&Le($,E),Le(()=>{w.isUnmounted=!0},E)},ot=(w,E,k,L=!1,P=!1,F=0)=>{for(let G=F;G<w.length;G++)D(w[G],E,k,L,P)},nt=w=>{if(w.shapeFlag&6)return nt(w.component.subTree);if(w.shapeFlag&128)return w.suspense.next();const E=d(w.anchor||w.el),k=E&&E[i0];return k?d(k):E};let Ft=!1;const $t=(w,E,k)=>{w==null?E._vnode&&D(E._vnode,null,null,!0):g(E._vnode||null,w,E,null,null,null,k),E._vnode=w,Ft||(Ft=!0,$u(),Jc(),Ft=!1)},lt={p:g,um:D,m:T,r:B,mt:et,mc:M,pc:q,pbc:j,n:nt,o:n};return{render:$t,hydrate:void 0,createApp:C0($t)}}function Ao({type:n,props:t},e){return e==="svg"&&n==="foreignObject"||e==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function Qn({effect:n,job:t},e){e?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function L0(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function xh(n,t,e=!1){const i=n.children,s=t.children;if(ht(i)&&ht(s))for(let r=0;r<i.length;r++){const o=i[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=Hn(s[r]),a.el=o.el),!e&&a.patchFlag!==-2&&xh(o,a)),a.type===Gr&&a.patchFlag!==-1&&(a.el=o.el),a.type===In&&!a.el&&(a.el=o.el)}}function O0(n){const t=n.slice(),e=[0];let i,s,r,o,a;const u=n.length;for(i=0;i<u;i++){const l=n[i];if(l!==0){if(s=e[e.length-1],n[s]<l){t[i]=s,e.push(i);continue}for(r=0,o=e.length-1;r<o;)a=r+o>>1,n[e[a]]<l?r=a+1:o=a;l<n[e[r]]&&(r>0&&(t[i]=e[r-1]),e[r]=i)}}for(r=e.length,o=e[r-1];r-- >0;)e[r]=o,o=t[o];return e}function wh(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:wh(t)}function Yu(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const N0=Symbol.for("v-scx"),B0=()=>fr(N0);function pr(n,t,e){return vh(n,t,e)}function vh(n,t,e=Pt){const{immediate:i,deep:s,flush:r,once:o}=e,a=ge({},e),u=t&&i||!t&&r!=="post";let l;if(Cs){if(r==="sync"){const f=B0();l=f.__watcherHandles||(f.__watcherHandles=[])}else if(!u){const f=()=>{};return f.stop=gn,f.resume=gn,f.pause=gn,f}}const c=ve;a.call=(f,p,g)=>mn(f,c,p,g);let h=!1;r==="post"?a.scheduler=f=>{Le(f,c&&c.suspense)}:r!=="sync"&&(h=!0,a.scheduler=(f,p)=>{p?f():Va(f)}),a.augmentJob=f=>{t&&(f.flags|=4),h&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const d=Zf(n,t,a);return Cs&&(l?l.push(d):u&&d()),d}function U0(n,t,e){const i=this.proxy,s=Jt(n)?n.includes(".")?Eh(i,n):()=>i[n]:n.bind(i,i);let r;ft(t)?r=t:(r=t.handler,e=t);const o=Os(this),a=vh(s,r.bind(i),e);return o(),a}function Eh(n,t){const e=t.split(".");return()=>{let i=n;for(let s=0;s<e.length&&i;s++)i=i[e[s]];return i}}const H0=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${qn(t)}Modifiers`]||n[`${ci(t)}Modifiers`];function z0(n,t,...e){if(n.isUnmounted)return;const i=n.vnode.props||Pt;let s=e;const r=t.startsWith("update:"),o=r&&H0(i,t.slice(7));o&&(o.trim&&(s=e.map(c=>Jt(c)?c.trim():c)),o.number&&(s=e.map(Zo)));let a,u=i[a=fo(t)]||i[a=fo(qn(t))];!u&&r&&(u=i[a=fo(ci(t))]),u&&mn(u,n,6,s);const l=i[a+"Once"];if(l){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,mn(l,n,6,s)}}const $0=new WeakMap;function Ch(n,t,e=!1){const i=e?$0:t.emitsCache,s=i.get(n);if(s!==void 0)return s;const r=n.emits;let o={},a=!1;if(!ft(n)){const u=l=>{const c=Ch(l,t,!0);c&&(a=!0,ge(o,c))};!e&&t.mixins.length&&t.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}return!r&&!a?(Gt(n)&&i.set(n,null),null):(ht(r)?r.forEach(u=>o[u]=null):ge(o,r),Gt(n)&&i.set(n,o),o)}function jr(n,t){return!n||!Nr(t)?!1:(t=t.slice(2).replace(/Once$/,""),kt(n,t[0].toLowerCase()+t.slice(1))||kt(n,ci(t))||kt(n,t))}function Ku(n){const{type:t,vnode:e,proxy:i,withProxy:s,propsOptions:[r],slots:o,attrs:a,emit:u,render:l,renderCache:c,props:h,data:d,setupState:f,ctx:p,inheritAttrs:g}=n,b=vr(n);let m,A;try{if(e.shapeFlag&4){const _=s||i,x=_;m=dn(l.call(x,_,c,h,f,d,p)),A=a}else{const _=t;m=dn(_.length>1?_(h,{attrs:a,slots:o,emit:u}):_(h,null)),A=t.props?a:j0(a)}}catch(_){As.length=0,zr(_,n,1),m=Qe(In)}let y=m;if(A&&g!==!1){const _=Object.keys(A),{shapeFlag:x}=y;_.length&&x&7&&(r&&_.some(Fa)&&(A=G0(A,r)),y=Hi(y,A,!1,!0))}return e.dirs&&(y=Hi(y,null,!1,!0),y.dirs=y.dirs?y.dirs.concat(e.dirs):e.dirs),e.transition&&Wa(y,e.transition),m=y,vr(b),m}const j0=n=>{let t;for(const e in n)(e==="class"||e==="style"||Nr(e))&&((t||(t={}))[e]=n[e]);return t},G0=(n,t)=>{const e={};for(const i in n)(!Fa(i)||!(i.slice(9)in t))&&(e[i]=n[i]);return e};function V0(n,t,e){const{props:i,children:s,component:r}=n,{props:o,children:a,patchFlag:u}=t,l=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&u>=0){if(u&1024)return!0;if(u&16)return i?Zu(i,o,l):!!o;if(u&8){const c=t.dynamicProps;for(let h=0;h<c.length;h++){const d=c[h];if(o[d]!==i[d]&&!jr(l,d))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?Zu(i,o,l):!0:!!o;return!1}function Zu(n,t,e){const i=Object.keys(t);if(i.length!==Object.keys(n).length)return!0;for(let s=0;s<i.length;s++){const r=i[s];if(t[r]!==n[r]&&!jr(e,r))return!0}return!1}function W0({vnode:n,parent:t},e){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===n&&(i.el=n.el),i===n)(n=t.vnode).el=e,t=t.parent;else break}}const Sh=n=>n.__isSuspense;function q0(n,t){t&&t.pendingBranch?ht(n)?t.effects.push(...n):t.effects.push(n):e0(n)}const Ve=Symbol.for("v-fgt"),Gr=Symbol.for("v-txt"),In=Symbol.for("v-cmt"),_o=Symbol.for("v-stc"),As=[];let Ue=null;function Pn(n=!1){As.push(Ue=n?null:[])}function X0(){As.pop(),Ue=As[As.length-1]||null}let Es=1;function Ju(n,t=!1){Es+=n,n<0&&Ue&&t&&(Ue.hasOnce=!0)}function Th(n){return n.dynamicChildren=Es>0?Ue||ki:null,X0(),Es>0&&Ue&&Ue.push(n),n}function _i(n,t,e,i,s,r){return Th(xt(n,t,e,i,s,r,!0))}function aa(n,t,e,i,s){return Th(Qe(n,t,e,i,s,!0))}function Ya(n){return n?n.__v_isVNode===!0:!1}function Ki(n,t){return n.type===t.type&&n.key===t.key}const kh=({key:n})=>n??null,gr=({ref:n,ref_key:t,ref_for:e})=>(typeof n=="number"&&(n=""+n),n!=null?Jt(n)||pe(n)||ft(n)?{i:fe,r:n,k:t,f:!!e}:n:null);function xt(n,t=null,e=null,i=0,s=null,r=n===Ve?0:1,o=!1,a=!1){const u={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&kh(t),ref:t&&gr(t),scopeId:th,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:fe};return a?(Ka(u,e),r&128&&n.normalize(u)):e&&(u.shapeFlag|=Jt(e)?8:16),Es>0&&!o&&Ue&&(u.patchFlag>0||r&6)&&u.patchFlag!==32&&Ue.push(u),u}const Qe=Y0;function Y0(n,t=null,e=null,i=0,s=null,r=!1){if((!n||n===m0)&&(n=In),Ya(n)){const a=Hi(n,t,!0);return e&&Ka(a,e),Es>0&&!r&&Ue&&(a.shapeFlag&6?Ue[Ue.indexOf(n)]=a:Ue.push(a)),a.patchFlag=-2,a}if(op(n)&&(n=n.__vccOpts),t){t=K0(t);let{class:a,style:u}=t;a&&!Jt(a)&&(t.class=ri(a)),Gt(u)&&(Ga(u)&&!ht(u)&&(u=ge({},u)),t.style=La(u))}const o=Jt(n)?1:Sh(n)?128:s0(n)?64:Gt(n)?4:ft(n)?2:0;return xt(n,t,e,i,s,o,r,!0)}function K0(n){return n?Ga(n)||gh(n)?ge({},n):n:null}function Hi(n,t,e=!1,i=!1){const{props:s,ref:r,patchFlag:o,children:a,transition:u}=n,l=t?Z0(s||{},t):s,c={__v_isVNode:!0,__v_skip:!0,type:n.type,props:l,key:l&&kh(l),ref:t&&t.ref?e&&r?ht(r)?r.concat(gr(t)):[r,gr(t)]:gr(t):r,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==Ve?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:u,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Hi(n.ssContent),ssFallback:n.ssFallback&&Hi(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return u&&i&&Wa(c,u.clone(c)),c}function Dh(n=" ",t=0){return Qe(Gr,null,n,t)}function Zs(n="",t=!1){return t?(Pn(),aa(In,null,n)):Qe(In,null,n)}function dn(n){return n==null||typeof n=="boolean"?Qe(In):ht(n)?Qe(Ve,null,n.slice()):Ya(n)?Hn(n):Qe(Gr,null,String(n))}function Hn(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Hi(n)}function Ka(n,t){let e=0;const{shapeFlag:i}=n;if(t==null)t=null;else if(ht(t))e=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),Ka(n,s()),s._c&&(s._d=!0));return}else{e=32;const s=t._;!s&&!gh(t)?t._ctx=fe:s===3&&fe&&(fe.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else ft(t)?(t={default:t,_ctx:fe},e=32):(t=String(t),i&64?(e=16,t=[Dh(t)]):e=8);n.children=t,n.shapeFlag|=e}function Z0(...n){const t={};for(let e=0;e<n.length;e++){const i=n[e];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=ri([t.class,i.class]));else if(s==="style")t.style=La([t.style,i.style]);else if(Nr(s)){const r=t[s],o=i[s];o&&r!==o&&!(ht(r)&&r.includes(o))&&(t[s]=r?[].concat(r,o):o)}else s!==""&&(t[s]=i[s])}return t}function on(n,t,e,i=null){mn(n,t,7,[e,i])}const J0=dh();let Q0=0;function tp(n,t,e){const i=n.type,s=(t?t.appContext:n.appContext)||J0,r={uid:Q0++,vnode:n,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new wf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:bh(i,s),emitsOptions:Ch(i,s),emit:null,emitted:null,propsDefaults:Pt,inheritAttrs:i.inheritAttrs,ctx:Pt,data:Pt,props:Pt,attrs:Pt,slots:Pt,refs:Pt,setupState:Pt,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=z0.bind(null,r),n.ce&&n.ce(r),r}let ve=null;const ep=()=>ve||fe;let Sr,ua;{const n=Hr(),t=(e,i)=>{let s;return(s=n[e])||(s=n[e]=[]),s.push(i),r=>{s.length>1?s.forEach(o=>o(r)):s[0](r)}};Sr=t("__VUE_INSTANCE_SETTERS__",e=>ve=e),ua=t("__VUE_SSR_SETTERS__",e=>Cs=e)}const Os=n=>{const t=ve;return Sr(n),n.scope.on(),()=>{n.scope.off(),Sr(t)}},Qu=()=>{ve&&ve.scope.off(),Sr(null)};function Mh(n){return n.vnode.shapeFlag&4}let Cs=!1;function np(n,t=!1,e=!1){t&&ua(t);const{props:i,children:s}=n.vnode,r=Mh(n);T0(n,i,r,t),P0(n,s,e||t);const o=r?ip(n,t):void 0;return t&&ua(!1),o}function ip(n,t){const e=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,y0);const{setup:i}=e;if(i){Fn();const s=n.setupContext=i.length>1?rp(n):null,r=Os(n),o=Ls(i,n,0,[n.props,s]),a=Sc(o);if(Rn(),r(),(a||n.sp)&&!Pi(n)&&ih(n),a){if(o.then(Qu,Qu),t)return o.then(u=>{tl(n,u)}).catch(u=>{zr(u,n,0)});n.asyncDep=o}else tl(n,o)}else Ph(n)}function tl(n,t,e){ft(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:Gt(t)&&(n.setupState=Yc(t)),Ph(n)}function Ph(n,t,e){const i=n.type;n.render||(n.render=i.render||gn);{const s=Os(n);Fn();try{A0(n)}finally{Rn(),s()}}}const sp={get(n,t){return de(n,"get",""),n[t]}};function rp(n){const t=e=>{n.exposed=e||{}};return{attrs:new Proxy(n.attrs,sp),slots:n.slots,emit:n.emit,expose:t}}function Vr(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Yc(jf(n.exposed)),{get(t,e){if(e in t)return t[e];if(e in ys)return ys[e](n)},has(t,e){return e in t||e in ys}})):n.proxy}function op(n){return ft(n)&&"__vccOpts"in n}const Tr=(n,t)=>Yf(n,t,Cs),ap="3.5.21";let la;const el=typeof window<"u"&&window.trustedTypes;if(el)try{la=el.createPolicy("vue",{createHTML:n=>n})}catch{}const Fh=la?n=>la.createHTML(n):n=>n,up="http://www.w3.org/2000/svg",lp="http://www.w3.org/1998/Math/MathML",Sn=typeof document<"u"?document:null,nl=Sn&&Sn.createElement("template"),cp={insert:(n,t,e)=>{t.insertBefore(n,e||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,e,i)=>{const s=t==="svg"?Sn.createElementNS(up,n):t==="mathml"?Sn.createElementNS(lp,n):e?Sn.createElement(n,{is:e}):Sn.createElement(n);return n==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:n=>Sn.createTextNode(n),createComment:n=>Sn.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Sn.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,e,i,s,r){const o=e?e.previousSibling:t.lastChild;if(s&&(s===r||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),e),!(s===r||!(s=s.nextSibling)););else{nl.innerHTML=Fh(i==="svg"?`<svg>${n}</svg>`:i==="mathml"?`<math>${n}</math>`:n);const a=nl.content;if(i==="svg"||i==="mathml"){const u=a.firstChild;for(;u.firstChild;)a.appendChild(u.firstChild);a.removeChild(u)}t.insertBefore(a,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},hp=Symbol("_vtc");function dp(n,t,e){const i=n[hp];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?n.removeAttribute("class"):e?n.setAttribute("class",t):n.className=t}const il=Symbol("_vod"),fp=Symbol("_vsh"),pp=Symbol(""),gp=/(?:^|;)\s*display\s*:/;function mp(n,t,e){const i=n.style,s=Jt(e);let r=!1;if(e&&!s){if(t)if(Jt(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();e[a]==null&&mr(i,a,"")}else for(const o in t)e[o]==null&&mr(i,o,"");for(const o in e)o==="display"&&(r=!0),mr(i,o,e[o])}else if(s){if(t!==e){const o=i[pp];o&&(e+=";"+o),i.cssText=e,r=gp.test(e)}}else t&&n.removeAttribute("style");il in n&&(n[il]=r?i.display:"",n[fp]&&(i.display="none"))}const sl=/\s*!important$/;function mr(n,t,e){if(ht(e))e.forEach(i=>mr(n,t,i));else if(e==null&&(e=""),t.startsWith("--"))n.setProperty(t,e);else{const i=bp(n,t);sl.test(e)?n.setProperty(ci(i),e.replace(sl,""),"important"):n[i]=e}}const rl=["Webkit","Moz","ms"],xo={};function bp(n,t){const e=xo[t];if(e)return e;let i=qn(t);if(i!=="filter"&&i in n)return xo[t]=i;i=Dc(i);for(let s=0;s<rl.length;s++){const r=rl[s]+i;if(r in n)return xo[t]=r}return t}const ol="http://www.w3.org/1999/xlink";function al(n,t,e,i,s,r=xf(t)){i&&t.startsWith("xlink:")?e==null?n.removeAttributeNS(ol,t.slice(6,t.length)):n.setAttributeNS(ol,t,e):e==null||r&&!Pc(e)?n.removeAttribute(t):n.setAttribute(t,r?"":Ln(e)?String(e):e)}function ul(n,t,e,i,s){if(t==="innerHTML"||t==="textContent"){e!=null&&(n[t]=t==="innerHTML"?Fh(e):e);return}const r=n.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?n.getAttribute("value")||"":n.value,u=e==null?n.type==="checkbox"?"on":"":String(e);(a!==u||!("_value"in n))&&(n.value=u),e==null&&n.removeAttribute(t),n._value=e;return}let o=!1;if(e===""||e==null){const a=typeof n[t];a==="boolean"?e=Pc(e):e==null&&a==="string"?(e="",o=!0):a==="number"&&(e=0,o=!0)}try{n[t]=e}catch{}o&&n.removeAttribute(s||t)}function xi(n,t,e,i){n.addEventListener(t,e,i)}function yp(n,t,e,i){n.removeEventListener(t,e,i)}const ll=Symbol("_vei");function Ap(n,t,e,i,s=null){const r=n[ll]||(n[ll]={}),o=r[t];if(i&&o)o.value=i;else{const[a,u]=_p(t);if(i){const l=r[t]=vp(i,s);xi(n,a,l,u)}else o&&(yp(n,a,o,u),r[t]=void 0)}}const cl=/(?:Once|Passive|Capture)$/;function _p(n){let t;if(cl.test(n)){t={};let i;for(;i=n.match(cl);)n=n.slice(0,n.length-i[0].length),t[i[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):ci(n.slice(2)),t]}let wo=0;const xp=Promise.resolve(),wp=()=>wo||(xp.then(()=>wo=0),wo=Date.now());function vp(n,t){const e=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=e.attached)return;mn(Ep(i,e.value),t,5,[i])};return e.value=n,e.attached=wp(),e}function Ep(n,t){if(ht(t)){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{e.call(n),n._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const hl=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,Cp=(n,t,e,i,s,r)=>{const o=s==="svg";t==="class"?dp(n,i,o):t==="style"?mp(n,e,i):Nr(t)?Fa(t)||Ap(n,t,e,i,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Sp(n,t,i,o))?(ul(n,t,i),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&al(n,t,i,o,r,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!Jt(i))?ul(n,qn(t),i,r,t):(t==="true-value"?n._trueValue=i:t==="false-value"&&(n._falseValue=i),al(n,t,i,o))};function Sp(n,t,e,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in n&&hl(t)&&ft(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return hl(t)&&Jt(e)?!1:t in n}const dl=n=>{const t=n.props["onUpdate:modelValue"]||!1;return ht(t)?e=>hr(t,e):t};function Tp(n){n.target.composing=!0}function fl(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const vo=Symbol("_assign"),kp={created(n,{modifiers:{lazy:t,trim:e,number:i}},s){n[vo]=dl(s);const r=i||s.props&&s.props.type==="number";xi(n,t?"change":"input",o=>{if(o.target.composing)return;let a=n.value;e&&(a=a.trim()),r&&(a=Zo(a)),n[vo](a)}),e&&xi(n,"change",()=>{n.value=n.value.trim()}),t||(xi(n,"compositionstart",Tp),xi(n,"compositionend",fl),xi(n,"change",fl))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:e,modifiers:{lazy:i,trim:s,number:r}},o){if(n[vo]=dl(o),n.composing)return;const a=(r||n.type==="number")&&!/^0\d/.test(n.value)?Zo(n.value):n.value,u=t??"";a!==u&&(document.activeElement===n&&n.type!=="range"&&(i&&t===e||s&&n.value.trim()===u)||(n.value=u))}},Dp=["ctrl","shift","alt","meta"],Mp={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>Dp.some(e=>n[`${e}Key`]&&!t.includes(e))},Eo=(n,t)=>{const e=n._withMods||(n._withMods={}),i=t.join(".");return e[i]||(e[i]=((s,...r)=>{for(let o=0;o<t.length;o++){const a=Mp[t[o]];if(a&&a(s,t))return}return n(s,...r)}))},Pp=ge({patchProp:Cp},cp);let pl;function Fp(){return pl||(pl=R0(Pp))}const Rp=((...n)=>{const t=Fp().createApp(...n),{mount:e}=t;return t.mount=i=>{const s=Lp(i);if(!s)return;const r=t._component;!ft(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=e(s,!1,Ip(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},t});function Ip(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function Lp(n){return Jt(n)?document.querySelector(n):n}const Op="/md-editor/md-editor.svg",gl={};function Np(n){let t=gl[n];if(t)return t;t=gl[n]=[];for(let e=0;e<128;e++){const i=String.fromCharCode(e);t.push(i)}for(let e=0;e<n.length;e++){const i=n.charCodeAt(e);t[i]="%"+("0"+i.toString(16).toUpperCase()).slice(-2)}return t}function zi(n,t){typeof t!="string"&&(t=zi.defaultChars);const e=Np(t);return n.replace(/(%[a-f0-9]{2})+/gi,function(i){let s="";for(let r=0,o=i.length;r<o;r+=3){const a=parseInt(i.slice(r+1,r+3),16);if(a<128){s+=e[a];continue}if((a&224)===192&&r+3<o){const u=parseInt(i.slice(r+4,r+6),16);if((u&192)===128){const l=a<<6&1984|u&63;l<128?s+="":s+=String.fromCharCode(l),r+=3;continue}}if((a&240)===224&&r+6<o){const u=parseInt(i.slice(r+4,r+6),16),l=parseInt(i.slice(r+7,r+9),16);if((u&192)===128&&(l&192)===128){const c=a<<12&61440|u<<6&4032|l&63;c<2048||c>=55296&&c<=57343?s+="":s+=String.fromCharCode(c),r+=6;continue}}if((a&248)===240&&r+9<o){const u=parseInt(i.slice(r+4,r+6),16),l=parseInt(i.slice(r+7,r+9),16),c=parseInt(i.slice(r+10,r+12),16);if((u&192)===128&&(l&192)===128&&(c&192)===128){let h=a<<18&1835008|u<<12&258048|l<<6&4032|c&63;h<65536||h>1114111?s+="":(h-=65536,s+=String.fromCharCode(55296+(h>>10),56320+(h&1023))),r+=9;continue}}s+=""}return s})}zi.defaultChars=";/?:@&=+$,#";zi.componentChars="";const ml={};function Bp(n){let t=ml[n];if(t)return t;t=ml[n]=[];for(let e=0;e<128;e++){const i=String.fromCharCode(e);/^[0-9a-z]$/i.test(i)?t.push(i):t.push("%"+("0"+e.toString(16).toUpperCase()).slice(-2))}for(let e=0;e<n.length;e++)t[n.charCodeAt(e)]=n[e];return t}function Ns(n,t,e){typeof t!="string"&&(e=t,t=Ns.defaultChars),typeof e>"u"&&(e=!0);const i=Bp(t);let s="";for(let r=0,o=n.length;r<o;r++){const a=n.charCodeAt(r);if(e&&a===37&&r+2<o&&/^[0-9a-f]{2}$/i.test(n.slice(r+1,r+3))){s+=n.slice(r,r+3),r+=2;continue}if(a<128){s+=i[a];continue}if(a>=55296&&a<=57343){if(a>=55296&&a<=56319&&r+1<o){const u=n.charCodeAt(r+1);if(u>=56320&&u<=57343){s+=encodeURIComponent(n[r]+n[r+1]),r++;continue}}s+="%EF%BF%BD";continue}s+=encodeURIComponent(n[r])}return s}Ns.defaultChars=";/?:@&=+$,-_.!~*'()#";Ns.componentChars="-_.!~*'()";function Za(n){let t="";return t+=n.protocol||"",t+=n.slashes?"//":"",t+=n.auth?n.auth+"@":"",n.hostname&&n.hostname.indexOf(":")!==-1?t+="["+n.hostname+"]":t+=n.hostname||"",t+=n.port?":"+n.port:"",t+=n.pathname||"",t+=n.search||"",t+=n.hash||"",t}function kr(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const Up=/^([a-z0-9.+-]+:)/i,Hp=/:[0-9]*$/,zp=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,$p=["<",">",'"',"`"," ","\r",`
`,"	"],jp=["{","}","|","\\","^","`"].concat($p),Gp=["'"].concat(jp),bl=["%","/","?",";","#"].concat(Gp),yl=["/","?","#"],Vp=255,Al=/^[+a-z0-9A-Z_-]{0,63}$/,Wp=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_l={javascript:!0,"javascript:":!0},xl={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Ja(n,t){if(n&&n instanceof kr)return n;const e=new kr;return e.parse(n,t),e}kr.prototype.parse=function(n,t){let e,i,s,r=n;if(r=r.trim(),!t&&n.split("#").length===1){const l=zp.exec(r);if(l)return this.pathname=l[1],l[2]&&(this.search=l[2]),this}let o=Up.exec(r);if(o&&(o=o[0],e=o.toLowerCase(),this.protocol=o,r=r.substr(o.length)),(t||o||r.match(/^\/\/[^@\/]+@[^@\/]+/))&&(s=r.substr(0,2)==="//",s&&!(o&&_l[o])&&(r=r.substr(2),this.slashes=!0)),!_l[o]&&(s||o&&!xl[o])){let l=-1;for(let p=0;p<yl.length;p++)i=r.indexOf(yl[p]),i!==-1&&(l===-1||i<l)&&(l=i);let c,h;l===-1?h=r.lastIndexOf("@"):h=r.lastIndexOf("@",l),h!==-1&&(c=r.slice(0,h),r=r.slice(h+1),this.auth=c),l=-1;for(let p=0;p<bl.length;p++)i=r.indexOf(bl[p]),i!==-1&&(l===-1||i<l)&&(l=i);l===-1&&(l=r.length),r[l-1]===":"&&l--;const d=r.slice(0,l);r=r.slice(l),this.parseHost(d),this.hostname=this.hostname||"";const f=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!f){const p=this.hostname.split(/\./);for(let g=0,b=p.length;g<b;g++){const m=p[g];if(m&&!m.match(Al)){let A="";for(let y=0,_=m.length;y<_;y++)m.charCodeAt(y)>127?A+="x":A+=m[y];if(!A.match(Al)){const y=p.slice(0,g),_=p.slice(g+1),x=m.match(Wp);x&&(y.push(x[1]),_.unshift(x[2])),_.length&&(r=_.join(".")+r),this.hostname=y.join(".");break}}}}this.hostname.length>Vp&&(this.hostname=""),f&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const a=r.indexOf("#");a!==-1&&(this.hash=r.substr(a),r=r.slice(0,a));const u=r.indexOf("?");return u!==-1&&(this.search=r.substr(u),r=r.slice(0,u)),r&&(this.pathname=r),xl[e]&&this.hostname&&!this.pathname&&(this.pathname=""),this};kr.prototype.parseHost=function(n){let t=Hp.exec(n);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),n=n.substr(0,n.length-t.length)),n&&(this.hostname=n)};const qp=Object.freeze(Object.defineProperty({__proto__:null,decode:zi,encode:Ns,format:Za,parse:Ja},Symbol.toStringTag,{value:"Module"})),Rh=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Ih=/[\0-\x1F\x7F-\x9F]/,Xp=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,Qa=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,Lh=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,Oh=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,Yp=Object.freeze(Object.defineProperty({__proto__:null,Any:Rh,Cc:Ih,Cf:Xp,P:Qa,S:Lh,Z:Oh},Symbol.toStringTag,{value:"Module"})),Kp=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(n=>n.charCodeAt(0))),Zp=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(n=>n.charCodeAt(0)));var Co;const Jp=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Qp=(Co=String.fromCodePoint)!==null&&Co!==void 0?Co:function(n){let t="";return n>65535&&(n-=65536,t+=String.fromCharCode(n>>>10&1023|55296),n=56320|n&1023),t+=String.fromCharCode(n),t};function tg(n){var t;return n>=55296&&n<=57343||n>1114111?65533:(t=Jp.get(n))!==null&&t!==void 0?t:n}var se;(function(n){n[n.NUM=35]="NUM",n[n.SEMI=59]="SEMI",n[n.EQUALS=61]="EQUALS",n[n.ZERO=48]="ZERO",n[n.NINE=57]="NINE",n[n.LOWER_A=97]="LOWER_A",n[n.LOWER_F=102]="LOWER_F",n[n.LOWER_X=120]="LOWER_X",n[n.LOWER_Z=122]="LOWER_Z",n[n.UPPER_A=65]="UPPER_A",n[n.UPPER_F=70]="UPPER_F",n[n.UPPER_Z=90]="UPPER_Z"})(se||(se={}));const eg=32;var Vn;(function(n){n[n.VALUE_LENGTH=49152]="VALUE_LENGTH",n[n.BRANCH_LENGTH=16256]="BRANCH_LENGTH",n[n.JUMP_TABLE=127]="JUMP_TABLE"})(Vn||(Vn={}));function ca(n){return n>=se.ZERO&&n<=se.NINE}function ng(n){return n>=se.UPPER_A&&n<=se.UPPER_F||n>=se.LOWER_A&&n<=se.LOWER_F}function ig(n){return n>=se.UPPER_A&&n<=se.UPPER_Z||n>=se.LOWER_A&&n<=se.LOWER_Z||ca(n)}function sg(n){return n===se.EQUALS||ig(n)}var ee;(function(n){n[n.EntityStart=0]="EntityStart",n[n.NumericStart=1]="NumericStart",n[n.NumericDecimal=2]="NumericDecimal",n[n.NumericHex=3]="NumericHex",n[n.NamedEntity=4]="NamedEntity"})(ee||(ee={}));var $n;(function(n){n[n.Legacy=0]="Legacy",n[n.Strict=1]="Strict",n[n.Attribute=2]="Attribute"})($n||($n={}));class rg{constructor(t,e,i){this.decodeTree=t,this.emitCodePoint=e,this.errors=i,this.state=ee.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=$n.Strict}startEntity(t){this.decodeMode=t,this.state=ee.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,e){switch(this.state){case ee.EntityStart:return t.charCodeAt(e)===se.NUM?(this.state=ee.NumericStart,this.consumed+=1,this.stateNumericStart(t,e+1)):(this.state=ee.NamedEntity,this.stateNamedEntity(t,e));case ee.NumericStart:return this.stateNumericStart(t,e);case ee.NumericDecimal:return this.stateNumericDecimal(t,e);case ee.NumericHex:return this.stateNumericHex(t,e);case ee.NamedEntity:return this.stateNamedEntity(t,e)}}stateNumericStart(t,e){return e>=t.length?-1:(t.charCodeAt(e)|eg)===se.LOWER_X?(this.state=ee.NumericHex,this.consumed+=1,this.stateNumericHex(t,e+1)):(this.state=ee.NumericDecimal,this.stateNumericDecimal(t,e))}addToNumericResult(t,e,i,s){if(e!==i){const r=i-e;this.result=this.result*Math.pow(s,r)+parseInt(t.substr(e,r),s),this.consumed+=r}}stateNumericHex(t,e){const i=e;for(;e<t.length;){const s=t.charCodeAt(e);if(ca(s)||ng(s))e+=1;else return this.addToNumericResult(t,i,e,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,i,e,16),-1}stateNumericDecimal(t,e){const i=e;for(;e<t.length;){const s=t.charCodeAt(e);if(ca(s))e+=1;else return this.addToNumericResult(t,i,e,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,i,e,10),-1}emitNumericEntity(t,e){var i;if(this.consumed<=e)return(i=this.errors)===null||i===void 0||i.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===se.SEMI)this.consumed+=1;else if(this.decodeMode===$n.Strict)return 0;return this.emitCodePoint(tg(this.result),this.consumed),this.errors&&(t!==se.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,e){const{decodeTree:i}=this;let s=i[this.treeIndex],r=(s&Vn.VALUE_LENGTH)>>14;for(;e<t.length;e++,this.excess++){const o=t.charCodeAt(e);if(this.treeIndex=og(i,s,this.treeIndex+Math.max(1,r),o),this.treeIndex<0)return this.result===0||this.decodeMode===$n.Attribute&&(r===0||sg(o))?0:this.emitNotTerminatedNamedEntity();if(s=i[this.treeIndex],r=(s&Vn.VALUE_LENGTH)>>14,r!==0){if(o===se.SEMI)return this.emitNamedEntityData(this.treeIndex,r,this.consumed+this.excess);this.decodeMode!==$n.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:e,decodeTree:i}=this,s=(i[e]&Vn.VALUE_LENGTH)>>14;return this.emitNamedEntityData(e,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,e,i){const{decodeTree:s}=this;return this.emitCodePoint(e===1?s[t]&~Vn.VALUE_LENGTH:s[t+1],i),e===3&&this.emitCodePoint(s[t+2],i),i}end(){var t;switch(this.state){case ee.NamedEntity:return this.result!==0&&(this.decodeMode!==$n.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case ee.NumericDecimal:return this.emitNumericEntity(0,2);case ee.NumericHex:return this.emitNumericEntity(0,3);case ee.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case ee.EntityStart:return 0}}}function Nh(n){let t="";const e=new rg(n,i=>t+=Qp(i));return function(s,r){let o=0,a=0;for(;(a=s.indexOf("&",a))>=0;){t+=s.slice(o,a),e.startEntity(r);const l=e.write(s,a+1);if(l<0){o=a+e.end();break}o=a+l,a=l===0?o+1:o}const u=t+s.slice(o);return t="",u}}function og(n,t,e,i){const s=(t&Vn.BRANCH_LENGTH)>>7,r=t&Vn.JUMP_TABLE;if(s===0)return r!==0&&i===r?e:-1;if(r){const u=i-r;return u<0||u>=s?-1:n[e+u]-1}let o=e,a=o+s-1;for(;o<=a;){const u=o+a>>>1,l=n[u];if(l<i)o=u+1;else if(l>i)a=u-1;else return n[u+s]}return-1}const ag=Nh(Kp);Nh(Zp);function Bh(n,t=$n.Legacy){return ag(n,t)}function ug(n){return Object.prototype.toString.call(n)}function tu(n){return ug(n)==="[object String]"}const lg=Object.prototype.hasOwnProperty;function cg(n,t){return lg.call(n,t)}function Wr(n){return Array.prototype.slice.call(arguments,1).forEach(function(e){if(e){if(typeof e!="object")throw new TypeError(e+"must be object");Object.keys(e).forEach(function(i){n[i]=e[i]})}}),n}function Uh(n,t,e){return[].concat(n.slice(0,t),e,n.slice(t+1))}function eu(n){return!(n>=55296&&n<=57343||n>=64976&&n<=65007||(n&65535)===65535||(n&65535)===65534||n>=0&&n<=8||n===11||n>=14&&n<=31||n>=127&&n<=159||n>1114111)}function Dr(n){if(n>65535){n-=65536;const t=55296+(n>>10),e=56320+(n&1023);return String.fromCharCode(t,e)}return String.fromCharCode(n)}const Hh=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,hg=/&([a-z#][a-z0-9]{1,31});/gi,dg=new RegExp(Hh.source+"|"+hg.source,"gi"),fg=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function pg(n,t){if(t.charCodeAt(0)===35&&fg.test(t)){const i=t[1].toLowerCase()==="x"?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return eu(i)?Dr(i):n}const e=Bh(n);return e!==n?e:n}function gg(n){return n.indexOf("\\")<0?n:n.replace(Hh,"$1")}function $i(n){return n.indexOf("\\")<0&&n.indexOf("&")<0?n:n.replace(dg,function(t,e,i){return e||pg(t,i)})}const mg=/[&<>"]/,bg=/[&<>"]/g,yg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function Ag(n){return yg[n]}function Xn(n){return mg.test(n)?n.replace(bg,Ag):n}const _g=/[.?*+^$[\]\\(){}|-]/g;function xg(n){return n.replace(_g,"\\$&")}function It(n){switch(n){case 9:case 32:return!0}return!1}function Ss(n){if(n>=8192&&n<=8202)return!0;switch(n){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Ts(n){return Qa.test(n)||Lh.test(n)}function ks(n){switch(n){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function qr(n){return n=n.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(n=n.replace(//g,"")),n.toLowerCase().toUpperCase()}const wg={mdurl:qp,ucmicro:Yp},vg=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:Uh,assign:Wr,escapeHtml:Xn,escapeRE:xg,fromCodePoint:Dr,has:cg,isMdAsciiPunct:ks,isPunctChar:Ts,isSpace:It,isString:tu,isValidEntityCode:eu,isWhiteSpace:Ss,lib:wg,normalizeReference:qr,unescapeAll:$i,unescapeMd:gg},Symbol.toStringTag,{value:"Module"}));function Eg(n,t,e){let i,s,r,o;const a=n.posMax,u=n.pos;for(n.pos=t+1,i=1;n.pos<a;){if(r=n.src.charCodeAt(n.pos),r===93&&(i--,i===0)){s=!0;break}if(o=n.pos,n.md.inline.skipToken(n),r===91){if(o===n.pos-1)i++;else if(e)return n.pos=u,-1}}let l=-1;return s&&(l=n.pos),n.pos=u,l}function Cg(n,t,e){let i,s=t;const r={ok:!1,pos:0,str:""};if(n.charCodeAt(s)===60){for(s++;s<e;){if(i=n.charCodeAt(s),i===10||i===60)return r;if(i===62)return r.pos=s+1,r.str=$i(n.slice(t+1,s)),r.ok=!0,r;if(i===92&&s+1<e){s+=2;continue}s++}return r}let o=0;for(;s<e&&(i=n.charCodeAt(s),!(i===32||i<32||i===127));){if(i===92&&s+1<e){if(n.charCodeAt(s+1)===32)break;s+=2;continue}if(i===40&&(o++,o>32))return r;if(i===41){if(o===0)break;o--}s++}return t===s||o!==0||(r.str=$i(n.slice(t,s)),r.pos=s,r.ok=!0),r}function Sg(n,t,e,i){let s,r=t;const o={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(i)o.str=i.str,o.marker=i.marker;else{if(r>=e)return o;let a=n.charCodeAt(r);if(a!==34&&a!==39&&a!==40)return o;t++,r++,a===40&&(a=41),o.marker=a}for(;r<e;){if(s=n.charCodeAt(r),s===o.marker)return o.pos=r+1,o.str+=$i(n.slice(t,r)),o.ok=!0,o;if(s===40&&o.marker===41)return o;s===92&&r+1<e&&r++,r++}return o.can_continue=!0,o.str+=$i(n.slice(t,r)),o}const Tg=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:Cg,parseLinkLabel:Eg,parseLinkTitle:Sg},Symbol.toStringTag,{value:"Module"})),yn={};yn.code_inline=function(n,t,e,i,s){const r=n[t];return"<code"+s.renderAttrs(r)+">"+Xn(r.content)+"</code>"};yn.code_block=function(n,t,e,i,s){const r=n[t];return"<pre"+s.renderAttrs(r)+"><code>"+Xn(n[t].content)+`</code></pre>
`};yn.fence=function(n,t,e,i,s){const r=n[t],o=r.info?$i(r.info).trim():"";let a="",u="";if(o){const c=o.split(/(\s+)/g);a=c[0],u=c.slice(2).join("")}let l;if(e.highlight?l=e.highlight(r.content,a,u)||Xn(r.content):l=Xn(r.content),l.indexOf("<pre")===0)return l+`
`;if(o){const c=r.attrIndex("class"),h=r.attrs?r.attrs.slice():[];c<0?h.push(["class",e.langPrefix+a]):(h[c]=h[c].slice(),h[c][1]+=" "+e.langPrefix+a);const d={attrs:h};return`<pre><code${s.renderAttrs(d)}>${l}</code></pre>
`}return`<pre><code${s.renderAttrs(r)}>${l}</code></pre>
`};yn.image=function(n,t,e,i,s){const r=n[t];return r.attrs[r.attrIndex("alt")][1]=s.renderInlineAsText(r.children,e,i),s.renderToken(n,t,e)};yn.hardbreak=function(n,t,e){return e.xhtmlOut?`<br />
`:`<br>
`};yn.softbreak=function(n,t,e){return e.breaks?e.xhtmlOut?`<br />
`:`<br>
`:`
`};yn.text=function(n,t){return Xn(n[t].content)};yn.html_block=function(n,t){return n[t].content};yn.html_inline=function(n,t){return n[t].content};function Vi(){this.rules=Wr({},yn)}Vi.prototype.renderAttrs=function(t){let e,i,s;if(!t.attrs)return"";for(s="",e=0,i=t.attrs.length;e<i;e++)s+=" "+Xn(t.attrs[e][0])+'="'+Xn(t.attrs[e][1])+'"';return s};Vi.prototype.renderToken=function(t,e,i){const s=t[e];let r="";if(s.hidden)return"";s.block&&s.nesting!==-1&&e&&t[e-1].hidden&&(r+=`
`),r+=(s.nesting===-1?"</":"<")+s.tag,r+=this.renderAttrs(s),s.nesting===0&&i.xhtmlOut&&(r+=" /");let o=!1;if(s.block&&(o=!0,s.nesting===1&&e+1<t.length)){const a=t[e+1];(a.type==="inline"||a.hidden||a.nesting===-1&&a.tag===s.tag)&&(o=!1)}return r+=o?`>
`:">",r};Vi.prototype.renderInline=function(n,t,e){let i="";const s=this.rules;for(let r=0,o=n.length;r<o;r++){const a=n[r].type;typeof s[a]<"u"?i+=s[a](n,r,t,e,this):i+=this.renderToken(n,r,t)}return i};Vi.prototype.renderInlineAsText=function(n,t,e){let i="";for(let s=0,r=n.length;s<r;s++)switch(n[s].type){case"text":i+=n[s].content;break;case"image":i+=this.renderInlineAsText(n[s].children,t,e);break;case"html_inline":case"html_block":i+=n[s].content;break;case"softbreak":case"hardbreak":i+=`
`;break}return i};Vi.prototype.render=function(n,t,e){let i="";const s=this.rules;for(let r=0,o=n.length;r<o;r++){const a=n[r].type;a==="inline"?i+=this.renderInline(n[r].children,t,e):typeof s[a]<"u"?i+=s[a](n,r,t,e,this):i+=this.renderToken(n,r,t,e)}return i};function Re(){this.__rules__=[],this.__cache__=null}Re.prototype.__find__=function(n){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===n)return t;return-1};Re.prototype.__compile__=function(){const n=this,t=[""];n.__rules__.forEach(function(e){e.enabled&&e.alt.forEach(function(i){t.indexOf(i)<0&&t.push(i)})}),n.__cache__={},t.forEach(function(e){n.__cache__[e]=[],n.__rules__.forEach(function(i){i.enabled&&(e&&i.alt.indexOf(e)<0||n.__cache__[e].push(i.fn))})})};Re.prototype.at=function(n,t,e){const i=this.__find__(n),s=e||{};if(i===-1)throw new Error("Parser rule not found: "+n);this.__rules__[i].fn=t,this.__rules__[i].alt=s.alt||[],this.__cache__=null};Re.prototype.before=function(n,t,e,i){const s=this.__find__(n),r=i||{};if(s===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(s,0,{name:t,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};Re.prototype.after=function(n,t,e,i){const s=this.__find__(n),r=i||{};if(s===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(s+1,0,{name:t,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};Re.prototype.push=function(n,t,e){const i=e||{};this.__rules__.push({name:n,enabled:!0,fn:t,alt:i.alt||[]}),this.__cache__=null};Re.prototype.enable=function(n,t){Array.isArray(n)||(n=[n]);const e=[];return n.forEach(function(i){const s=this.__find__(i);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+i)}this.__rules__[s].enabled=!0,e.push(i)},this),this.__cache__=null,e};Re.prototype.enableOnly=function(n,t){Array.isArray(n)||(n=[n]),this.__rules__.forEach(function(e){e.enabled=!1}),this.enable(n,t)};Re.prototype.disable=function(n,t){Array.isArray(n)||(n=[n]);const e=[];return n.forEach(function(i){const s=this.__find__(i);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+i)}this.__rules__[s].enabled=!1,e.push(i)},this),this.__cache__=null,e};Re.prototype.getRules=function(n){return this.__cache__===null&&this.__compile__(),this.__cache__[n]||[]};function tn(n,t,e){this.type=n,this.tag=t,this.attrs=null,this.map=null,this.nesting=e,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}tn.prototype.attrIndex=function(t){if(!this.attrs)return-1;const e=this.attrs;for(let i=0,s=e.length;i<s;i++)if(e[i][0]===t)return i;return-1};tn.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]};tn.prototype.attrSet=function(t,e){const i=this.attrIndex(t),s=[t,e];i<0?this.attrPush(s):this.attrs[i]=s};tn.prototype.attrGet=function(t){const e=this.attrIndex(t);let i=null;return e>=0&&(i=this.attrs[e][1]),i};tn.prototype.attrJoin=function(t,e){const i=this.attrIndex(t);i<0?this.attrPush([t,e]):this.attrs[i][1]=this.attrs[i][1]+" "+e};function zh(n,t,e){this.src=n,this.env=e,this.tokens=[],this.inlineMode=!1,this.md=t}zh.prototype.Token=tn;const kg=/\r\n?|\n/g,Dg=/\0/g;function Mg(n){let t;t=n.src.replace(kg,`
`),t=t.replace(Dg,""),n.src=t}function Pg(n){let t;n.inlineMode?(t=new n.Token("inline","",0),t.content=n.src,t.map=[0,1],t.children=[],n.tokens.push(t)):n.md.block.parse(n.src,n.md,n.env,n.tokens)}function Fg(n){const t=n.tokens;for(let e=0,i=t.length;e<i;e++){const s=t[e];s.type==="inline"&&n.md.inline.parse(s.content,n.md,n.env,s.children)}}function Rg(n){return/^<a[>\s]/i.test(n)}function Ig(n){return/^<\/a\s*>/i.test(n)}function Lg(n){const t=n.tokens;if(n.md.options.linkify)for(let e=0,i=t.length;e<i;e++){if(t[e].type!=="inline"||!n.md.linkify.pretest(t[e].content))continue;let s=t[e].children,r=0;for(let o=s.length-1;o>=0;o--){const a=s[o];if(a.type==="link_close"){for(o--;s[o].level!==a.level&&s[o].type!=="link_open";)o--;continue}if(a.type==="html_inline"&&(Rg(a.content)&&r>0&&r--,Ig(a.content)&&r++),!(r>0)&&a.type==="text"&&n.md.linkify.test(a.content)){const u=a.content;let l=n.md.linkify.match(u);const c=[];let h=a.level,d=0;l.length>0&&l[0].index===0&&o>0&&s[o-1].type==="text_special"&&(l=l.slice(1));for(let f=0;f<l.length;f++){const p=l[f].url,g=n.md.normalizeLink(p);if(!n.md.validateLink(g))continue;let b=l[f].text;l[f].schema?l[f].schema==="mailto:"&&!/^mailto:/i.test(b)?b=n.md.normalizeLinkText("mailto:"+b).replace(/^mailto:/,""):b=n.md.normalizeLinkText(b):b=n.md.normalizeLinkText("http://"+b).replace(/^http:\/\//,"");const m=l[f].index;if(m>d){const x=new n.Token("text","",0);x.content=u.slice(d,m),x.level=h,c.push(x)}const A=new n.Token("link_open","a",1);A.attrs=[["href",g]],A.level=h++,A.markup="linkify",A.info="auto",c.push(A);const y=new n.Token("text","",0);y.content=b,y.level=h,c.push(y);const _=new n.Token("link_close","a",-1);_.level=--h,_.markup="linkify",_.info="auto",c.push(_),d=l[f].lastIndex}if(d<u.length){const f=new n.Token("text","",0);f.content=u.slice(d),f.level=h,c.push(f)}t[e].children=s=Uh(s,o,c)}}}}const $h=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,Og=/\((c|tm|r)\)/i,Ng=/\((c|tm|r)\)/ig,Bg={c:"",r:"",tm:""};function Ug(n,t){return Bg[t.toLowerCase()]}function Hg(n){let t=0;for(let e=n.length-1;e>=0;e--){const i=n[e];i.type==="text"&&!t&&(i.content=i.content.replace(Ng,Ug)),i.type==="link_open"&&i.info==="auto"&&t--,i.type==="link_close"&&i.info==="auto"&&t++}}function zg(n){let t=0;for(let e=n.length-1;e>=0;e--){const i=n[e];i.type==="text"&&!t&&$h.test(i.content)&&(i.content=i.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),i.type==="link_open"&&i.info==="auto"&&t--,i.type==="link_close"&&i.info==="auto"&&t++}}function $g(n){let t;if(n.md.options.typographer)for(t=n.tokens.length-1;t>=0;t--)n.tokens[t].type==="inline"&&(Og.test(n.tokens[t].content)&&Hg(n.tokens[t].children),$h.test(n.tokens[t].content)&&zg(n.tokens[t].children))}const jg=/['"]/,wl=/['"]/g,vl="";function Js(n,t,e){return n.slice(0,t)+e+n.slice(t+1)}function Gg(n,t){let e;const i=[];for(let s=0;s<n.length;s++){const r=n[s],o=n[s].level;for(e=i.length-1;e>=0&&!(i[e].level<=o);e--);if(i.length=e+1,r.type!=="text")continue;let a=r.content,u=0,l=a.length;t:for(;u<l;){wl.lastIndex=u;const c=wl.exec(a);if(!c)break;let h=!0,d=!0;u=c.index+1;const f=c[0]==="'";let p=32;if(c.index-1>=0)p=a.charCodeAt(c.index-1);else for(e=s-1;e>=0&&!(n[e].type==="softbreak"||n[e].type==="hardbreak");e--)if(n[e].content){p=n[e].content.charCodeAt(n[e].content.length-1);break}let g=32;if(u<l)g=a.charCodeAt(u);else for(e=s+1;e<n.length&&!(n[e].type==="softbreak"||n[e].type==="hardbreak");e++)if(n[e].content){g=n[e].content.charCodeAt(0);break}const b=ks(p)||Ts(String.fromCharCode(p)),m=ks(g)||Ts(String.fromCharCode(g)),A=Ss(p),y=Ss(g);if(y?h=!1:m&&(A||b||(h=!1)),A?d=!1:b&&(y||m||(d=!1)),g===34&&c[0]==='"'&&p>=48&&p<=57&&(d=h=!1),h&&d&&(h=b,d=m),!h&&!d){f&&(r.content=Js(r.content,c.index,vl));continue}if(d)for(e=i.length-1;e>=0;e--){let _=i[e];if(i[e].level<o)break;if(_.single===f&&i[e].level===o){_=i[e];let x,v;f?(x=t.md.options.quotes[2],v=t.md.options.quotes[3]):(x=t.md.options.quotes[0],v=t.md.options.quotes[1]),r.content=Js(r.content,c.index,v),n[_.token].content=Js(n[_.token].content,_.pos,x),u+=v.length-1,_.token===s&&(u+=x.length-1),a=r.content,l=a.length,i.length=e;continue t}}h?i.push({token:s,pos:c.index,single:f,level:o}):d&&f&&(r.content=Js(r.content,c.index,vl))}}}function Vg(n){if(n.md.options.typographer)for(let t=n.tokens.length-1;t>=0;t--)n.tokens[t].type!=="inline"||!jg.test(n.tokens[t].content)||Gg(n.tokens[t].children,n)}function Wg(n){let t,e;const i=n.tokens,s=i.length;for(let r=0;r<s;r++){if(i[r].type!=="inline")continue;const o=i[r].children,a=o.length;for(t=0;t<a;t++)o[t].type==="text_special"&&(o[t].type="text");for(t=e=0;t<a;t++)o[t].type==="text"&&t+1<a&&o[t+1].type==="text"?o[t+1].content=o[t].content+o[t+1].content:(t!==e&&(o[e]=o[t]),e++);t!==e&&(o.length=e)}}const So=[["normalize",Mg],["block",Pg],["inline",Fg],["linkify",Lg],["replacements",$g],["smartquotes",Vg],["text_join",Wg]];function nu(){this.ruler=new Re;for(let n=0;n<So.length;n++)this.ruler.push(So[n][0],So[n][1])}nu.prototype.process=function(n){const t=this.ruler.getRules("");for(let e=0,i=t.length;e<i;e++)t[e](n)};nu.prototype.State=zh;function An(n,t,e,i){this.src=n,this.md=t,this.env=e,this.tokens=i,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const s=this.src;for(let r=0,o=0,a=0,u=0,l=s.length,c=!1;o<l;o++){const h=s.charCodeAt(o);if(!c)if(It(h)){a++,h===9?u+=4-u%4:u++;continue}else c=!0;(h===10||o===l-1)&&(h!==10&&o++,this.bMarks.push(r),this.eMarks.push(o),this.tShift.push(a),this.sCount.push(u),this.bsCount.push(0),c=!1,a=0,u=0,r=o+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}An.prototype.push=function(n,t,e){const i=new tn(n,t,e);return i.block=!0,e<0&&this.level--,i.level=this.level,e>0&&this.level++,this.tokens.push(i),i};An.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]};An.prototype.skipEmptyLines=function(t){for(let e=this.lineMax;t<e&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t};An.prototype.skipSpaces=function(t){for(let e=this.src.length;t<e;t++){const i=this.src.charCodeAt(t);if(!It(i))break}return t};An.prototype.skipSpacesBack=function(t,e){if(t<=e)return t;for(;t>e;)if(!It(this.src.charCodeAt(--t)))return t+1;return t};An.prototype.skipChars=function(t,e){for(let i=this.src.length;t<i&&this.src.charCodeAt(t)===e;t++);return t};An.prototype.skipCharsBack=function(t,e,i){if(t<=i)return t;for(;t>i;)if(e!==this.src.charCodeAt(--t))return t+1;return t};An.prototype.getLines=function(t,e,i,s){if(t>=e)return"";const r=new Array(e-t);for(let o=0,a=t;a<e;a++,o++){let u=0;const l=this.bMarks[a];let c=l,h;for(a+1<e||s?h=this.eMarks[a]+1:h=this.eMarks[a];c<h&&u<i;){const d=this.src.charCodeAt(c);if(It(d))d===9?u+=4-(u+this.bsCount[a])%4:u++;else if(c-l<this.tShift[a])u++;else break;c++}u>i?r[o]=new Array(u-i+1).join(" ")+this.src.slice(c,h):r[o]=this.src.slice(c,h)}return r.join("")};An.prototype.Token=tn;const qg=65536;function To(n,t){const e=n.bMarks[t]+n.tShift[t],i=n.eMarks[t];return n.src.slice(e,i)}function El(n){const t=[],e=n.length;let i=0,s=n.charCodeAt(i),r=!1,o=0,a="";for(;i<e;)s===124&&(r?(a+=n.substring(o,i-1),o=i):(t.push(a+n.substring(o,i)),a="",o=i+1)),r=s===92,i++,s=n.charCodeAt(i);return t.push(a+n.substring(o)),t}function Xg(n,t,e,i){if(t+2>e)return!1;let s=t+1;if(n.sCount[s]<n.blkIndent||n.sCount[s]-n.blkIndent>=4)return!1;let r=n.bMarks[s]+n.tShift[s];if(r>=n.eMarks[s])return!1;const o=n.src.charCodeAt(r++);if(o!==124&&o!==45&&o!==58||r>=n.eMarks[s])return!1;const a=n.src.charCodeAt(r++);if(a!==124&&a!==45&&a!==58&&!It(a)||o===45&&It(a))return!1;for(;r<n.eMarks[s];){const _=n.src.charCodeAt(r);if(_!==124&&_!==45&&_!==58&&!It(_))return!1;r++}let u=To(n,t+1),l=u.split("|");const c=[];for(let _=0;_<l.length;_++){const x=l[_].trim();if(!x){if(_===0||_===l.length-1)continue;return!1}if(!/^:?-+:?$/.test(x))return!1;x.charCodeAt(x.length-1)===58?c.push(x.charCodeAt(0)===58?"center":"right"):x.charCodeAt(0)===58?c.push("left"):c.push("")}if(u=To(n,t).trim(),u.indexOf("|")===-1||n.sCount[t]-n.blkIndent>=4)return!1;l=El(u),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop();const h=l.length;if(h===0||h!==c.length)return!1;if(i)return!0;const d=n.parentType;n.parentType="table";const f=n.md.block.ruler.getRules("blockquote"),p=n.push("table_open","table",1),g=[t,0];p.map=g;const b=n.push("thead_open","thead",1);b.map=[t,t+1];const m=n.push("tr_open","tr",1);m.map=[t,t+1];for(let _=0;_<l.length;_++){const x=n.push("th_open","th",1);c[_]&&(x.attrs=[["style","text-align:"+c[_]]]);const v=n.push("inline","",0);v.content=l[_].trim(),v.children=[],n.push("th_close","th",-1)}n.push("tr_close","tr",-1),n.push("thead_close","thead",-1);let A,y=0;for(s=t+2;s<e&&!(n.sCount[s]<n.blkIndent);s++){let _=!1;for(let v=0,S=f.length;v<S;v++)if(f[v](n,s,e,!0)){_=!0;break}if(_||(u=To(n,s).trim(),!u)||n.sCount[s]-n.blkIndent>=4||(l=El(u),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop(),y+=h-l.length,y>qg))break;if(s===t+2){const v=n.push("tbody_open","tbody",1);v.map=A=[t+2,0]}const x=n.push("tr_open","tr",1);x.map=[s,s+1];for(let v=0;v<h;v++){const S=n.push("td_open","td",1);c[v]&&(S.attrs=[["style","text-align:"+c[v]]]);const M=n.push("inline","",0);M.content=l[v]?l[v].trim():"",M.children=[],n.push("td_close","td",-1)}n.push("tr_close","tr",-1)}return A&&(n.push("tbody_close","tbody",-1),A[1]=s),n.push("table_close","table",-1),g[1]=s,n.parentType=d,n.line=s,!0}function Yg(n,t,e){if(n.sCount[t]-n.blkIndent<4)return!1;let i=t+1,s=i;for(;i<e;){if(n.isEmpty(i)){i++;continue}if(n.sCount[i]-n.blkIndent>=4){i++,s=i;continue}break}n.line=s;const r=n.push("code_block","code",0);return r.content=n.getLines(t,s,4+n.blkIndent,!1)+`
`,r.map=[t,n.line],!0}function Kg(n,t,e,i){let s=n.bMarks[t]+n.tShift[t],r=n.eMarks[t];if(n.sCount[t]-n.blkIndent>=4||s+3>r)return!1;const o=n.src.charCodeAt(s);if(o!==126&&o!==96)return!1;let a=s;s=n.skipChars(s,o);let u=s-a;if(u<3)return!1;const l=n.src.slice(a,s),c=n.src.slice(s,r);if(o===96&&c.indexOf(String.fromCharCode(o))>=0)return!1;if(i)return!0;let h=t,d=!1;for(;h++,!(h>=e||(s=a=n.bMarks[h]+n.tShift[h],r=n.eMarks[h],s<r&&n.sCount[h]<n.blkIndent));)if(n.src.charCodeAt(s)===o&&!(n.sCount[h]-n.blkIndent>=4)&&(s=n.skipChars(s,o),!(s-a<u)&&(s=n.skipSpaces(s),!(s<r)))){d=!0;break}u=n.sCount[t],n.line=h+(d?1:0);const f=n.push("fence","code",0);return f.info=c,f.content=n.getLines(t+1,h,u,!0),f.markup=l,f.map=[t,n.line],!0}function Zg(n,t,e,i){let s=n.bMarks[t]+n.tShift[t],r=n.eMarks[t];const o=n.lineMax;if(n.sCount[t]-n.blkIndent>=4||n.src.charCodeAt(s)!==62)return!1;if(i)return!0;const a=[],u=[],l=[],c=[],h=n.md.block.ruler.getRules("blockquote"),d=n.parentType;n.parentType="blockquote";let f=!1,p;for(p=t;p<e;p++){const y=n.sCount[p]<n.blkIndent;if(s=n.bMarks[p]+n.tShift[p],r=n.eMarks[p],s>=r)break;if(n.src.charCodeAt(s++)===62&&!y){let x=n.sCount[p]+1,v,S;n.src.charCodeAt(s)===32?(s++,x++,S=!1,v=!0):n.src.charCodeAt(s)===9?(v=!0,(n.bsCount[p]+x)%4===3?(s++,x++,S=!1):S=!0):v=!1;let M=x;for(a.push(n.bMarks[p]),n.bMarks[p]=s;s<r;){const R=n.src.charCodeAt(s);if(It(R))R===9?M+=4-(M+n.bsCount[p]+(S?1:0))%4:M++;else break;s++}f=s>=r,u.push(n.bsCount[p]),n.bsCount[p]=n.sCount[p]+1+(v?1:0),l.push(n.sCount[p]),n.sCount[p]=M-x,c.push(n.tShift[p]),n.tShift[p]=s-n.bMarks[p];continue}if(f)break;let _=!1;for(let x=0,v=h.length;x<v;x++)if(h[x](n,p,e,!0)){_=!0;break}if(_){n.lineMax=p,n.blkIndent!==0&&(a.push(n.bMarks[p]),u.push(n.bsCount[p]),c.push(n.tShift[p]),l.push(n.sCount[p]),n.sCount[p]-=n.blkIndent);break}a.push(n.bMarks[p]),u.push(n.bsCount[p]),c.push(n.tShift[p]),l.push(n.sCount[p]),n.sCount[p]=-1}const g=n.blkIndent;n.blkIndent=0;const b=n.push("blockquote_open","blockquote",1);b.markup=">";const m=[t,0];b.map=m,n.md.block.tokenize(n,t,p);const A=n.push("blockquote_close","blockquote",-1);A.markup=">",n.lineMax=o,n.parentType=d,m[1]=n.line;for(let y=0;y<c.length;y++)n.bMarks[y+t]=a[y],n.tShift[y+t]=c[y],n.sCount[y+t]=l[y],n.bsCount[y+t]=u[y];return n.blkIndent=g,!0}function Jg(n,t,e,i){const s=n.eMarks[t];if(n.sCount[t]-n.blkIndent>=4)return!1;let r=n.bMarks[t]+n.tShift[t];const o=n.src.charCodeAt(r++);if(o!==42&&o!==45&&o!==95)return!1;let a=1;for(;r<s;){const l=n.src.charCodeAt(r++);if(l!==o&&!It(l))return!1;l===o&&a++}if(a<3)return!1;if(i)return!0;n.line=t+1;const u=n.push("hr","hr",0);return u.map=[t,n.line],u.markup=Array(a+1).join(String.fromCharCode(o)),!0}function Cl(n,t){const e=n.eMarks[t];let i=n.bMarks[t]+n.tShift[t];const s=n.src.charCodeAt(i++);if(s!==42&&s!==45&&s!==43)return-1;if(i<e){const r=n.src.charCodeAt(i);if(!It(r))return-1}return i}function Sl(n,t){const e=n.bMarks[t]+n.tShift[t],i=n.eMarks[t];let s=e;if(s+1>=i)return-1;let r=n.src.charCodeAt(s++);if(r<48||r>57)return-1;for(;;){if(s>=i)return-1;if(r=n.src.charCodeAt(s++),r>=48&&r<=57){if(s-e>=10)return-1;continue}if(r===41||r===46)break;return-1}return s<i&&(r=n.src.charCodeAt(s),!It(r))?-1:s}function Qg(n,t){const e=n.level+2;for(let i=t+2,s=n.tokens.length-2;i<s;i++)n.tokens[i].level===e&&n.tokens[i].type==="paragraph_open"&&(n.tokens[i+2].hidden=!0,n.tokens[i].hidden=!0,i+=2)}function tm(n,t,e,i){let s,r,o,a,u=t,l=!0;if(n.sCount[u]-n.blkIndent>=4||n.listIndent>=0&&n.sCount[u]-n.listIndent>=4&&n.sCount[u]<n.blkIndent)return!1;let c=!1;i&&n.parentType==="paragraph"&&n.sCount[u]>=n.blkIndent&&(c=!0);let h,d,f;if((f=Sl(n,u))>=0){if(h=!0,o=n.bMarks[u]+n.tShift[u],d=Number(n.src.slice(o,f-1)),c&&d!==1)return!1}else if((f=Cl(n,u))>=0)h=!1;else return!1;if(c&&n.skipSpaces(f)>=n.eMarks[u])return!1;if(i)return!0;const p=n.src.charCodeAt(f-1),g=n.tokens.length;h?(a=n.push("ordered_list_open","ol",1),d!==1&&(a.attrs=[["start",d]])):a=n.push("bullet_list_open","ul",1);const b=[u,0];a.map=b,a.markup=String.fromCharCode(p);let m=!1;const A=n.md.block.ruler.getRules("list"),y=n.parentType;for(n.parentType="list";u<e;){r=f,s=n.eMarks[u];const _=n.sCount[u]+f-(n.bMarks[u]+n.tShift[u]);let x=_;for(;r<s;){const mt=n.src.charCodeAt(r);if(mt===9)x+=4-(x+n.bsCount[u])%4;else if(mt===32)x++;else break;r++}const v=r;let S;v>=s?S=1:S=x-_,S>4&&(S=1);const M=_+S;a=n.push("list_item_open","li",1),a.markup=String.fromCharCode(p);const R=[u,0];a.map=R,h&&(a.info=n.src.slice(o,f-1));const j=n.tight,I=n.tShift[u],Y=n.sCount[u],dt=n.listIndent;if(n.listIndent=n.blkIndent,n.blkIndent=M,n.tight=!0,n.tShift[u]=v-n.bMarks[u],n.sCount[u]=x,v>=s&&n.isEmpty(u+1)?n.line=Math.min(n.line+2,e):n.md.block.tokenize(n,u,e,!0),(!n.tight||m)&&(l=!1),m=n.line-u>1&&n.isEmpty(n.line-1),n.blkIndent=n.listIndent,n.listIndent=dt,n.tShift[u]=I,n.sCount[u]=Y,n.tight=j,a=n.push("list_item_close","li",-1),a.markup=String.fromCharCode(p),u=n.line,R[1]=u,u>=e||n.sCount[u]<n.blkIndent||n.sCount[u]-n.blkIndent>=4)break;let et=!1;for(let mt=0,U=A.length;mt<U;mt++)if(A[mt](n,u,e,!0)){et=!0;break}if(et)break;if(h){if(f=Sl(n,u),f<0)break;o=n.bMarks[u]+n.tShift[u]}else if(f=Cl(n,u),f<0)break;if(p!==n.src.charCodeAt(f-1))break}return h?a=n.push("ordered_list_close","ol",-1):a=n.push("bullet_list_close","ul",-1),a.markup=String.fromCharCode(p),b[1]=u,n.line=u,n.parentType=y,l&&Qg(n,g),!0}function em(n,t,e,i){let s=n.bMarks[t]+n.tShift[t],r=n.eMarks[t],o=t+1;if(n.sCount[t]-n.blkIndent>=4||n.src.charCodeAt(s)!==91)return!1;function a(A){const y=n.lineMax;if(A>=y||n.isEmpty(A))return null;let _=!1;if(n.sCount[A]-n.blkIndent>3&&(_=!0),n.sCount[A]<0&&(_=!0),!_){const S=n.md.block.ruler.getRules("reference"),M=n.parentType;n.parentType="reference";let R=!1;for(let j=0,I=S.length;j<I;j++)if(S[j](n,A,y,!0)){R=!0;break}if(n.parentType=M,R)return null}const x=n.bMarks[A]+n.tShift[A],v=n.eMarks[A];return n.src.slice(x,v+1)}let u=n.src.slice(s,r+1);r=u.length;let l=-1;for(s=1;s<r;s++){const A=u.charCodeAt(s);if(A===91)return!1;if(A===93){l=s;break}else if(A===10){const y=a(o);y!==null&&(u+=y,r=u.length,o++)}else if(A===92&&(s++,s<r&&u.charCodeAt(s)===10)){const y=a(o);y!==null&&(u+=y,r=u.length,o++)}}if(l<0||u.charCodeAt(l+1)!==58)return!1;for(s=l+2;s<r;s++){const A=u.charCodeAt(s);if(A===10){const y=a(o);y!==null&&(u+=y,r=u.length,o++)}else if(!It(A))break}const c=n.md.helpers.parseLinkDestination(u,s,r);if(!c.ok)return!1;const h=n.md.normalizeLink(c.str);if(!n.md.validateLink(h))return!1;s=c.pos;const d=s,f=o,p=s;for(;s<r;s++){const A=u.charCodeAt(s);if(A===10){const y=a(o);y!==null&&(u+=y,r=u.length,o++)}else if(!It(A))break}let g=n.md.helpers.parseLinkTitle(u,s,r);for(;g.can_continue;){const A=a(o);if(A===null)break;u+=A,s=r,r=u.length,o++,g=n.md.helpers.parseLinkTitle(u,s,r,g)}let b;for(s<r&&p!==s&&g.ok?(b=g.str,s=g.pos):(b="",s=d,o=f);s<r;){const A=u.charCodeAt(s);if(!It(A))break;s++}if(s<r&&u.charCodeAt(s)!==10&&b)for(b="",s=d,o=f;s<r;){const A=u.charCodeAt(s);if(!It(A))break;s++}if(s<r&&u.charCodeAt(s)!==10)return!1;const m=qr(u.slice(1,l));return m?(i||(typeof n.env.references>"u"&&(n.env.references={}),typeof n.env.references[m]>"u"&&(n.env.references[m]={title:b,href:h}),n.line=o),!0):!1}const nm=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],im="[a-zA-Z_:][a-zA-Z0-9:._-]*",sm="[^\"'=<>`\\x00-\\x20]+",rm="'[^']*'",om='"[^"]*"',am="(?:"+sm+"|"+rm+"|"+om+")",um="(?:\\s+"+im+"(?:\\s*=\\s*"+am+")?)",jh="<[A-Za-z][A-Za-z0-9\\-]*"+um+"*\\s*\\/?>",Gh="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",lm="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",cm="<[?][\\s\\S]*?[?]>",hm="<![A-Za-z][^>]*>",dm="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",fm=new RegExp("^(?:"+jh+"|"+Gh+"|"+lm+"|"+cm+"|"+hm+"|"+dm+")"),pm=new RegExp("^(?:"+jh+"|"+Gh+")"),bi=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+nm.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(pm.source+"\\s*$"),/^$/,!1]];function gm(n,t,e,i){let s=n.bMarks[t]+n.tShift[t],r=n.eMarks[t];if(n.sCount[t]-n.blkIndent>=4||!n.md.options.html||n.src.charCodeAt(s)!==60)return!1;let o=n.src.slice(s,r),a=0;for(;a<bi.length&&!bi[a][0].test(o);a++);if(a===bi.length)return!1;if(i)return bi[a][2];let u=t+1;if(!bi[a][1].test(o)){for(;u<e&&!(n.sCount[u]<n.blkIndent);u++)if(s=n.bMarks[u]+n.tShift[u],r=n.eMarks[u],o=n.src.slice(s,r),bi[a][1].test(o)){o.length!==0&&u++;break}}n.line=u;const l=n.push("html_block","",0);return l.map=[t,u],l.content=n.getLines(t,u,n.blkIndent,!0),!0}function mm(n,t,e,i){let s=n.bMarks[t]+n.tShift[t],r=n.eMarks[t];if(n.sCount[t]-n.blkIndent>=4)return!1;let o=n.src.charCodeAt(s);if(o!==35||s>=r)return!1;let a=1;for(o=n.src.charCodeAt(++s);o===35&&s<r&&a<=6;)a++,o=n.src.charCodeAt(++s);if(a>6||s<r&&!It(o))return!1;if(i)return!0;r=n.skipSpacesBack(r,s);const u=n.skipCharsBack(r,35,s);u>s&&It(n.src.charCodeAt(u-1))&&(r=u),n.line=t+1;const l=n.push("heading_open","h"+String(a),1);l.markup="########".slice(0,a),l.map=[t,n.line];const c=n.push("inline","",0);c.content=n.src.slice(s,r).trim(),c.map=[t,n.line],c.children=[];const h=n.push("heading_close","h"+String(a),-1);return h.markup="########".slice(0,a),!0}function bm(n,t,e){const i=n.md.block.ruler.getRules("paragraph");if(n.sCount[t]-n.blkIndent>=4)return!1;const s=n.parentType;n.parentType="paragraph";let r=0,o,a=t+1;for(;a<e&&!n.isEmpty(a);a++){if(n.sCount[a]-n.blkIndent>3)continue;if(n.sCount[a]>=n.blkIndent){let f=n.bMarks[a]+n.tShift[a];const p=n.eMarks[a];if(f<p&&(o=n.src.charCodeAt(f),(o===45||o===61)&&(f=n.skipChars(f,o),f=n.skipSpaces(f),f>=p))){r=o===61?1:2;break}}if(n.sCount[a]<0)continue;let d=!1;for(let f=0,p=i.length;f<p;f++)if(i[f](n,a,e,!0)){d=!0;break}if(d)break}if(!r)return!1;const u=n.getLines(t,a,n.blkIndent,!1).trim();n.line=a+1;const l=n.push("heading_open","h"+String(r),1);l.markup=String.fromCharCode(o),l.map=[t,n.line];const c=n.push("inline","",0);c.content=u,c.map=[t,n.line-1],c.children=[];const h=n.push("heading_close","h"+String(r),-1);return h.markup=String.fromCharCode(o),n.parentType=s,!0}function ym(n,t,e){const i=n.md.block.ruler.getRules("paragraph"),s=n.parentType;let r=t+1;for(n.parentType="paragraph";r<e&&!n.isEmpty(r);r++){if(n.sCount[r]-n.blkIndent>3||n.sCount[r]<0)continue;let l=!1;for(let c=0,h=i.length;c<h;c++)if(i[c](n,r,e,!0)){l=!0;break}if(l)break}const o=n.getLines(t,r,n.blkIndent,!1).trim();n.line=r;const a=n.push("paragraph_open","p",1);a.map=[t,n.line];const u=n.push("inline","",0);return u.content=o,u.map=[t,n.line],u.children=[],n.push("paragraph_close","p",-1),n.parentType=s,!0}const Qs=[["table",Xg,["paragraph","reference"]],["code",Yg],["fence",Kg,["paragraph","reference","blockquote","list"]],["blockquote",Zg,["paragraph","reference","blockquote","list"]],["hr",Jg,["paragraph","reference","blockquote","list"]],["list",tm,["paragraph","reference","blockquote"]],["reference",em],["html_block",gm,["paragraph","reference","blockquote"]],["heading",mm,["paragraph","reference","blockquote"]],["lheading",bm],["paragraph",ym]];function Xr(){this.ruler=new Re;for(let n=0;n<Qs.length;n++)this.ruler.push(Qs[n][0],Qs[n][1],{alt:(Qs[n][2]||[]).slice()})}Xr.prototype.tokenize=function(n,t,e){const i=this.ruler.getRules(""),s=i.length,r=n.md.options.maxNesting;let o=t,a=!1;for(;o<e&&(n.line=o=n.skipEmptyLines(o),!(o>=e||n.sCount[o]<n.blkIndent));){if(n.level>=r){n.line=e;break}const u=n.line;let l=!1;for(let c=0;c<s;c++)if(l=i[c](n,o,e,!1),l){if(u>=n.line)throw new Error("block rule didn't increment state.line");break}if(!l)throw new Error("none of the block rules matched");n.tight=!a,n.isEmpty(n.line-1)&&(a=!0),o=n.line,o<e&&n.isEmpty(o)&&(a=!0,o++,n.line=o)}};Xr.prototype.parse=function(n,t,e,i){if(!n)return;const s=new this.State(n,t,e,i);this.tokenize(s,s.line,s.lineMax)};Xr.prototype.State=An;function Bs(n,t,e,i){this.src=n,this.env=e,this.md=t,this.tokens=i,this.tokens_meta=Array(i.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}Bs.prototype.pushPending=function(){const n=new tn("text","",0);return n.content=this.pending,n.level=this.pendingLevel,this.tokens.push(n),this.pending="",n};Bs.prototype.push=function(n,t,e){this.pending&&this.pushPending();const i=new tn(n,t,e);let s=null;return e<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),i.level=this.level,e>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],s={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(i),this.tokens_meta.push(s),i};Bs.prototype.scanDelims=function(n,t){const e=this.posMax,i=this.src.charCodeAt(n),s=n>0?this.src.charCodeAt(n-1):32;let r=n;for(;r<e&&this.src.charCodeAt(r)===i;)r++;const o=r-n,a=r<e?this.src.charCodeAt(r):32,u=ks(s)||Ts(String.fromCharCode(s)),l=ks(a)||Ts(String.fromCharCode(a)),c=Ss(s),h=Ss(a),d=!h&&(!l||c||u),f=!c&&(!u||h||l);return{can_open:d&&(t||!f||u),can_close:f&&(t||!d||l),length:o}};Bs.prototype.Token=tn;function Am(n){switch(n){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function _m(n,t){let e=n.pos;for(;e<n.posMax&&!Am(n.src.charCodeAt(e));)e++;return e===n.pos?!1:(t||(n.pending+=n.src.slice(n.pos,e)),n.pos=e,!0)}const xm=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function wm(n,t){if(!n.md.options.linkify||n.linkLevel>0)return!1;const e=n.pos,i=n.posMax;if(e+3>i||n.src.charCodeAt(e)!==58||n.src.charCodeAt(e+1)!==47||n.src.charCodeAt(e+2)!==47)return!1;const s=n.pending.match(xm);if(!s)return!1;const r=s[1],o=n.md.linkify.matchAtStart(n.src.slice(e-r.length));if(!o)return!1;let a=o.url;if(a.length<=r.length)return!1;a=a.replace(/\*+$/,"");const u=n.md.normalizeLink(a);if(!n.md.validateLink(u))return!1;if(!t){n.pending=n.pending.slice(0,-r.length);const l=n.push("link_open","a",1);l.attrs=[["href",u]],l.markup="linkify",l.info="auto";const c=n.push("text","",0);c.content=n.md.normalizeLinkText(a);const h=n.push("link_close","a",-1);h.markup="linkify",h.info="auto"}return n.pos+=a.length-r.length,!0}function vm(n,t){let e=n.pos;if(n.src.charCodeAt(e)!==10)return!1;const i=n.pending.length-1,s=n.posMax;if(!t)if(i>=0&&n.pending.charCodeAt(i)===32)if(i>=1&&n.pending.charCodeAt(i-1)===32){let r=i-1;for(;r>=1&&n.pending.charCodeAt(r-1)===32;)r--;n.pending=n.pending.slice(0,r),n.push("hardbreak","br",0)}else n.pending=n.pending.slice(0,-1),n.push("softbreak","br",0);else n.push("softbreak","br",0);for(e++;e<s&&It(n.src.charCodeAt(e));)e++;return n.pos=e,!0}const iu=[];for(let n=0;n<256;n++)iu.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(n){iu[n.charCodeAt(0)]=1});function Em(n,t){let e=n.pos;const i=n.posMax;if(n.src.charCodeAt(e)!==92||(e++,e>=i))return!1;let s=n.src.charCodeAt(e);if(s===10){for(t||n.push("hardbreak","br",0),e++;e<i&&(s=n.src.charCodeAt(e),!!It(s));)e++;return n.pos=e,!0}let r=n.src[e];if(s>=55296&&s<=56319&&e+1<i){const a=n.src.charCodeAt(e+1);a>=56320&&a<=57343&&(r+=n.src[e+1],e++)}const o="\\"+r;if(!t){const a=n.push("text_special","",0);s<256&&iu[s]!==0?a.content=r:a.content=o,a.markup=o,a.info="escape"}return n.pos=e+1,!0}function Cm(n,t){let e=n.pos;if(n.src.charCodeAt(e)!==96)return!1;const s=e;e++;const r=n.posMax;for(;e<r&&n.src.charCodeAt(e)===96;)e++;const o=n.src.slice(s,e),a=o.length;if(n.backticksScanned&&(n.backticks[a]||0)<=s)return t||(n.pending+=o),n.pos+=a,!0;let u=e,l;for(;(l=n.src.indexOf("`",u))!==-1;){for(u=l+1;u<r&&n.src.charCodeAt(u)===96;)u++;const c=u-l;if(c===a){if(!t){const h=n.push("code_inline","code",0);h.markup=o,h.content=n.src.slice(e,l).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return n.pos=u,!0}n.backticks[c]=l}return n.backticksScanned=!0,t||(n.pending+=o),n.pos+=a,!0}function Sm(n,t){const e=n.pos,i=n.src.charCodeAt(e);if(t||i!==126)return!1;const s=n.scanDelims(n.pos,!0);let r=s.length;const o=String.fromCharCode(i);if(r<2)return!1;let a;r%2&&(a=n.push("text","",0),a.content=o,r--);for(let u=0;u<r;u+=2)a=n.push("text","",0),a.content=o+o,n.delimiters.push({marker:i,length:0,token:n.tokens.length-1,end:-1,open:s.can_open,close:s.can_close});return n.pos+=s.length,!0}function Tl(n,t){let e;const i=[],s=t.length;for(let r=0;r<s;r++){const o=t[r];if(o.marker!==126||o.end===-1)continue;const a=t[o.end];e=n.tokens[o.token],e.type="s_open",e.tag="s",e.nesting=1,e.markup="~~",e.content="",e=n.tokens[a.token],e.type="s_close",e.tag="s",e.nesting=-1,e.markup="~~",e.content="",n.tokens[a.token-1].type==="text"&&n.tokens[a.token-1].content==="~"&&i.push(a.token-1)}for(;i.length;){const r=i.pop();let o=r+1;for(;o<n.tokens.length&&n.tokens[o].type==="s_close";)o++;o--,r!==o&&(e=n.tokens[o],n.tokens[o]=n.tokens[r],n.tokens[r]=e)}}function Tm(n){const t=n.tokens_meta,e=n.tokens_meta.length;Tl(n,n.delimiters);for(let i=0;i<e;i++)t[i]&&t[i].delimiters&&Tl(n,t[i].delimiters)}const Vh={tokenize:Sm,postProcess:Tm};function km(n,t){const e=n.pos,i=n.src.charCodeAt(e);if(t||i!==95&&i!==42)return!1;const s=n.scanDelims(n.pos,i===42);for(let r=0;r<s.length;r++){const o=n.push("text","",0);o.content=String.fromCharCode(i),n.delimiters.push({marker:i,length:s.length,token:n.tokens.length-1,end:-1,open:s.can_open,close:s.can_close})}return n.pos+=s.length,!0}function kl(n,t){const e=t.length;for(let i=e-1;i>=0;i--){const s=t[i];if(s.marker!==95&&s.marker!==42||s.end===-1)continue;const r=t[s.end],o=i>0&&t[i-1].end===s.end+1&&t[i-1].marker===s.marker&&t[i-1].token===s.token-1&&t[s.end+1].token===r.token+1,a=String.fromCharCode(s.marker),u=n.tokens[s.token];u.type=o?"strong_open":"em_open",u.tag=o?"strong":"em",u.nesting=1,u.markup=o?a+a:a,u.content="";const l=n.tokens[r.token];l.type=o?"strong_close":"em_close",l.tag=o?"strong":"em",l.nesting=-1,l.markup=o?a+a:a,l.content="",o&&(n.tokens[t[i-1].token].content="",n.tokens[t[s.end+1].token].content="",i--)}}function Dm(n){const t=n.tokens_meta,e=n.tokens_meta.length;kl(n,n.delimiters);for(let i=0;i<e;i++)t[i]&&t[i].delimiters&&kl(n,t[i].delimiters)}const Wh={tokenize:km,postProcess:Dm};function Mm(n,t){let e,i,s,r,o="",a="",u=n.pos,l=!0;if(n.src.charCodeAt(n.pos)!==91)return!1;const c=n.pos,h=n.posMax,d=n.pos+1,f=n.md.helpers.parseLinkLabel(n,n.pos,!0);if(f<0)return!1;let p=f+1;if(p<h&&n.src.charCodeAt(p)===40){for(l=!1,p++;p<h&&(e=n.src.charCodeAt(p),!(!It(e)&&e!==10));p++);if(p>=h)return!1;if(u=p,s=n.md.helpers.parseLinkDestination(n.src,p,n.posMax),s.ok){for(o=n.md.normalizeLink(s.str),n.md.validateLink(o)?p=s.pos:o="",u=p;p<h&&(e=n.src.charCodeAt(p),!(!It(e)&&e!==10));p++);if(s=n.md.helpers.parseLinkTitle(n.src,p,n.posMax),p<h&&u!==p&&s.ok)for(a=s.str,p=s.pos;p<h&&(e=n.src.charCodeAt(p),!(!It(e)&&e!==10));p++);}(p>=h||n.src.charCodeAt(p)!==41)&&(l=!0),p++}if(l){if(typeof n.env.references>"u")return!1;if(p<h&&n.src.charCodeAt(p)===91?(u=p+1,p=n.md.helpers.parseLinkLabel(n,p),p>=0?i=n.src.slice(u,p++):p=f+1):p=f+1,i||(i=n.src.slice(d,f)),r=n.env.references[qr(i)],!r)return n.pos=c,!1;o=r.href,a=r.title}if(!t){n.pos=d,n.posMax=f;const g=n.push("link_open","a",1),b=[["href",o]];g.attrs=b,a&&b.push(["title",a]),n.linkLevel++,n.md.inline.tokenize(n),n.linkLevel--,n.push("link_close","a",-1)}return n.pos=p,n.posMax=h,!0}function Pm(n,t){let e,i,s,r,o,a,u,l,c="";const h=n.pos,d=n.posMax;if(n.src.charCodeAt(n.pos)!==33||n.src.charCodeAt(n.pos+1)!==91)return!1;const f=n.pos+2,p=n.md.helpers.parseLinkLabel(n,n.pos+1,!1);if(p<0)return!1;if(r=p+1,r<d&&n.src.charCodeAt(r)===40){for(r++;r<d&&(e=n.src.charCodeAt(r),!(!It(e)&&e!==10));r++);if(r>=d)return!1;for(l=r,a=n.md.helpers.parseLinkDestination(n.src,r,n.posMax),a.ok&&(c=n.md.normalizeLink(a.str),n.md.validateLink(c)?r=a.pos:c=""),l=r;r<d&&(e=n.src.charCodeAt(r),!(!It(e)&&e!==10));r++);if(a=n.md.helpers.parseLinkTitle(n.src,r,n.posMax),r<d&&l!==r&&a.ok)for(u=a.str,r=a.pos;r<d&&(e=n.src.charCodeAt(r),!(!It(e)&&e!==10));r++);else u="";if(r>=d||n.src.charCodeAt(r)!==41)return n.pos=h,!1;r++}else{if(typeof n.env.references>"u")return!1;if(r<d&&n.src.charCodeAt(r)===91?(l=r+1,r=n.md.helpers.parseLinkLabel(n,r),r>=0?s=n.src.slice(l,r++):r=p+1):r=p+1,s||(s=n.src.slice(f,p)),o=n.env.references[qr(s)],!o)return n.pos=h,!1;c=o.href,u=o.title}if(!t){i=n.src.slice(f,p);const g=[];n.md.inline.parse(i,n.md,n.env,g);const b=n.push("image","img",0),m=[["src",c],["alt",""]];b.attrs=m,b.children=g,b.content=i,u&&m.push(["title",u])}return n.pos=r,n.posMax=d,!0}const Fm=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,Rm=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function Im(n,t){let e=n.pos;if(n.src.charCodeAt(e)!==60)return!1;const i=n.pos,s=n.posMax;for(;;){if(++e>=s)return!1;const o=n.src.charCodeAt(e);if(o===60)return!1;if(o===62)break}const r=n.src.slice(i+1,e);if(Rm.test(r)){const o=n.md.normalizeLink(r);if(!n.md.validateLink(o))return!1;if(!t){const a=n.push("link_open","a",1);a.attrs=[["href",o]],a.markup="autolink",a.info="auto";const u=n.push("text","",0);u.content=n.md.normalizeLinkText(r);const l=n.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return n.pos+=r.length+2,!0}if(Fm.test(r)){const o=n.md.normalizeLink("mailto:"+r);if(!n.md.validateLink(o))return!1;if(!t){const a=n.push("link_open","a",1);a.attrs=[["href",o]],a.markup="autolink",a.info="auto";const u=n.push("text","",0);u.content=n.md.normalizeLinkText(r);const l=n.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return n.pos+=r.length+2,!0}return!1}function Lm(n){return/^<a[>\s]/i.test(n)}function Om(n){return/^<\/a\s*>/i.test(n)}function Nm(n){const t=n|32;return t>=97&&t<=122}function Bm(n,t){if(!n.md.options.html)return!1;const e=n.posMax,i=n.pos;if(n.src.charCodeAt(i)!==60||i+2>=e)return!1;const s=n.src.charCodeAt(i+1);if(s!==33&&s!==63&&s!==47&&!Nm(s))return!1;const r=n.src.slice(i).match(fm);if(!r)return!1;if(!t){const o=n.push("html_inline","",0);o.content=r[0],Lm(o.content)&&n.linkLevel++,Om(o.content)&&n.linkLevel--}return n.pos+=r[0].length,!0}const Um=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,Hm=/^&([a-z][a-z0-9]{1,31});/i;function zm(n,t){const e=n.pos,i=n.posMax;if(n.src.charCodeAt(e)!==38||e+1>=i)return!1;if(n.src.charCodeAt(e+1)===35){const r=n.src.slice(e).match(Um);if(r){if(!t){const o=r[1][0].toLowerCase()==="x"?parseInt(r[1].slice(1),16):parseInt(r[1],10),a=n.push("text_special","",0);a.content=eu(o)?Dr(o):Dr(65533),a.markup=r[0],a.info="entity"}return n.pos+=r[0].length,!0}}else{const r=n.src.slice(e).match(Hm);if(r){const o=Bh(r[0]);if(o!==r[0]){if(!t){const a=n.push("text_special","",0);a.content=o,a.markup=r[0],a.info="entity"}return n.pos+=r[0].length,!0}}}return!1}function Dl(n){const t={},e=n.length;if(!e)return;let i=0,s=-2;const r=[];for(let o=0;o<e;o++){const a=n[o];if(r.push(0),(n[i].marker!==a.marker||s!==a.token-1)&&(i=o),s=a.token,a.length=a.length||0,!a.close)continue;t.hasOwnProperty(a.marker)||(t[a.marker]=[-1,-1,-1,-1,-1,-1]);const u=t[a.marker][(a.open?3:0)+a.length%3];let l=i-r[i]-1,c=l;for(;l>u;l-=r[l]+1){const h=n[l];if(h.marker===a.marker&&h.open&&h.end<0){let d=!1;if((h.close||a.open)&&(h.length+a.length)%3===0&&(h.length%3!==0||a.length%3!==0)&&(d=!0),!d){const f=l>0&&!n[l-1].open?r[l-1]+1:0;r[o]=o-l+f,r[l]=f,a.open=!1,h.end=o,h.close=!1,c=-1,s=-2;break}}}c!==-1&&(t[a.marker][(a.open?3:0)+(a.length||0)%3]=c)}}function $m(n){const t=n.tokens_meta,e=n.tokens_meta.length;Dl(n.delimiters);for(let i=0;i<e;i++)t[i]&&t[i].delimiters&&Dl(t[i].delimiters)}function jm(n){let t,e,i=0;const s=n.tokens,r=n.tokens.length;for(t=e=0;t<r;t++)s[t].nesting<0&&i--,s[t].level=i,s[t].nesting>0&&i++,s[t].type==="text"&&t+1<r&&s[t+1].type==="text"?s[t+1].content=s[t].content+s[t+1].content:(t!==e&&(s[e]=s[t]),e++);t!==e&&(s.length=e)}const ko=[["text",_m],["linkify",wm],["newline",vm],["escape",Em],["backticks",Cm],["strikethrough",Vh.tokenize],["emphasis",Wh.tokenize],["link",Mm],["image",Pm],["autolink",Im],["html_inline",Bm],["entity",zm]],Do=[["balance_pairs",$m],["strikethrough",Vh.postProcess],["emphasis",Wh.postProcess],["fragments_join",jm]];function Us(){this.ruler=new Re;for(let n=0;n<ko.length;n++)this.ruler.push(ko[n][0],ko[n][1]);this.ruler2=new Re;for(let n=0;n<Do.length;n++)this.ruler2.push(Do[n][0],Do[n][1])}Us.prototype.skipToken=function(n){const t=n.pos,e=this.ruler.getRules(""),i=e.length,s=n.md.options.maxNesting,r=n.cache;if(typeof r[t]<"u"){n.pos=r[t];return}let o=!1;if(n.level<s){for(let a=0;a<i;a++)if(n.level++,o=e[a](n,!0),n.level--,o){if(t>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}else n.pos=n.posMax;o||n.pos++,r[t]=n.pos};Us.prototype.tokenize=function(n){const t=this.ruler.getRules(""),e=t.length,i=n.posMax,s=n.md.options.maxNesting;for(;n.pos<i;){const r=n.pos;let o=!1;if(n.level<s){for(let a=0;a<e;a++)if(o=t[a](n,!1),o){if(r>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}if(o){if(n.pos>=i)break;continue}n.pending+=n.src[n.pos++]}n.pending&&n.pushPending()};Us.prototype.parse=function(n,t,e,i){const s=new this.State(n,t,e,i);this.tokenize(s);const r=this.ruler2.getRules(""),o=r.length;for(let a=0;a<o;a++)r[a](s)};Us.prototype.State=Bs;function Gm(n){const t={};n=n||{},t.src_Any=Rh.source,t.src_Cc=Ih.source,t.src_Z=Oh.source,t.src_P=Qa.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const e="[><]";return t.src_pseudo_letter="(?:(?!"+e+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+e+"|"+t.src_ZPCc+")(?!"+(n["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+e+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(n["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+e+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}function ha(n){return Array.prototype.slice.call(arguments,1).forEach(function(e){e&&Object.keys(e).forEach(function(i){n[i]=e[i]})}),n}function Yr(n){return Object.prototype.toString.call(n)}function Vm(n){return Yr(n)==="[object String]"}function Wm(n){return Yr(n)==="[object Object]"}function qm(n){return Yr(n)==="[object RegExp]"}function Ml(n){return Yr(n)==="[object Function]"}function Xm(n){return n.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const qh={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function Ym(n){return Object.keys(n||{}).reduce(function(t,e){return t||qh.hasOwnProperty(e)},!1)}const Km={"http:":{validate:function(n,t,e){const i=n.slice(t);return e.re.http||(e.re.http=new RegExp("^\\/\\/"+e.re.src_auth+e.re.src_host_port_strict+e.re.src_path,"i")),e.re.http.test(i)?i.match(e.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(n,t,e){const i=n.slice(t);return e.re.no_http||(e.re.no_http=new RegExp("^"+e.re.src_auth+"(?:localhost|(?:(?:"+e.re.src_domain+")\\.)+"+e.re.src_domain_root+")"+e.re.src_port+e.re.src_host_terminator+e.re.src_path,"i")),e.re.no_http.test(i)?t>=3&&n[t-3]===":"||t>=3&&n[t-3]==="/"?0:i.match(e.re.no_http)[0].length:0}},"mailto:":{validate:function(n,t,e){const i=n.slice(t);return e.re.mailto||(e.re.mailto=new RegExp("^"+e.re.src_email_name+"@"+e.re.src_host_strict,"i")),e.re.mailto.test(i)?i.match(e.re.mailto)[0].length:0}}},Zm="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",Jm="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function Qm(n){n.__index__=-1,n.__text_cache__=""}function tb(n){return function(t,e){const i=t.slice(e);return n.test(i)?i.match(n)[0].length:0}}function Pl(){return function(n,t){t.normalize(n)}}function Mr(n){const t=n.re=Gm(n.__opts__),e=n.__tlds__.slice();n.onCompile(),n.__tlds_replaced__||e.push(Zm),e.push(t.src_xn),t.src_tlds=e.join("|");function i(a){return a.replace("%TLDS%",t.src_tlds)}t.email_fuzzy=RegExp(i(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(i(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(i(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(i(t.tpl_host_fuzzy_test),"i");const s=[];n.__compiled__={};function r(a,u){throw new Error('(LinkifyIt) Invalid schema "'+a+'": '+u)}Object.keys(n.__schemas__).forEach(function(a){const u=n.__schemas__[a];if(u===null)return;const l={validate:null,link:null};if(n.__compiled__[a]=l,Wm(u)){qm(u.validate)?l.validate=tb(u.validate):Ml(u.validate)?l.validate=u.validate:r(a,u),Ml(u.normalize)?l.normalize=u.normalize:u.normalize?r(a,u):l.normalize=Pl();return}if(Vm(u)){s.push(a);return}r(a,u)}),s.forEach(function(a){n.__compiled__[n.__schemas__[a]]&&(n.__compiled__[a].validate=n.__compiled__[n.__schemas__[a]].validate,n.__compiled__[a].normalize=n.__compiled__[n.__schemas__[a]].normalize)}),n.__compiled__[""]={validate:null,normalize:Pl()};const o=Object.keys(n.__compiled__).filter(function(a){return a.length>0&&n.__compiled__[a]}).map(Xm).join("|");n.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+o+")","i"),n.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+o+")","ig"),n.re.schema_at_start=RegExp("^"+n.re.schema_search.source,"i"),n.re.pretest=RegExp("("+n.re.schema_test.source+")|("+n.re.host_fuzzy_test.source+")|@","i"),Qm(n)}function eb(n,t){const e=n.__index__,i=n.__last_index__,s=n.__text_cache__.slice(e,i);this.schema=n.__schema__.toLowerCase(),this.index=e+t,this.lastIndex=i+t,this.raw=s,this.text=s,this.url=s}function da(n,t){const e=new eb(n,t);return n.__compiled__[e.schema].normalize(e,n),e}function He(n,t){if(!(this instanceof He))return new He(n,t);t||Ym(n)&&(t=n,n={}),this.__opts__=ha({},qh,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=ha({},Km,n),this.__compiled__={},this.__tlds__=Jm,this.__tlds_replaced__=!1,this.re={},Mr(this)}He.prototype.add=function(t,e){return this.__schemas__[t]=e,Mr(this),this};He.prototype.set=function(t){return this.__opts__=ha(this.__opts__,t),this};He.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let e,i,s,r,o,a,u,l,c;if(this.re.schema_test.test(t)){for(u=this.re.schema_search,u.lastIndex=0;(e=u.exec(t))!==null;)if(r=this.testSchemaAt(t,e[2],u.lastIndex),r){this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+r;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=t.search(this.re.host_fuzzy_test),l>=0&&(this.__index__<0||l<this.__index__)&&(i=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(o=i.index+i[1].length,(this.__index__<0||o<this.__index__)&&(this.__schema__="",this.__index__=o,this.__last_index__=i.index+i[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=t.indexOf("@"),c>=0&&(s=t.match(this.re.email_fuzzy))!==null&&(o=s.index+s[1].length,a=s.index+s[0].length,(this.__index__<0||o<this.__index__||o===this.__index__&&a>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=o,this.__last_index__=a))),this.__index__>=0};He.prototype.pretest=function(t){return this.re.pretest.test(t)};He.prototype.testSchemaAt=function(t,e,i){return this.__compiled__[e.toLowerCase()]?this.__compiled__[e.toLowerCase()].validate(t,i,this):0};He.prototype.match=function(t){const e=[];let i=0;this.__index__>=0&&this.__text_cache__===t&&(e.push(da(this,i)),i=this.__last_index__);let s=i?t.slice(i):t;for(;this.test(s);)e.push(da(this,i)),s=s.slice(this.__last_index__),i+=this.__last_index__;return e.length?e:null};He.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const e=this.re.schema_at_start.exec(t);if(!e)return null;const i=this.testSchemaAt(t,e[2],e[0].length);return i?(this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+i,da(this,0)):null};He.prototype.tlds=function(t,e){return t=Array.isArray(t)?t:[t],e?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(i,s,r){return i!==r[s-1]}).reverse(),Mr(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,Mr(this),this)};He.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),t.schema==="mailto:"&&!/^mailto:/i.test(t.url)&&(t.url="mailto:"+t.url)};He.prototype.onCompile=function(){};const Ri=2147483647,fn=36,su=1,Ds=26,nb=38,ib=700,Xh=72,Yh=128,Kh="-",sb=/^xn--/,rb=/[^\0-\x7F]/,ob=/[\x2E\u3002\uFF0E\uFF61]/g,ab={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Mo=fn-su,pn=Math.floor,Po=String.fromCharCode;function zn(n){throw new RangeError(ab[n])}function ub(n,t){const e=[];let i=n.length;for(;i--;)e[i]=t(n[i]);return e}function Zh(n,t){const e=n.split("@");let i="";e.length>1&&(i=e[0]+"@",n=e[1]),n=n.replace(ob,".");const s=n.split("."),r=ub(s,t).join(".");return i+r}function Jh(n){const t=[];let e=0;const i=n.length;for(;e<i;){const s=n.charCodeAt(e++);if(s>=55296&&s<=56319&&e<i){const r=n.charCodeAt(e++);(r&64512)==56320?t.push(((s&1023)<<10)+(r&1023)+65536):(t.push(s),e--)}else t.push(s)}return t}const lb=n=>String.fromCodePoint(...n),cb=function(n){return n>=48&&n<58?26+(n-48):n>=65&&n<91?n-65:n>=97&&n<123?n-97:fn},Fl=function(n,t){return n+22+75*(n<26)-((t!=0)<<5)},Qh=function(n,t,e){let i=0;for(n=e?pn(n/ib):n>>1,n+=pn(n/t);n>Mo*Ds>>1;i+=fn)n=pn(n/Mo);return pn(i+(Mo+1)*n/(n+nb))},td=function(n){const t=[],e=n.length;let i=0,s=Yh,r=Xh,o=n.lastIndexOf(Kh);o<0&&(o=0);for(let a=0;a<o;++a)n.charCodeAt(a)>=128&&zn("not-basic"),t.push(n.charCodeAt(a));for(let a=o>0?o+1:0;a<e;){const u=i;for(let c=1,h=fn;;h+=fn){a>=e&&zn("invalid-input");const d=cb(n.charCodeAt(a++));d>=fn&&zn("invalid-input"),d>pn((Ri-i)/c)&&zn("overflow"),i+=d*c;const f=h<=r?su:h>=r+Ds?Ds:h-r;if(d<f)break;const p=fn-f;c>pn(Ri/p)&&zn("overflow"),c*=p}const l=t.length+1;r=Qh(i-u,l,u==0),pn(i/l)>Ri-s&&zn("overflow"),s+=pn(i/l),i%=l,t.splice(i++,0,s)}return String.fromCodePoint(...t)},ed=function(n){const t=[];n=Jh(n);const e=n.length;let i=Yh,s=0,r=Xh;for(const u of n)u<128&&t.push(Po(u));const o=t.length;let a=o;for(o&&t.push(Kh);a<e;){let u=Ri;for(const c of n)c>=i&&c<u&&(u=c);const l=a+1;u-i>pn((Ri-s)/l)&&zn("overflow"),s+=(u-i)*l,i=u;for(const c of n)if(c<i&&++s>Ri&&zn("overflow"),c===i){let h=s;for(let d=fn;;d+=fn){const f=d<=r?su:d>=r+Ds?Ds:d-r;if(h<f)break;const p=h-f,g=fn-f;t.push(Po(Fl(f+p%g,0))),h=pn(p/g)}t.push(Po(Fl(h,0))),r=Qh(s,l,a===o),s=0,++a}++s,++i}return t.join("")},hb=function(n){return Zh(n,function(t){return sb.test(t)?td(t.slice(4).toLowerCase()):t})},db=function(n){return Zh(n,function(t){return rb.test(t)?"xn--"+ed(t):t})},nd={version:"2.3.1",ucs2:{decode:Jh,encode:lb},decode:td,encode:ed,toASCII:db,toUnicode:hb},fb={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},pb={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},gb={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},mb={default:fb,zero:pb,commonmark:gb},bb=/^(vbscript|javascript|file|data):/,yb=/^data:image\/(gif|png|jpeg|webp);/;function Ab(n){const t=n.trim().toLowerCase();return bb.test(t)?yb.test(t):!0}const id=["http:","https:","mailto:"];function _b(n){const t=Ja(n,!0);if(t.hostname&&(!t.protocol||id.indexOf(t.protocol)>=0))try{t.hostname=nd.toASCII(t.hostname)}catch{}return Ns(Za(t))}function xb(n){const t=Ja(n,!0);if(t.hostname&&(!t.protocol||id.indexOf(t.protocol)>=0))try{t.hostname=nd.toUnicode(t.hostname)}catch{}return zi(Za(t),zi.defaultChars+"%")}function We(n,t){if(!(this instanceof We))return new We(n,t);t||tu(n)||(t=n||{},n="default"),this.inline=new Us,this.block=new Xr,this.core=new nu,this.renderer=new Vi,this.linkify=new He,this.validateLink=Ab,this.normalizeLink=_b,this.normalizeLinkText=xb,this.utils=vg,this.helpers=Wr({},Tg),this.options={},this.configure(n),t&&this.set(t)}We.prototype.set=function(n){return Wr(this.options,n),this};We.prototype.configure=function(n){const t=this;if(tu(n)){const e=n;if(n=mb[e],!n)throw new Error('Wrong `markdown-it` preset "'+e+'", check name')}if(!n)throw new Error("Wrong `markdown-it` preset, can't be empty");return n.options&&t.set(n.options),n.components&&Object.keys(n.components).forEach(function(e){n.components[e].rules&&t[e].ruler.enableOnly(n.components[e].rules),n.components[e].rules2&&t[e].ruler2.enableOnly(n.components[e].rules2)}),this};We.prototype.enable=function(n,t){let e=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(s){e=e.concat(this[s].ruler.enable(n,!0))},this),e=e.concat(this.inline.ruler2.enable(n,!0));const i=n.filter(function(s){return e.indexOf(s)<0});if(i.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+i);return this};We.prototype.disable=function(n,t){let e=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(s){e=e.concat(this[s].ruler.disable(n,!0))},this),e=e.concat(this.inline.ruler2.disable(n,!0));const i=n.filter(function(s){return e.indexOf(s)<0});if(i.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+i);return this};We.prototype.use=function(n){const t=[this].concat(Array.prototype.slice.call(arguments,1));return n.apply(n,t),this};We.prototype.parse=function(n,t){if(typeof n!="string")throw new Error("Input data should be a String");const e=new this.core.State(n,this,t);return this.core.process(e),e.tokens};We.prototype.render=function(n,t){return t=t||{},this.renderer.render(this.parse(n,t),this.options,t)};We.prototype.parseInline=function(n,t){const e=new this.core.State(n,this,t);return e.inlineMode=!0,this.core.process(e),e.tokens};We.prototype.renderInline=function(n,t){return t=t||{},this.renderer.render(this.parseInline(n,t),this.options,t)};const{entries:sd,setPrototypeOf:Rl,isFrozen:wb,getPrototypeOf:vb,getOwnPropertyDescriptor:Eb}=Object;let{freeze:Ce,seal:qe,create:rd}=Object,{apply:fa,construct:pa}=typeof Reflect<"u"&&Reflect;Ce||(Ce=function(t){return t});qe||(qe=function(t){return t});fa||(fa=function(t,e,i){return t.apply(e,i)});pa||(pa=function(t,e){return new t(...e)});const tr=Se(Array.prototype.forEach),Cb=Se(Array.prototype.lastIndexOf),Il=Se(Array.prototype.pop),Zi=Se(Array.prototype.push),Sb=Se(Array.prototype.splice),br=Se(String.prototype.toLowerCase),Fo=Se(String.prototype.toString),Ll=Se(String.prototype.match),Ji=Se(String.prototype.replace),Tb=Se(String.prototype.indexOf),kb=Se(String.prototype.trim),Ye=Se(Object.prototype.hasOwnProperty),ye=Se(RegExp.prototype.test),Qi=Db(TypeError);function Se(n){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];return fa(n,t,i)}}function Db(n){return function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return pa(n,e)}}function bt(n,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:br;Rl&&Rl(n,null);let i=t.length;for(;i--;){let s=t[i];if(typeof s=="string"){const r=e(s);r!==s&&(wb(t)||(t[i]=r),s=r)}n[s]=!0}return n}function Mb(n){for(let t=0;t<n.length;t++)Ye(n,t)||(n[t]=null);return n}function En(n){const t=rd(null);for(const[e,i]of sd(n))Ye(n,e)&&(Array.isArray(i)?t[e]=Mb(i):i&&typeof i=="object"&&i.constructor===Object?t[e]=En(i):t[e]=i);return t}function ts(n,t){for(;n!==null;){const i=Eb(n,t);if(i){if(i.get)return Se(i.get);if(typeof i.value=="function")return Se(i.value)}n=vb(n)}function e(){return null}return e}const Ol=Ce(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ro=Ce(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Io=Ce(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Pb=Ce(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Lo=Ce(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Fb=Ce(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Nl=Ce(["#text"]),Bl=Ce(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Oo=Ce(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ul=Ce(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),er=Ce(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Rb=qe(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ib=qe(/<%[\w\W]*|[\w\W]*%>/gm),Lb=qe(/\$\{[\w\W]*/gm),Ob=qe(/^data-[\-\w.\u00B7-\uFFFF]+$/),Nb=qe(/^aria-[\-\w]+$/),od=qe(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Bb=qe(/^(?:\w+script|data):/i),Ub=qe(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ad=qe(/^html$/i),Hb=qe(/^[a-z][.\w]*(-[.\w]+)+$/i);var Hl=Object.freeze({__proto__:null,ARIA_ATTR:Nb,ATTR_WHITESPACE:Ub,CUSTOM_ELEMENT:Hb,DATA_ATTR:Ob,DOCTYPE_NAME:ad,ERB_EXPR:Ib,IS_ALLOWED_URI:od,IS_SCRIPT_OR_DATA:Bb,MUSTACHE_EXPR:Rb,TMPLIT_EXPR:Lb});const es={element:1,text:3,progressingInstruction:7,comment:8,document:9},zb=function(){return typeof window>"u"?null:window},$b=function(t,e){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let i=null;const s="data-tt-policy-suffix";e&&e.hasAttribute(s)&&(i=e.getAttribute(s));const r="dompurify"+(i?"#"+i:"");try{return t.createPolicy(r,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}},zl=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function ud(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zb();const t=Q=>ud(Q);if(t.version="3.2.6",t.removed=[],!n||!n.document||n.document.nodeType!==es.document||!n.Element)return t.isSupported=!1,t;let{document:e}=n;const i=e,s=i.currentScript,{DocumentFragment:r,HTMLTemplateElement:o,Node:a,Element:u,NodeFilter:l,NamedNodeMap:c=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=n,p=u.prototype,g=ts(p,"cloneNode"),b=ts(p,"remove"),m=ts(p,"nextSibling"),A=ts(p,"childNodes"),y=ts(p,"parentNode");if(typeof o=="function"){const Q=e.createElement("template");Q.content&&Q.content.ownerDocument&&(e=Q.content.ownerDocument)}let _,x="";const{implementation:v,createNodeIterator:S,createDocumentFragment:M,getElementsByTagName:R}=e,{importNode:j}=i;let I=zl();t.isSupported=typeof sd=="function"&&typeof y=="function"&&v&&v.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Y,ERB_EXPR:dt,TMPLIT_EXPR:et,DATA_ATTR:mt,ARIA_ATTR:U,IS_SCRIPT_OR_DATA:O,ATTR_WHITESPACE:q,CUSTOM_ELEMENT:At}=Hl;let{IS_ALLOWED_URI:Ot}=Hl,T=null;const D=bt({},[...Ol,...Ro,...Io,...Lo,...Nl]);let B=null;const rt=bt({},[...Bl,...Oo,...Ul,...er]);let W=Object.seal(rd(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ot=null,nt=null,Ft=!0,$t=!0,lt=!1,re=!0,w=!1,E=!0,k=!1,L=!1,P=!1,F=!1,G=!1,$=!1,z=!0,N=!1;const it="user-content-";let V=!0,J=!1,st={},pt=null;const Dt=bt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let _t=null;const oe=bt({},["audio","video","img","source","image","track"]);let Qt=null;const Ie=bt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),be="http://www.w3.org/1998/Math/MathML",en="http://www.w3.org/2000/svg",ze="http://www.w3.org/1999/xhtml";let Wt=ze,Te=!1,fi=null;const Vs=bt({},[be,en,ze],Fo);let Ws=bt({},["mi","mo","mn","ms","mtext"]),qs=bt({},["annotation-xml"]);const of=bt({},["title","style","font","a","script"]);let qi=null;const af=["application/xhtml+xml","text/html"],uf="text/html";let te=null,pi=null;const lf=e.createElement("form"),Cu=function(C){return C instanceof RegExp||C instanceof Function},uo=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(pi&&pi===C)){if((!C||typeof C!="object")&&(C={}),C=En(C),qi=af.indexOf(C.PARSER_MEDIA_TYPE)===-1?uf:C.PARSER_MEDIA_TYPE,te=qi==="application/xhtml+xml"?Fo:br,T=Ye(C,"ALLOWED_TAGS")?bt({},C.ALLOWED_TAGS,te):D,B=Ye(C,"ALLOWED_ATTR")?bt({},C.ALLOWED_ATTR,te):rt,fi=Ye(C,"ALLOWED_NAMESPACES")?bt({},C.ALLOWED_NAMESPACES,Fo):Vs,Qt=Ye(C,"ADD_URI_SAFE_ATTR")?bt(En(Ie),C.ADD_URI_SAFE_ATTR,te):Ie,_t=Ye(C,"ADD_DATA_URI_TAGS")?bt(En(oe),C.ADD_DATA_URI_TAGS,te):oe,pt=Ye(C,"FORBID_CONTENTS")?bt({},C.FORBID_CONTENTS,te):Dt,ot=Ye(C,"FORBID_TAGS")?bt({},C.FORBID_TAGS,te):En({}),nt=Ye(C,"FORBID_ATTR")?bt({},C.FORBID_ATTR,te):En({}),st=Ye(C,"USE_PROFILES")?C.USE_PROFILES:!1,Ft=C.ALLOW_ARIA_ATTR!==!1,$t=C.ALLOW_DATA_ATTR!==!1,lt=C.ALLOW_UNKNOWN_PROTOCOLS||!1,re=C.ALLOW_SELF_CLOSE_IN_ATTR!==!1,w=C.SAFE_FOR_TEMPLATES||!1,E=C.SAFE_FOR_XML!==!1,k=C.WHOLE_DOCUMENT||!1,F=C.RETURN_DOM||!1,G=C.RETURN_DOM_FRAGMENT||!1,$=C.RETURN_TRUSTED_TYPE||!1,P=C.FORCE_BODY||!1,z=C.SANITIZE_DOM!==!1,N=C.SANITIZE_NAMED_PROPS||!1,V=C.KEEP_CONTENT!==!1,J=C.IN_PLACE||!1,Ot=C.ALLOWED_URI_REGEXP||od,Wt=C.NAMESPACE||ze,Ws=C.MATHML_TEXT_INTEGRATION_POINTS||Ws,qs=C.HTML_INTEGRATION_POINTS||qs,W=C.CUSTOM_ELEMENT_HANDLING||{},C.CUSTOM_ELEMENT_HANDLING&&Cu(C.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=C.CUSTOM_ELEMENT_HANDLING.tagNameCheck),C.CUSTOM_ELEMENT_HANDLING&&Cu(C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),C.CUSTOM_ELEMENT_HANDLING&&typeof C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(W.allowCustomizedBuiltInElements=C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),w&&($t=!1),G&&(F=!0),st&&(T=bt({},Nl),B=[],st.html===!0&&(bt(T,Ol),bt(B,Bl)),st.svg===!0&&(bt(T,Ro),bt(B,Oo),bt(B,er)),st.svgFilters===!0&&(bt(T,Io),bt(B,Oo),bt(B,er)),st.mathMl===!0&&(bt(T,Lo),bt(B,Ul),bt(B,er))),C.ADD_TAGS&&(T===D&&(T=En(T)),bt(T,C.ADD_TAGS,te)),C.ADD_ATTR&&(B===rt&&(B=En(B)),bt(B,C.ADD_ATTR,te)),C.ADD_URI_SAFE_ATTR&&bt(Qt,C.ADD_URI_SAFE_ATTR,te),C.FORBID_CONTENTS&&(pt===Dt&&(pt=En(pt)),bt(pt,C.FORBID_CONTENTS,te)),V&&(T["#text"]=!0),k&&bt(T,["html","head","body"]),T.table&&(bt(T,["tbody"]),delete ot.tbody),C.TRUSTED_TYPES_POLICY){if(typeof C.TRUSTED_TYPES_POLICY.createHTML!="function")throw Qi('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof C.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Qi('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=C.TRUSTED_TYPES_POLICY,x=_.createHTML("")}else _===void 0&&(_=$b(f,s)),_!==null&&typeof x=="string"&&(x=_.createHTML(""));Ce&&Ce(C),pi=C}},Su=bt({},[...Ro,...Io,...Pb]),Tu=bt({},[...Lo,...Fb]),cf=function(C){let H=y(C);(!H||!H.tagName)&&(H={namespaceURI:Wt,tagName:"template"});const Z=br(C.tagName),Nt=br(H.tagName);return fi[C.namespaceURI]?C.namespaceURI===en?H.namespaceURI===ze?Z==="svg":H.namespaceURI===be?Z==="svg"&&(Nt==="annotation-xml"||Ws[Nt]):!!Su[Z]:C.namespaceURI===be?H.namespaceURI===ze?Z==="math":H.namespaceURI===en?Z==="math"&&qs[Nt]:!!Tu[Z]:C.namespaceURI===ze?H.namespaceURI===en&&!qs[Nt]||H.namespaceURI===be&&!Ws[Nt]?!1:!Tu[Z]&&(of[Z]||!Su[Z]):!!(qi==="application/xhtml+xml"&&fi[C.namespaceURI]):!1},nn=function(C){Zi(t.removed,{element:C});try{y(C).removeChild(C)}catch{b(C)}},gi=function(C,H){try{Zi(t.removed,{attribute:H.getAttributeNode(C),from:H})}catch{Zi(t.removed,{attribute:null,from:H})}if(H.removeAttribute(C),C==="is")if(F||G)try{nn(H)}catch{}else try{H.setAttribute(C,"")}catch{}},ku=function(C){let H=null,Z=null;if(P)C="<remove></remove>"+C;else{const Yt=Ll(C,/^[\r\n\t ]+/);Z=Yt&&Yt[0]}qi==="application/xhtml+xml"&&Wt===ze&&(C='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+C+"</body></html>");const Nt=_?_.createHTML(C):C;if(Wt===ze)try{H=new d().parseFromString(Nt,qi)}catch{}if(!H||!H.documentElement){H=v.createDocument(Wt,"template",null);try{H.documentElement.innerHTML=Te?x:Nt}catch{}}const ce=H.body||H.documentElement;return C&&Z&&ce.insertBefore(e.createTextNode(Z),ce.childNodes[0]||null),Wt===ze?R.call(H,k?"html":"body")[0]:k?H.documentElement:ce},Du=function(C){return S.call(C.ownerDocument||C,C,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null)},lo=function(C){return C instanceof h&&(typeof C.nodeName!="string"||typeof C.textContent!="string"||typeof C.removeChild!="function"||!(C.attributes instanceof c)||typeof C.removeAttribute!="function"||typeof C.setAttribute!="function"||typeof C.namespaceURI!="string"||typeof C.insertBefore!="function"||typeof C.hasChildNodes!="function")},Mu=function(C){return typeof a=="function"&&C instanceof a};function _n(Q,C,H){tr(Q,Z=>{Z.call(t,C,H,pi)})}const Pu=function(C){let H=null;if(_n(I.beforeSanitizeElements,C,null),lo(C))return nn(C),!0;const Z=te(C.nodeName);if(_n(I.uponSanitizeElement,C,{tagName:Z,allowedTags:T}),E&&C.hasChildNodes()&&!Mu(C.firstElementChild)&&ye(/<[/\w!]/g,C.innerHTML)&&ye(/<[/\w!]/g,C.textContent)||C.nodeType===es.progressingInstruction||E&&C.nodeType===es.comment&&ye(/<[/\w]/g,C.data))return nn(C),!0;if(!T[Z]||ot[Z]){if(!ot[Z]&&Ru(Z)&&(W.tagNameCheck instanceof RegExp&&ye(W.tagNameCheck,Z)||W.tagNameCheck instanceof Function&&W.tagNameCheck(Z)))return!1;if(V&&!pt[Z]){const Nt=y(C)||C.parentNode,ce=A(C)||C.childNodes;if(ce&&Nt){const Yt=ce.length;for(let ke=Yt-1;ke>=0;--ke){const xn=g(ce[ke],!0);xn.__removalCount=(C.__removalCount||0)+1,Nt.insertBefore(xn,m(C))}}}return nn(C),!0}return C instanceof u&&!cf(C)||(Z==="noscript"||Z==="noembed"||Z==="noframes")&&ye(/<\/no(script|embed|frames)/i,C.innerHTML)?(nn(C),!0):(w&&C.nodeType===es.text&&(H=C.textContent,tr([Y,dt,et],Nt=>{H=Ji(H,Nt," ")}),C.textContent!==H&&(Zi(t.removed,{element:C.cloneNode()}),C.textContent=H)),_n(I.afterSanitizeElements,C,null),!1)},Fu=function(C,H,Z){if(z&&(H==="id"||H==="name")&&(Z in e||Z in lf))return!1;if(!($t&&!nt[H]&&ye(mt,H))){if(!(Ft&&ye(U,H))){if(!B[H]||nt[H]){if(!(Ru(C)&&(W.tagNameCheck instanceof RegExp&&ye(W.tagNameCheck,C)||W.tagNameCheck instanceof Function&&W.tagNameCheck(C))&&(W.attributeNameCheck instanceof RegExp&&ye(W.attributeNameCheck,H)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(H))||H==="is"&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&ye(W.tagNameCheck,Z)||W.tagNameCheck instanceof Function&&W.tagNameCheck(Z))))return!1}else if(!Qt[H]){if(!ye(Ot,Ji(Z,q,""))){if(!((H==="src"||H==="xlink:href"||H==="href")&&C!=="script"&&Tb(Z,"data:")===0&&_t[C])){if(!(lt&&!ye(O,Ji(Z,q,"")))){if(Z)return!1}}}}}}return!0},Ru=function(C){return C!=="annotation-xml"&&Ll(C,At)},Iu=function(C){_n(I.beforeSanitizeAttributes,C,null);const{attributes:H}=C;if(!H||lo(C))return;const Z={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:B,forceKeepAttr:void 0};let Nt=H.length;for(;Nt--;){const ce=H[Nt],{name:Yt,namespaceURI:ke,value:xn}=ce,Xi=te(Yt),co=xn;let he=Yt==="value"?co:kb(co);if(Z.attrName=Xi,Z.attrValue=he,Z.keepAttr=!0,Z.forceKeepAttr=void 0,_n(I.uponSanitizeAttribute,C,Z),he=Z.attrValue,N&&(Xi==="id"||Xi==="name")&&(gi(Yt,C),he=it+he),E&&ye(/((--!?|])>)|<\/(style|title)/i,he)){gi(Yt,C);continue}if(Z.forceKeepAttr)continue;if(!Z.keepAttr){gi(Yt,C);continue}if(!re&&ye(/\/>/i,he)){gi(Yt,C);continue}w&&tr([Y,dt,et],Ou=>{he=Ji(he,Ou," ")});const Lu=te(C.nodeName);if(!Fu(Lu,Xi,he)){gi(Yt,C);continue}if(_&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!ke)switch(f.getAttributeType(Lu,Xi)){case"TrustedHTML":{he=_.createHTML(he);break}case"TrustedScriptURL":{he=_.createScriptURL(he);break}}if(he!==co)try{ke?C.setAttributeNS(ke,Yt,he):C.setAttribute(Yt,he),lo(C)?nn(C):Il(t.removed)}catch{gi(Yt,C)}}_n(I.afterSanitizeAttributes,C,null)},hf=function Q(C){let H=null;const Z=Du(C);for(_n(I.beforeSanitizeShadowDOM,C,null);H=Z.nextNode();)_n(I.uponSanitizeShadowNode,H,null),Pu(H),Iu(H),H.content instanceof r&&Q(H.content);_n(I.afterSanitizeShadowDOM,C,null)};return t.sanitize=function(Q){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},H=null,Z=null,Nt=null,ce=null;if(Te=!Q,Te&&(Q="<!-->"),typeof Q!="string"&&!Mu(Q))if(typeof Q.toString=="function"){if(Q=Q.toString(),typeof Q!="string")throw Qi("dirty is not a string, aborting")}else throw Qi("toString is not a function");if(!t.isSupported)return Q;if(L||uo(C),t.removed=[],typeof Q=="string"&&(J=!1),J){if(Q.nodeName){const xn=te(Q.nodeName);if(!T[xn]||ot[xn])throw Qi("root node is forbidden and cannot be sanitized in-place")}}else if(Q instanceof a)H=ku("<!---->"),Z=H.ownerDocument.importNode(Q,!0),Z.nodeType===es.element&&Z.nodeName==="BODY"||Z.nodeName==="HTML"?H=Z:H.appendChild(Z);else{if(!F&&!w&&!k&&Q.indexOf("<")===-1)return _&&$?_.createHTML(Q):Q;if(H=ku(Q),!H)return F?null:$?x:""}H&&P&&nn(H.firstChild);const Yt=Du(J?Q:H);for(;Nt=Yt.nextNode();)Pu(Nt),Iu(Nt),Nt.content instanceof r&&hf(Nt.content);if(J)return Q;if(F){if(G)for(ce=M.call(H.ownerDocument);H.firstChild;)ce.appendChild(H.firstChild);else ce=H;return(B.shadowroot||B.shadowrootmode)&&(ce=j.call(i,ce,!0)),ce}let ke=k?H.outerHTML:H.innerHTML;return k&&T["!doctype"]&&H.ownerDocument&&H.ownerDocument.doctype&&H.ownerDocument.doctype.name&&ye(ad,H.ownerDocument.doctype.name)&&(ke="<!DOCTYPE "+H.ownerDocument.doctype.name+`>
`+ke),w&&tr([Y,dt,et],xn=>{ke=Ji(ke,xn," ")}),_&&$?_.createHTML(ke):ke},t.setConfig=function(){let Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};uo(Q),L=!0},t.clearConfig=function(){pi=null,L=!1},t.isValidAttribute=function(Q,C,H){pi||uo({});const Z=te(Q),Nt=te(C);return Fu(Z,Nt,H)},t.addHook=function(Q,C){typeof C=="function"&&Zi(I[Q],C)},t.removeHook=function(Q,C){if(C!==void 0){const H=Cb(I[Q],C);return H===-1?void 0:Sb(I[Q],H,1)[0]}return Il(I[Q])},t.removeHooks=function(Q){I[Q]=[]},t.removeAllHooks=function(){I=zl()},t}var No=ud();function ld(n){var t,e,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(t=0;t<s;t++)n[t]&&(e=ld(n[t]))&&(i&&(i+=" "),i+=e)}else for(e in n)n[e]&&(i&&(i+=" "),i+=e);return i}function cd(){for(var n,t,e=0,i="",s=arguments.length;e<s;e++)(n=arguments[e])&&(t=ld(n))&&(i&&(i+=" "),i+=t);return i}const $l=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,jl=cd,jb=(n,t)=>e=>{var i;if(t?.variants==null)return jl(n,e?.class,e?.className);const{variants:s,defaultVariants:r}=t,o=Object.keys(s).map(l=>{const c=e?.[l],h=r?.[l];if(c===null)return null;const d=$l(c)||$l(h);return s[l][d]}),a=e&&Object.entries(e).reduce((l,c)=>{let[h,d]=c;return d===void 0||(l[h]=d),l},{}),u=t==null||(i=t.compoundVariants)===null||i===void 0?void 0:i.reduce((l,c)=>{let{class:h,className:d,...f}=c;return Object.entries(f).every(p=>{let[g,b]=p;return Array.isArray(b)?b.includes({...r,...a}[g]):{...r,...a}[g]===b})?[...l,h,d]:l},[]);return jl(n,o,u,e?.class,e?.className)},ru="-",Gb=n=>{const t=Wb(n),{conflictingClassGroups:e,conflictingClassGroupModifiers:i}=n;return{getClassGroupId:o=>{const a=o.split(ru);return a[0]===""&&a.length!==1&&a.shift(),hd(a,t)||Vb(o)},getConflictingClassGroupIds:(o,a)=>{const u=e[o]||[];return a&&i[o]?[...u,...i[o]]:u}}},hd=(n,t)=>{if(n.length===0)return t.classGroupId;const e=n[0],i=t.nextPart.get(e),s=i?hd(n.slice(1),i):void 0;if(s)return s;if(t.validators.length===0)return;const r=n.join(ru);return t.validators.find(({validator:o})=>o(r))?.classGroupId},Gl=/^\[(.+)\]$/,Vb=n=>{if(Gl.test(n)){const t=Gl.exec(n)[1],e=t?.substring(0,t.indexOf(":"));if(e)return"arbitrary.."+e}},Wb=n=>{const{theme:t,prefix:e}=n,i={nextPart:new Map,validators:[]};return Xb(Object.entries(n.classGroups),e).forEach(([r,o])=>{ga(o,i,r,t)}),i},ga=(n,t,e,i)=>{n.forEach(s=>{if(typeof s=="string"){const r=s===""?t:Vl(t,s);r.classGroupId=e;return}if(typeof s=="function"){if(qb(s)){ga(s(i),t,e,i);return}t.validators.push({validator:s,classGroupId:e});return}Object.entries(s).forEach(([r,o])=>{ga(o,Vl(t,r),e,i)})})},Vl=(n,t)=>{let e=n;return t.split(ru).forEach(i=>{e.nextPart.has(i)||e.nextPart.set(i,{nextPart:new Map,validators:[]}),e=e.nextPart.get(i)}),e},qb=n=>n.isThemeGetter,Xb=(n,t)=>t?n.map(([e,i])=>{const s=i.map(r=>typeof r=="string"?t+r:typeof r=="object"?Object.fromEntries(Object.entries(r).map(([o,a])=>[t+o,a])):r);return[e,s]}):n,Yb=n=>{if(n<1)return{get:()=>{},set:()=>{}};let t=0,e=new Map,i=new Map;const s=(r,o)=>{e.set(r,o),t++,t>n&&(t=0,i=e,e=new Map)};return{get(r){let o=e.get(r);if(o!==void 0)return o;if((o=i.get(r))!==void 0)return s(r,o),o},set(r,o){e.has(r)?e.set(r,o):s(r,o)}}},dd="!",Kb=n=>{const{separator:t,experimentalParseClassName:e}=n,i=t.length===1,s=t[0],r=t.length,o=a=>{const u=[];let l=0,c=0,h;for(let b=0;b<a.length;b++){let m=a[b];if(l===0){if(m===s&&(i||a.slice(b,b+r)===t)){u.push(a.slice(c,b)),c=b+r;continue}if(m==="/"){h=b;continue}}m==="["?l++:m==="]"&&l--}const d=u.length===0?a:a.substring(c),f=d.startsWith(dd),p=f?d.substring(1):d,g=h&&h>c?h-c:void 0;return{modifiers:u,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:g}};return e?a=>e({className:a,parseClassName:o}):o},Zb=n=>{if(n.length<=1)return n;const t=[];let e=[];return n.forEach(i=>{i[0]==="["?(t.push(...e.sort(),i),e=[]):e.push(i)}),t.push(...e.sort()),t},Jb=n=>({cache:Yb(n.cacheSize),parseClassName:Kb(n),...Gb(n)}),Qb=/\s+/,t1=(n,t)=>{const{parseClassName:e,getClassGroupId:i,getConflictingClassGroupIds:s}=t,r=[],o=n.trim().split(Qb);let a="";for(let u=o.length-1;u>=0;u-=1){const l=o[u],{modifiers:c,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:f}=e(l);let p=!!f,g=i(p?d.substring(0,f):d);if(!g){if(!p){a=l+(a.length>0?" "+a:a);continue}if(g=i(d),!g){a=l+(a.length>0?" "+a:a);continue}p=!1}const b=Zb(c).join(":"),m=h?b+dd:b,A=m+g;if(r.includes(A))continue;r.push(A);const y=s(g,p);for(let _=0;_<y.length;++_){const x=y[_];r.push(m+x)}a=l+(a.length>0?" "+a:a)}return a};function e1(){let n=0,t,e,i="";for(;n<arguments.length;)(t=arguments[n++])&&(e=fd(t))&&(i&&(i+=" "),i+=e);return i}const fd=n=>{if(typeof n=="string")return n;let t,e="";for(let i=0;i<n.length;i++)n[i]&&(t=fd(n[i]))&&(e&&(e+=" "),e+=t);return e};function n1(n,...t){let e,i,s,r=o;function o(u){const l=t.reduce((c,h)=>h(c),n());return e=Jb(l),i=e.cache.get,s=e.cache.set,r=a,a(u)}function a(u){const l=i(u);if(l)return l;const c=t1(u,e);return s(u,c),c}return function(){return r(e1.apply(null,arguments))}}const Lt=n=>{const t=e=>e[n]||[];return t.isThemeGetter=!0,t},pd=/^\[(?:([a-z-]+):)?(.+)\]$/i,i1=/^\d+\/\d+$/,s1=new Set(["px","full","screen"]),r1=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,o1=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,a1=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,u1=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,l1=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,vn=n=>Ii(n)||s1.has(n)||i1.test(n),Nn=n=>Wi(n,"length",b1),Ii=n=>!!n&&!Number.isNaN(Number(n)),Bo=n=>Wi(n,"number",Ii),ns=n=>!!n&&Number.isInteger(Number(n)),c1=n=>n.endsWith("%")&&Ii(n.slice(0,-1)),gt=n=>pd.test(n),Bn=n=>r1.test(n),h1=new Set(["length","size","percentage"]),d1=n=>Wi(n,h1,gd),f1=n=>Wi(n,"position",gd),p1=new Set(["image","url"]),g1=n=>Wi(n,p1,A1),m1=n=>Wi(n,"",y1),is=()=>!0,Wi=(n,t,e)=>{const i=pd.exec(n);return i?i[1]?typeof t=="string"?i[1]===t:t.has(i[1]):e(i[2]):!1},b1=n=>o1.test(n)&&!a1.test(n),gd=()=>!1,y1=n=>u1.test(n),A1=n=>l1.test(n),_1=()=>{const n=Lt("colors"),t=Lt("spacing"),e=Lt("blur"),i=Lt("brightness"),s=Lt("borderColor"),r=Lt("borderRadius"),o=Lt("borderSpacing"),a=Lt("borderWidth"),u=Lt("contrast"),l=Lt("grayscale"),c=Lt("hueRotate"),h=Lt("invert"),d=Lt("gap"),f=Lt("gradientColorStops"),p=Lt("gradientColorStopPositions"),g=Lt("inset"),b=Lt("margin"),m=Lt("opacity"),A=Lt("padding"),y=Lt("saturate"),_=Lt("scale"),x=Lt("sepia"),v=Lt("skew"),S=Lt("space"),M=Lt("translate"),R=()=>["auto","contain","none"],j=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto",gt,t],Y=()=>[gt,t],dt=()=>["",vn,Nn],et=()=>["auto",Ii,gt],mt=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],U=()=>["solid","dashed","dotted","double","none"],O=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],q=()=>["start","end","center","between","around","evenly","stretch"],At=()=>["","0",gt],Ot=()=>["auto","avoid","all","avoid-page","page","left","right","column"],T=()=>[Ii,gt];return{cacheSize:500,separator:":",theme:{colors:[is],spacing:[vn,Nn],blur:["none","",Bn,gt],brightness:T(),borderColor:[n],borderRadius:["none","","full",Bn,gt],borderSpacing:Y(),borderWidth:dt(),contrast:T(),grayscale:At(),hueRotate:T(),invert:At(),gap:Y(),gradientColorStops:[n],gradientColorStopPositions:[c1,Nn],inset:I(),margin:I(),opacity:T(),padding:Y(),saturate:T(),scale:T(),sepia:At(),skew:T(),space:Y(),translate:Y()},classGroups:{aspect:[{aspect:["auto","square","video",gt]}],container:["container"],columns:[{columns:[Bn]}],"break-after":[{"break-after":Ot()}],"break-before":[{"break-before":Ot()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...mt(),gt]}],overflow:[{overflow:j()}],"overflow-x":[{"overflow-x":j()}],"overflow-y":[{"overflow-y":j()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ns,gt]}],basis:[{basis:I()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",gt]}],grow:[{grow:At()}],shrink:[{shrink:At()}],order:[{order:["first","last","none",ns,gt]}],"grid-cols":[{"grid-cols":[is]}],"col-start-end":[{col:["auto",{span:["full",ns,gt]},gt]}],"col-start":[{"col-start":et()}],"col-end":[{"col-end":et()}],"grid-rows":[{"grid-rows":[is]}],"row-start-end":[{row:["auto",{span:[ns,gt]},gt]}],"row-start":[{"row-start":et()}],"row-end":[{"row-end":et()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",gt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",gt]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal",...q()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...q(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...q(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[A]}],px:[{px:[A]}],py:[{py:[A]}],ps:[{ps:[A]}],pe:[{pe:[A]}],pt:[{pt:[A]}],pr:[{pr:[A]}],pb:[{pb:[A]}],pl:[{pl:[A]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",gt,t]}],"min-w":[{"min-w":[gt,t,"min","max","fit"]}],"max-w":[{"max-w":[gt,t,"none","full","min","max","fit","prose",{screen:[Bn]},Bn]}],h:[{h:[gt,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[gt,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[gt,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[gt,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Bn,Nn]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Bo]}],"font-family":[{font:[is]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",gt]}],"line-clamp":[{"line-clamp":["none",Ii,Bo]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",vn,gt]}],"list-image":[{"list-image":["none",gt]}],"list-style-type":[{list:["none","disc","decimal",gt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[m]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[m]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",vn,Nn]}],"underline-offset":[{"underline-offset":["auto",vn,gt]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Y()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",gt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",gt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[m]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...mt(),f1]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",d1]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},g1]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[r]}],"rounded-s":[{"rounded-s":[r]}],"rounded-e":[{"rounded-e":[r]}],"rounded-t":[{"rounded-t":[r]}],"rounded-r":[{"rounded-r":[r]}],"rounded-b":[{"rounded-b":[r]}],"rounded-l":[{"rounded-l":[r]}],"rounded-ss":[{"rounded-ss":[r]}],"rounded-se":[{"rounded-se":[r]}],"rounded-ee":[{"rounded-ee":[r]}],"rounded-es":[{"rounded-es":[r]}],"rounded-tl":[{"rounded-tl":[r]}],"rounded-tr":[{"rounded-tr":[r]}],"rounded-br":[{"rounded-br":[r]}],"rounded-bl":[{"rounded-bl":[r]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[m]}],"border-style":[{border:[...U(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[m]}],"divide-style":[{divide:U()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...U()]}],"outline-offset":[{"outline-offset":[vn,gt]}],"outline-w":[{outline:[vn,Nn]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:dt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[m]}],"ring-offset-w":[{"ring-offset":[vn,Nn]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",Bn,m1]}],"shadow-color":[{shadow:[is]}],opacity:[{opacity:[m]}],"mix-blend":[{"mix-blend":[...O(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":O()}],filter:[{filter:["","none"]}],blur:[{blur:[e]}],brightness:[{brightness:[i]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Bn,gt]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[h]}],saturate:[{saturate:[y]}],sepia:[{sepia:[x]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[e]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[m]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[x]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",gt]}],duration:[{duration:T()}],ease:[{ease:["linear","in","out","in-out",gt]}],delay:[{delay:T()}],animate:[{animate:["none","spin","ping","pulse","bounce",gt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[ns,gt]}],"translate-x":[{"translate-x":[M]}],"translate-y":[{"translate-y":[M]}],"skew-x":[{"skew-x":[v]}],"skew-y":[{"skew-y":[v]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",gt]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",gt]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Y()}],"scroll-mx":[{"scroll-mx":Y()}],"scroll-my":[{"scroll-my":Y()}],"scroll-ms":[{"scroll-ms":Y()}],"scroll-me":[{"scroll-me":Y()}],"scroll-mt":[{"scroll-mt":Y()}],"scroll-mr":[{"scroll-mr":Y()}],"scroll-mb":[{"scroll-mb":Y()}],"scroll-ml":[{"scroll-ml":Y()}],"scroll-p":[{"scroll-p":Y()}],"scroll-px":[{"scroll-px":Y()}],"scroll-py":[{"scroll-py":Y()}],"scroll-ps":[{"scroll-ps":Y()}],"scroll-pe":[{"scroll-pe":Y()}],"scroll-pt":[{"scroll-pt":Y()}],"scroll-pr":[{"scroll-pr":Y()}],"scroll-pb":[{"scroll-pb":Y()}],"scroll-pl":[{"scroll-pl":Y()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",gt]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[vn,Nn,Bo]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},x1=n1(_1);function w1(...n){return x1(cd(n))}const v1=nh({__name:"Button",props:{variant:{default:"default"},size:{default:"default"},class:{}},setup(n){const t=jb("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),e=n,i=Tr(()=>w1(t({variant:e.variant,size:e.size}),e.class));return(s,r)=>(Pn(),_i("button",{class:ri(i.value)},[b0(s.$slots,"default")],2))}});function E1(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i])}return n}function ma(n,t){return Array(t+1).join(n)}function C1(n){return n.replace(/^\n*/,"")}function S1(n){for(var t=n.length;t>0&&n[t-1]===`
`;)t--;return n.substring(0,t)}var T1=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function ou(n){return au(n,T1)}var md=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function bd(n){return au(n,md)}function k1(n){return Ad(n,md)}var yd=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function D1(n){return au(n,yd)}function M1(n){return Ad(n,yd)}function au(n,t){return t.indexOf(n.nodeName)>=0}function Ad(n,t){return n.getElementsByTagName&&t.some(function(e){return n.getElementsByTagName(e).length})}var me={};me.paragraph={filter:"p",replacement:function(n){return`

`+n+`

`}};me.lineBreak={filter:"br",replacement:function(n,t,e){return e.br+`
`}};me.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(n,t,e){var i=Number(t.nodeName.charAt(1));if(e.headingStyle==="setext"&&i<3){var s=ma(i===1?"=":"-",n.length);return`

`+n+`
`+s+`

`}else return`

`+ma("#",i)+" "+n+`

`}};me.blockquote={filter:"blockquote",replacement:function(n){return n=n.replace(/^\n+|\n+$/g,""),n=n.replace(/^/gm,"> "),`

`+n+`

`}};me.list={filter:["ul","ol"],replacement:function(n,t){var e=t.parentNode;return e.nodeName==="LI"&&e.lastElementChild===t?`
`+n:`

`+n+`

`}};me.listItem={filter:"li",replacement:function(n,t,e){var i=e.bulletListMarker+"   ",s=t.parentNode;if(s.nodeName==="OL"){var r=s.getAttribute("start"),o=Array.prototype.indexOf.call(s.children,t);i=(r?Number(r)+o:o+1)+".  "}return n=n.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
`+" ".repeat(i.length)),i+n+(t.nextSibling&&!/\n$/.test(n)?`
`:"")}};me.indentedCodeBlock={filter:function(n,t){return t.codeBlockStyle==="indented"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,t,e){return`

    `+t.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};me.fencedCodeBlock={filter:function(n,t){return t.codeBlockStyle==="fenced"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,t,e){for(var i=t.firstChild.getAttribute("class")||"",s=(i.match(/language-(\S+)/)||[null,""])[1],r=t.firstChild.textContent,o=e.fence.charAt(0),a=3,u=new RegExp("^"+o+"{3,}","gm"),l;l=u.exec(r);)l[0].length>=a&&(a=l[0].length+1);var c=ma(o,a);return`

`+c+s+`
`+r.replace(/\n$/,"")+`
`+c+`

`}};me.horizontalRule={filter:"hr",replacement:function(n,t,e){return`

`+e.hr+`

`}};me.inlineLink={filter:function(n,t){return t.linkStyle==="inlined"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,t){var e=t.getAttribute("href");e&&(e=e.replace(/([()])/g,"\\$1"));var i=Pr(t.getAttribute("title"));return i&&(i=' "'+i.replace(/"/g,'\\"')+'"'),"["+n+"]("+e+i+")"}};me.referenceLink={filter:function(n,t){return t.linkStyle==="referenced"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,t,e){var i=t.getAttribute("href"),s=Pr(t.getAttribute("title"));s&&(s=' "'+s+'"');var r,o;switch(e.linkReferenceStyle){case"collapsed":r="["+n+"][]",o="["+n+"]: "+i+s;break;case"shortcut":r="["+n+"]",o="["+n+"]: "+i+s;break;default:var a=this.references.length+1;r="["+n+"]["+a+"]",o="["+a+"]: "+i+s}return this.references.push(o),r},references:[],append:function(n){var t="";return this.references.length&&(t=`

`+this.references.join(`
`)+`

`,this.references=[]),t}};me.emphasis={filter:["em","i"],replacement:function(n,t,e){return n.trim()?e.emDelimiter+n+e.emDelimiter:""}};me.strong={filter:["strong","b"],replacement:function(n,t,e){return n.trim()?e.strongDelimiter+n+e.strongDelimiter:""}};me.code={filter:function(n){var t=n.previousSibling||n.nextSibling,e=n.parentNode.nodeName==="PRE"&&!t;return n.nodeName==="CODE"&&!e},replacement:function(n){if(!n)return"";n=n.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(n)?" ":"",e="`",i=n.match(/`+/gm)||[];i.indexOf(e)!==-1;)e=e+"`";return e+t+n+t+e}};me.image={filter:"img",replacement:function(n,t){var e=Pr(t.getAttribute("alt")),i=t.getAttribute("src")||"",s=Pr(t.getAttribute("title")),r=s?' "'+s+'"':"";return i?"!["+e+"]("+i+r+")":""}};function Pr(n){return n?n.replace(/(\n+\s*)+/g,`
`):""}function _d(n){this.options=n,this._keep=[],this._remove=[],this.blankRule={replacement:n.blankReplacement},this.keepReplacement=n.keepReplacement,this.defaultRule={replacement:n.defaultReplacement},this.array=[];for(var t in n.rules)this.array.push(n.rules[t])}_d.prototype={add:function(n,t){this.array.unshift(t)},keep:function(n){this._keep.unshift({filter:n,replacement:this.keepReplacement})},remove:function(n){this._remove.unshift({filter:n,replacement:function(){return""}})},forNode:function(n){if(n.isBlank)return this.blankRule;var t;return(t=Uo(this.array,n,this.options))||(t=Uo(this._keep,n,this.options))||(t=Uo(this._remove,n,this.options))?t:this.defaultRule},forEach:function(n){for(var t=0;t<this.array.length;t++)n(this.array[t],t)}};function Uo(n,t,e){for(var i=0;i<n.length;i++){var s=n[i];if(P1(s,t,e))return s}}function P1(n,t,e){var i=n.filter;if(typeof i=="string"){if(i===t.nodeName.toLowerCase())return!0}else if(Array.isArray(i)){if(i.indexOf(t.nodeName.toLowerCase())>-1)return!0}else if(typeof i=="function"){if(i.call(n,t,e))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function F1(n){var t=n.element,e=n.isBlock,i=n.isVoid,s=n.isPre||function(h){return h.nodeName==="PRE"};if(!(!t.firstChild||s(t))){for(var r=null,o=!1,a=null,u=Wl(a,t,s);u!==t;){if(u.nodeType===3||u.nodeType===4){var l=u.data.replace(/[ \r\n\t]+/g," ");if((!r||/ $/.test(r.data))&&!o&&l[0]===" "&&(l=l.substr(1)),!l){u=Ho(u);continue}u.data=l,r=u}else if(u.nodeType===1)e(u)||u.nodeName==="BR"?(r&&(r.data=r.data.replace(/ $/,"")),r=null,o=!1):i(u)||s(u)?(r=null,o=!0):r&&(o=!1);else{u=Ho(u);continue}var c=Wl(a,u,s);a=u,u=c}r&&(r.data=r.data.replace(/ $/,""),r.data||Ho(r))}}function Ho(n){var t=n.nextSibling||n.parentNode;return n.parentNode.removeChild(n),t}function Wl(n,t,e){return n&&n.parentNode===t||e(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}var uu=typeof window<"u"?window:{};function R1(){var n=uu.DOMParser,t=!1;try{new n().parseFromString("","text/html")&&(t=!0)}catch{}return t}function I1(){var n=function(){};return L1()?n.prototype.parseFromString=function(t){var e=new window.ActiveXObject("htmlfile");return e.designMode="on",e.open(),e.write(t),e.close(),e}:n.prototype.parseFromString=function(t){var e=document.implementation.createHTMLDocument("");return e.open(),e.write(t),e.close(),e},n}function L1(){var n=!1;try{document.implementation.createHTMLDocument("").open()}catch{uu.ActiveXObject&&(n=!0)}return n}var O1=R1()?uu.DOMParser:I1();function N1(n,t){var e;if(typeof n=="string"){var i=B1().parseFromString('<x-turndown id="turndown-root">'+n+"</x-turndown>","text/html");e=i.getElementById("turndown-root")}else e=n.cloneNode(!0);return F1({element:e,isBlock:ou,isVoid:bd,isPre:t.preformattedCode?U1:null}),e}var zo;function B1(){return zo=zo||new O1,zo}function U1(n){return n.nodeName==="PRE"||n.nodeName==="CODE"}function H1(n,t){return n.isBlock=ou(n),n.isCode=n.nodeName==="CODE"||n.parentNode.isCode,n.isBlank=z1(n),n.flankingWhitespace=$1(n,t),n}function z1(n){return!bd(n)&&!D1(n)&&/^\s*$/i.test(n.textContent)&&!k1(n)&&!M1(n)}function $1(n,t){if(n.isBlock||t.preformattedCode&&n.isCode)return{leading:"",trailing:""};var e=j1(n.textContent);return e.leadingAscii&&ql("left",n,t)&&(e.leading=e.leadingNonAscii),e.trailingAscii&&ql("right",n,t)&&(e.trailing=e.trailingNonAscii),{leading:e.leading,trailing:e.trailing}}function j1(n){var t=n.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:t[1],leadingAscii:t[2],leadingNonAscii:t[3],trailing:t[4],trailingNonAscii:t[5],trailingAscii:t[6]}}function ql(n,t,e){var i,s,r;return n==="left"?(i=t.previousSibling,s=/ $/):(i=t.nextSibling,s=/^ /),i&&(i.nodeType===3?r=s.test(i.nodeValue):e.preformattedCode&&i.nodeName==="CODE"?r=!1:i.nodeType===1&&!ou(i)&&(r=s.test(i.textContent))),r}var G1=Array.prototype.reduce,V1=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function Fr(n){if(!(this instanceof Fr))return new Fr(n);var t={rules:me,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(e,i){return i.isBlock?`

`:""},keepReplacement:function(e,i){return i.isBlock?`

`+i.outerHTML+`

`:i.outerHTML},defaultReplacement:function(e,i){return i.isBlock?`

`+e+`

`:e}};this.options=E1({},t,n),this.rules=new _d(this.options)}Fr.prototype={turndown:function(n){if(!X1(n))throw new TypeError(n+" is not a string, or an element/document/fragment node.");if(n==="")return"";var t=xd.call(this,new N1(n,this.options));return W1.call(this,t)},use:function(n){if(Array.isArray(n))for(var t=0;t<n.length;t++)this.use(n[t]);else if(typeof n=="function")n(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(n,t){return this.rules.add(n,t),this},keep:function(n){return this.rules.keep(n),this},remove:function(n){return this.rules.remove(n),this},escape:function(n){return V1.reduce(function(t,e){return t.replace(e[0],e[1])},n)}};function xd(n){var t=this;return G1.call(n.childNodes,function(e,i){i=new H1(i,t.options);var s="";return i.nodeType===3?s=i.isCode?i.nodeValue:t.escape(i.nodeValue):i.nodeType===1&&(s=q1.call(t,i)),wd(e,s)},"")}function W1(n){var t=this;return this.rules.forEach(function(e){typeof e.append=="function"&&(n=wd(n,e.append(t.options)))}),n.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function q1(n){var t=this.rules.forNode(n),e=xd.call(this,n),i=n.flankingWhitespace;return(i.leading||i.trailing)&&(e=e.trim()),i.leading+t.replacement(e,n,this.options)+i.trailing}function wd(n,t){var e=S1(n),i=C1(t),s=Math.max(n.length-e.length,t.length-i.length),r=`

`.substring(0,s);return e+r+i}function X1(n){return n!=null&&(typeof n=="string"||n.nodeType&&(n.nodeType===1||n.nodeType===9||n.nodeType===11))}const _e=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),ba=[.001,0,0,.001,0,0],$o=1.35,Oe={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},jn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Ms="pdfjs_internal_editor_",ct={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},yt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Y1={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},ya={TRIANGLES:1,LATTICE:2},Kt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},yr={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Xt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},wi={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Kr={ERRORS:0,WARNINGS:1,INFOS:5},Ps={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ss={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},K1={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Zr=Kr.WARNINGS;function Z1(n){Number.isInteger(n)&&(Zr=n)}function J1(){return Zr}function Jr(n){Zr>=Kr.INFOS&&console.info(`Info: ${n}`)}function at(n){Zr>=Kr.WARNINGS&&console.warn(`Warning: ${n}`)}function St(n){throw new Error(n)}function Ct(n,t){n||St(t)}function Q1(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function vd(n,t=null,e=null){if(!n)return null;if(e&&typeof n=="string"&&(e.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),e.tryConvertEncoding))try{n=r2(n)}catch{}const i=t?URL.parse(n,t):URL.parse(n);return Q1(i)?i:null}function Ed(n,t,e=!1){const i=URL.parse(n);return i?(i.hash=t,i.href):e&&vd(n,"http://example.com")?n.split("#",1)[0]+`${t?`#${t}`:""}`:""}function ut(n,t,e,i=!1){return Object.defineProperty(n,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const hi=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class Xl extends hi{constructor(t,e){super(t,"PasswordException"),this.code=e}}class jo extends hi{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Aa extends hi{constructor(t){super(t,"InvalidPDFException")}}class Rr extends hi{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class t2 extends hi{constructor(t){super(t,"FormatError")}}class Yn extends hi{constructor(t){super(t,"AbortException")}}function e2(n){(typeof n!="object"||n?.length===void 0)&&St("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<t;s+=e){const r=Math.min(s+e,t),o=n.subarray(s,r);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function Qr(n){typeof n!="string"&&St("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=n.charCodeAt(i)&255;return e}function n2(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function i2(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function s2(){try{return new Function(""),!0}catch{return!1}}class Zt{static get isLittleEndian(){return ut(this,"isLittleEndian",i2())}static get isEvalSupported(){return ut(this,"isEvalSupported",s2())}static get isOffscreenCanvasSupported(){return ut(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ut(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return ut(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return ut(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return ut(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return ut(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Go=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class X{static makeHexColor(t,e,i){return`#${Go[t]}${Go[e]}${Go[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const s=t[i],r=t[i+1];t[i]=s*e[0]+r*e[2]+e[4],t[i+1]=s*e[1]+r*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const s=e[0],r=e[1],o=e[2],a=e[3],u=e[4],l=e[5];for(let c=0;c<6;c+=2){const h=t[i+c],d=t[i+c+1];t[i+c]=h*s+d*o+u,t[i+c+1]=h*r+d*a+l}}static applyInverseTransform(t,e){const i=t[0],s=t[1],r=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-s*e[2]+e[2]*e[5]-e[4]*e[3])/r,t[1]=(-i*e[1]+s*e[0]+e[4]*e[1]-e[5]*e[0])/r}static axialAlignedBoundingBox(t,e,i){const s=e[0],r=e[1],o=e[2],a=e[3],u=e[4],l=e[5],c=t[0],h=t[1],d=t[2],f=t[3];let p=s*c+u,g=p,b=s*d+u,m=b,A=a*h+l,y=A,_=a*f+l,x=_;if(r!==0||o!==0){const v=r*c,S=r*d,M=o*h,R=o*f;p+=M,m+=M,b+=R,g+=R,A+=v,x+=v,_+=S,y+=S}i[0]=Math.min(i[0],p,b,g,m),i[1]=Math.min(i[1],A,_,y,x),i[2]=Math.max(i[2],p,b,g,m),i[3]=Math.max(i[3],A,_,y,x)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],s=t[1],r=t[2],o=t[3],a=i**2+s**2,u=i*r+s*o,l=r**2+o**2,c=(a+l)/2,h=Math.sqrt(c**2-(a*l-u**2));e[0]=Math.sqrt(c+h||1),e[1]=Math.sqrt(c-h||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>s)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>o?null:[i,r,s,o]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,s,r){r[0]=Math.min(r[0],t,i),r[1]=Math.min(r[1],e,s),r[2]=Math.max(r[2],t,i),r[3]=Math.max(r[3],e,s)}static#t(t,e,i,s,r,o,a,u,l,c){if(l<=0||l>=1)return;const h=1-l,d=l*l,f=d*l,p=h*(h*(h*t+3*l*e)+3*d*i)+f*s,g=h*(h*(h*r+3*l*o)+3*d*a)+f*u;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],g),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],g)}static#e(t,e,i,s,r,o,a,u,l,c,h,d){if(Math.abs(l)<1e-12){Math.abs(c)>=1e-12&&this.#t(t,e,i,s,r,o,a,u,-h/c,d);return}const f=c**2-4*h*l;if(f<0)return;const p=Math.sqrt(f),g=2*l;this.#t(t,e,i,s,r,o,a,u,(-c+p)/g,d),this.#t(t,e,i,s,r,o,a,u,(-c-p)/g,d)}static bezierBoundingBox(t,e,i,s,r,o,a,u,l){l[0]=Math.min(l[0],t,a),l[1]=Math.min(l[1],e,u),l[2]=Math.max(l[2],t,a),l[3]=Math.max(l[3],e,u),this.#e(t,i,r,a,e,s,o,u,3*(-t+3*(i-r)+a),6*(t-2*i+r),3*(i-t),l),this.#e(t,i,r,a,e,s,o,u,3*(-e+3*(s-o)+u),6*(e-2*s+o),3*(s-e),l)}}function r2(n){return decodeURIComponent(escape(n))}let Vo=null,Yl=null;function o2(n){return Vo||(Vo=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Yl=new Map([["","t"]])),n.replaceAll(Vo,(t,e,i)=>e?e.normalize("NFKC"):Yl.get(i))}function Cd(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),e2(n)}const Ci="pdfjs_internal_id_";function a2(n,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,s,...r]=e;if(!n(i)&&!Number.isInteger(i)||!t(s))return!1;const o=r.length;let a=!0;switch(s.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;a=!1;break;default:return!1}for(const u of r)if(!(typeof u=="number"||a&&u===null))return!1;return!0}function ue(n,t,e){return Math.min(Math.max(n,t),e)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((t,e)=>t+e,0)});class Fs{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function s(r){if(!r)return;let o=null;const a=r.name;if(a==="#text")o=r.value;else if(Fs.shouldBuildText(a))r?.attributes?.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&e.push({str:o}),!!r.children)for(const u of r.children)s(u)}return s(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Sd{static setupStorage(t,e,i,s,r){const o=s.getValue(e,{value:null});switch(i.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),r==="print")break;t.addEventListener("input",a=>{s.setValue(e,{value:a.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(o.value===i.attributes.xfaOn?t.setAttribute("checked",!0):o.value===i.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",a=>{s.setValue(e,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),r==="print")break;t.addEventListener("input",a=>{s.setValue(e,{value:a.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const a of i.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}t.addEventListener("input",a=>{const u=a.target.options,l=u.selectedIndex===-1?"":u[u.selectedIndex].value;s.setValue(e,{value:l})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:s,linkService:r}){const{attributes:o}=e,a=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[u,l]of Object.entries(o))if(l!=null)switch(u){case"class":l.length&&t.setAttribute(u,l.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",l);break;case"style":Object.assign(t.style,l);break;case"textContent":t.textContent=l;break;default:(!a||u!=="href"&&u!=="newWindow")&&t.setAttribute(u,l)}a&&r.addLinkAttributes(t,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(t,o.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,s=t.xfaHtml,r=t.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:r,linkService:i});const a=r!=="richText",u=t.div;if(u.append(o),t.viewport){const h=`matrix(${t.viewport.transform.join(",")})`;u.style.transform=h}a&&u.setAttribute("class","xfaLayer xfaFont");const l=[];if(s.children.length===0){if(s.value){const h=document.createTextNode(s.value);o.append(h),a&&Fs.shouldBuildText(s.name)&&l.push(h)}return{textDivs:l}}const c=[[s,-1,o]];for(;c.length>0;){const[h,d,f]=c.at(-1);if(d+1===h.children.length){c.pop();continue}const p=h.children[++c.at(-1)[1]];if(p===null)continue;const{name:g}=p;if(g==="#text"){const m=document.createTextNode(p.value);l.push(m),f.append(m);continue}const b=p?.attributes?.xmlns?document.createElementNS(p.attributes.xmlns,g):document.createElement(g);if(f.append(b),p.attributes&&this.setAttributes({html:b,element:p,storage:e,intent:r,linkService:i}),p.children?.length>0)c.push([p,-1,b]);else if(p.value){const m=document.createTextNode(p.value);a&&Fs.shouldBuildText(g)&&l.push(m),b.append(m)}}for(const h of u.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))h.setAttribute("readOnly",!0);return{textDivs:l}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Cn="http://www.w3.org/2000/svg";class ji{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Hs(n,t="text"){if(cs(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class zs{constructor({viewBox:t,userUnit:e,scale:i,rotation:s,offsetX:r=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=o,i*=e;const u=(t[2]+t[0])/2,l=(t[3]+t[1])/2;let c,h,d,f;switch(s%=360,s<0&&(s+=360),s){case 180:c=-1,h=0,d=0,f=1;break;case 90:c=0,h=1,d=1,f=0;break;case 270:c=0,h=-1,d=-1,f=0;break;case 0:c=1,h=0,d=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(d=-d,f=-f);let p,g,b,m;c===0?(p=Math.abs(l-t[1])*i+r,g=Math.abs(u-t[0])*i+o,b=(t[3]-t[1])*i,m=(t[2]-t[0])*i):(p=Math.abs(u-t[0])*i+r,g=Math.abs(l-t[1])*i+o,b=(t[2]-t[0])*i,m=(t[3]-t[1])*i),this.transform=[c*i,h*i,d*i,f*i,p-c*i*u-d*i*l,g-h*i*u-f*i*l],this.width=b,this.height=m}get rawDims(){const t=this.viewBox;return ut(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new zs({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(t,e){const i=[t,e];return X.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];X.applyTransform(e,this.transform);const i=[t[2],t[3]];return X.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return X.applyInverseTransform(i,this.transform),i}}class lu extends hi{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function to(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function cu(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function u2(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function l2(n,t="document.pdf"){if(typeof n!="string")return t;if(to(n))return at('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(a=>{try{return new URL(a)}catch{try{return new URL(decodeURIComponent(a))}catch{try{return new URL(a,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(a),"https://foo.bar")}catch{return null}}}}})(n);if(!i)return t;const s=a=>{try{let u=decodeURIComponent(a);return u.includes("/")?(u=u.split("/").at(-1),u.test(/^\.pdf$/i)?u:a):u}catch{return a}},r=/\.pdf$/i,o=i.pathname.split("/").at(-1);if(r.test(o))return s(o);if(i.searchParams.size>0){const a=Array.from(i.searchParams.values()).reverse();for(const l of a)if(r.test(l))return s(l);const u=Array.from(i.searchParams.keys()).reverse();for(const l of u)if(r.test(l))return s(l)}if(i.hash){const u=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(u)return s(u[0])}return t}class Kl{started=Object.create(null);times=[];time(t){t in this.started&&at(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||at(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:s,end:r}of this.times)t.push(`${i.padEnd(e)} ${r-s}ms
`);return t.join("")}}function cs(n,t){const e=t?URL.parse(n,t):URL.parse(n);return e?.protocol==="http:"||e?.protocol==="https:"}function Xe(n){n.preventDefault()}function jt(n){n.preventDefault(),n.stopPropagation()}function c2(n){console.log("Deprecated API usage: "+n)}class _a{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(e[5],10);a=a>=0&&a<=59?a:0;let u=parseInt(e[6],10);u=u>=0&&u<=59?u:0;const l=e[7]||"Z";let c=parseInt(e[8],10);c=c>=0&&c<=23?c:0;let h=parseInt(e[9],10)||0;return h=h>=0&&h<=59?h:0,l==="-"?(o+=c,a+=h):l==="+"&&(o-=c,a-=h),new Date(Date.UTC(i,s,r,o,a,u))}}function h2(n,{scale:t=1,rotation:e=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new zs({viewBox:r,userUnit:1,scale:t,rotation:e})}function $s(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(at(`Not a valid color format: "${n}"`),[0,0,0])}function d2(n){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of n.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;n.set(e,$s(i))}t.remove()}function Ht(n){const{a:t,b:e,c:i,d:s,e:r,f:o}=n.getTransform();return[t,e,i,s,r,o]}function an(n){const{a:t,b:e,c:i,d:s,e:r,f:o}=n.getTransform().invertSelf();return[t,e,i,s,r,o]}function ui(n,t,e=!1,i=!0){if(t instanceof zs){const{pageWidth:s,pageHeight:r}=t.rawDims,{style:o}=n,a=Zt.isCSSRoundSupported,u=`var(--total-scale-factor) * ${s}px`,l=`var(--total-scale-factor) * ${r}px`,c=a?`round(down, ${u}, var(--scale-round-x))`:`calc(${u})`,h=a?`round(down, ${l}, var(--scale-round-y))`:`calc(${l})`;!e||t.rotation%180===0?(o.width=c,o.height=h):(o.width=h,o.height=c)}i&&n.setAttribute("data-main-rotation",t.rotation)}class bn{constructor(){const{pixelRatio:t}=bn;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,s,r=-1){let o=1/0,a=1/0,u=1/0;i=bn.capPixels(i,r),i>0&&(o=Math.sqrt(i/(t*e))),s!==-1&&(a=s/t,u=s/e);const l=Math.min(o,a,u);return this.sx>l||this.sy>l?(this.sx=l,this.sy=l,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const xa=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class f2{static get isDarkMode(){return ut(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class p2{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),ut(this,"commentForegroundColor",$s(i))}}function g2(n,t,e,i){i=Math.min(Math.max(i??1,0),1);const s=255*(1-i);return n=Math.round(n*i+s),t=Math.round(t*i+s),e=Math.round(e*i+s),[n,t,e]}function Zl(n,t){const e=n[0]/255,i=n[1]/255,s=n[2]/255,r=Math.max(e,i,s),o=Math.min(e,i,s),a=(r+o)/2;if(r===o)t[0]=t[1]=0;else{const u=r-o;switch(t[1]=a<.5?u/(r+o):u/(2-r-o),r){case e:t[0]=((i-s)/u+(i<s?6:0))*60;break;case i:t[0]=((s-e)/u+2)*60;break;case s:t[0]=((e-i)/u+4)*60;break}}t[2]=a}function wa(n,t){const e=n[0],i=n[1],s=n[2],r=(1-Math.abs(2*s-1))*i,o=r*(1-Math.abs(e/60%2-1)),a=s-r/2;switch(Math.floor(e/60)){case 0:t[0]=r+a,t[1]=o+a,t[2]=a;break;case 1:t[0]=o+a,t[1]=r+a,t[2]=a;break;case 2:t[0]=a,t[1]=r+a,t[2]=o+a;break;case 3:t[0]=a,t[1]=o+a,t[2]=r+a;break;case 4:t[0]=o+a,t[1]=a,t[2]=r+a;break;case 5:case 6:t[0]=r+a,t[1]=a,t[2]=o+a;break}}function Jl(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function Ql(n,t,e){wa(n,e),e.map(Jl);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];wa(t,e),e.map(Jl);const s=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>s?(i+.05)/(s+.05):(s+.05)/(i+.05)}const tc=new Map;function m2(n,t){const e=n[0]+n[1]*256+n[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=tc.get(e);if(i)return i;const s=new Float32Array(9),r=s.subarray(0,3),o=s.subarray(3,6);Zl(n,o);const a=s.subarray(6,9);Zl(t,a);const u=a[2]<.5,l=u?12:4.5;if(o[2]=u?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),Ql(o,a,r)<l){let c,h;u?(c=o[2],h=1):(c=0,h=o[2]);const d=.005;for(;h-c>d;){const f=o[2]=(c+h)/2;u===Ql(o,a,r)<l?c=f:h=f}o[2]=u?h:c}return wa(o,r),i=X.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),tc.set(e,i),i}function Td({html:n,dir:t,className:e},i){const s=document.createDocumentFragment();if(typeof n=="string"){const r=document.createElement("p");r.dir=t||"auto";const o=n.split(/(?:\r\n?|\n)/);for(let a=0,u=o.length;a<u;++a){const l=o[a];r.append(document.createTextNode(l)),a<u-1&&r.append(document.createElement("br"))}s.append(r)}else Sd.render({xfaHtml:n,div:s,intent:"richText"});s.firstElementChild.classList.add("richText",e),i.append(s)}function kd(n){const t=new Path2D;if(!n)return t;for(let e=0,i=n.length;e<i;)switch(n[e++]){case ss.moveTo:t.moveTo(n[e++],n[e++]);break;case ss.lineTo:t.lineTo(n[e++],n[e++]);break;case ss.curveTo:t.bezierCurveTo(n[e++],n[e++],n[e++],n[e++],n[e++],n[e++]);break;case ss.quadraticCurveTo:t.quadraticCurveTo(n[e++],n[e++],n[e++],n[e++]);break;case ss.closePath:t.closePath();break;default:at(`Unrecognized drawing path operator: ${n[e-1]}`);break}return t}class vt{static#t=null;static#e=null;static#i=null;static#n=0;static#r=[];get pagesNumber(){return vt.#n}set pagesNumber(t){vt.#n!==t&&(vt.#n=t,t===0&&(vt.#e=null,vt.#t=null))}addListener(t){vt.#r.push(t)}removeListener(t){const e=vt.#r.indexOf(t);e>=0&&vt.#r.splice(e,1)}#o(){for(const t of vt.#r)t()}#s(t){if(vt.#e)return;const e=vt.#n,i=new Uint32Array(3*e),s=vt.#e=i.subarray(0,e),r=vt.#t=i.subarray(e,2*e);if(t)for(let o=0;o<e;o++)s[o]=r[o]=o+1;vt.#i=i.subarray(2*e)}movePages(t,e,i){this.#s(!0);const s=vt.#e,r=vt.#t;vt.#i.set(r);const o=e.length,a=new Uint32Array(o);let u=0;for(let f=0;f<o;f++){const p=e[f]-1;a[f]=s[p],p<i&&(u+=1)}const l=vt.#n;let c=i-u;const h=l-o;c=ue(c,0,h);for(let f=0,p=0;f<l;f++)t.has(f+1)||(s[p++]=s[f]);s.copyWithin(c+o,c,h),s.set(a,c);let d=!1;for(let f=0,p=l;f<p;f++){const g=s[f];d||=g!==f+1,r[g-1]=f+1}this.#o(),d||(this.pagesNumber=0)}hasBeenAltered(){return vt.#e!==null}getPageMappingForSaving(){return{pageIndices:vt.#t?vt.#t.map(t=>t-1):null}}getPrevPageNumber(t){return vt.#i[vt.#e[t-1]-1]}getPageNumber(t){return vt.#t?.[t-1]??t}getPageId(t){return vt.#e?.[t-1]??t}static get instance(){return ut(this,"instance",new vt)}getMapping(){return vt.#e.subarray(0,this.pagesNumber)}}class _s{#t=null;#e=null;#i;#n=null;#r=null;#o=null;#s=null;#a=null;static#l=null;constructor(t){this.#i=t,_s.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",Xe,{signal:e}),t.addEventListener("pointerdown",_s.#u,{signal:e}));const i=this.#n=document.createElement("div");i.className="buttons",t.append(i);const s=this.#i.toolbarPosition;if(s){const{style:r}=t,o=this.#i._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#u(t){t.stopPropagation()}#d(t){this.#i._focusEventsAllowed=!1,jt(t)}#h(t){this.#i._focusEventsAllowed=!0,jt(t)}#f(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Xe,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#o?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",_s.#l[t]),this.#f(i)&&i.addEventListener("click",s=>{e.delete()},{signal:e._signal}),this.#n.append(i)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#n.append(e,this.#m),this.#r=t}addComment(t,e=null){if(this.#o)return;const i=t.renderForToolbar();if(!i)return;this.#f(i);const s=this.#s=this.#m;e?(this.#n.insertBefore(i,e),this.#n.insertBefore(s,e)):this.#n.append(i,s),this.#o=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#n.append(e,this.#m)}async addEditSignatureButton(t){const e=this.#a=await t.renderEditButton(this.#i);this.#f(e),this.#n.append(e,this.#m)}removeButton(t){t==="comment"&&(this.#o?.removeToolbarCommentButton(),this.#o=null,this.#s?.remove(),this.#s=null)}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,i){if(!e&&t==="comment")return;const s=this.#n.querySelector(i);s&&t==="comment"&&this.addComment(e,s)}updateEditSignatureButton(t){this.#a&&(this.#a.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class b2{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",Xe,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#i.hasCommentManager()&&this.#o("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#o("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#r(t,e){let i=0,s=0;for(const r of t){const o=r.y+r.height;if(o<i)continue;const a=r.x+(e?r.width:0);if(o>i){s=a,i=o;continue}e?a>s&&(s=a):a<s&&(s=a)}return[e?1-s:s,i]}show(t,e,i){const[s,r]=this.#r(e,i),{style:o}=this.#e||=this.#n();t.append(this.#e),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#o(t,e,i,s){const r=document.createElement("button");r.classList.add("basic",t),r.tabIndex=0,r.setAttribute("data-l10n-id",e);const o=document.createElement("span");r.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",i);const a=this.#i._signal;a instanceof AbortSignal&&!a.aborted&&(r.addEventListener("contextmenu",Xe,{signal:a}),r.addEventListener("click",s,{signal:a})),this.#t.append(r)}}function Dd(n,t,e){for(const i of e)t.addEventListener(i,n[i].bind(n))}class Et{static#t=NaN;static#e=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(t){(Et.#e||=new Set).add(t)}static setPointer(t,e){Et.#t||=e,Et.#n??=t}static setTimeStamp(t){Et.#i=t}static isSamePointerId(t){return Et.#t===t}static isSamePointerIdOrRemove(t){return Et.#t===t?!0:(Et.#e?.delete(t),!1)}static isSamePointerType(t){return Et.#n===t}static isInitializedAndDifferentPointerType(t){return Et.#n!==null&&!Et.isSamePointerType(t)}static isSameTimeStamp(t){return Et.#i===t}static isUsingMultiplePointers(){return Et.#e?.size>=1}static clearPointerType(){Et.#n=null}static clearPointerIds(){Et.#t=NaN,Et.#e=null}static clearTimeStamp(){Et.#i=NaN}}class y2{#t=0;get id(){return`${Ms}${this.#t++}`}}class hu{#t=Cd();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return ut(this,"_isSVGFittingCanvas",r)}async#n(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let s;if(typeof e=="string"?(i.url=e,s=await Hs(e,"blob")):e instanceof File?s=i.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const r=hu._isSVGFittingCanvas,o=new FileReader,a=new Image,u=new Promise((l,c)=>{a.onload=()=>{i.bitmap=a,i.isSvg=!0,l()},o.onload=async()=>{const h=i.svgUrl=o.result;a.src=await r?`${h}#svgView(preserveAspectRatio(none))`:h},a.onerror=o.onerror=c});o.readAsDataURL(s),await u}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){at(s),i=null}return this.#i.set(t,i),i&&this.#i.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:s,type:r}=t;return this.#n(`${e}_${i}_${s}_${r}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const i=await e;return this.#n(t,i)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i?.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,i),this.#i.set(i.id,i),i}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(i.width,i.height);s.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=s.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class A2{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(s&&t(),this.#e)return;const u={cmd:t,undo:e,post:i,type:r};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(u);return}if(o&&this.#t[this.#n].type===r){a&&(u.undo=this.#t[this.#n].undo),this.#t[this.#n]=u;return}const l=this.#n+1;l===this.#i?this.#t.splice(0,1):(this.#n=l,l<this.#t.length&&this.#t.splice(l)),this.#t.push(u)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class js{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Zt.platform;for(const[i,s,r={}]of t)for(const o of i){const a=o.startsWith("mac+");e&&a?(this.callbacks.set(o.slice(4),{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1))):!e&&!a&&(this.callbacks.set(o,{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:o=[],checker:a=null}}=i;a&&!a(t,e)||(s.bind(t,...o,e)(),r||jt(e))}}class du{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return d2(t),ut(this,"_colors",t)}convert(t){const e=$s(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,s]of this._colors)if(s.every((r,o)=>r===e[o]))return du._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?X.makeHexColor(...e):t}}class Kn{#t=new AbortController;#e=null;#i=null;#n=new Map;#r=new Map;#o=null;#s=null;#a=null;#l=new A2;#u=null;#d=null;#h=null;#f=0;#m=new Set;#g=null;#c=null;#p=new Set;_editorUndoBar=null;#b=!1;#A=!1;#y=!1;#C=null;#v=null;#x=null;#T=null;#_=!1;#E=null;#M=new y2;#k=!1;#D=!1;#N=!1;#F=null;#I=null;#B=null;#L=null;#G=null;#S=ct.NONE;#w=new Set;#R=null;#U=null;#z=null;#q=null;#W=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#$=[0,0];#O=null;#V=null;#J=null;#Q=null;#H=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Kn.prototype,e=o=>o.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),i=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:u}=a;return u!=="text"&&u!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return ut(this,"_keyboardManager",new js([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&o.#V.contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&o.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}constructor(t,e,i,s,r,o,a,u,l,c,h,d,f,p,g,b){const m=this._signal=this.#t.signal;this.#V=t,this.#J=e,this.#Q=i,this.#o=s,this.#u=r,this.#U=o,this.#W=u,this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:m}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),a._on("setpreference",this.onSetPreference.bind(this),{signal:m}),a._on("switchannotationeditorparams",A=>this.updateParams(A.type,A.value),{signal:m}),a._on("pagesedited",this.onPagesEdited.bind(this),{signal:m}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:m}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:m}),this.#ot(),this.#dt(),this.#et(),this.#s=u.annotationStorage,this.#C=u.filterFactory,this.#z=l,this.#T=c||null,this.#b=h,this.#A=d,this.#y=f,this.#G=p||null,this.viewParameters={realScale:ji.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=g||null,this._supportsPinchToZoom=b!==!1,r?.setSidebarUiManager(this)}destroy(){this.#H?.resolve(),this.#H=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#n.clear(),this.#p.clear(),this.#L?.clear(),this.#e=null,this.#w.clear(),this.#l.destroy(),this.#o?.destroy(),this.#u?.destroy(),this.#U?.destroy(),this.#E?.hide(),this.#E=null,this.#B?.destroy(),this.#B=null,this.#i=null,this.#v&&(clearTimeout(this.#v),this.#v=null),this.#O&&(clearTimeout(this.#O),this.#O=null),this._editorUndoBar?.destroy(),this.#W=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#A}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return ut(this,"hcmFilter",this.#z?this.#C.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return ut(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return ut(this,"_highlightColors",this.#T?new Map(this.#T.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return ut(this,"highlightColors",null);const e=new Map,i=!!this.#z;for(const[s,r]of t){const o=s.endsWith("_HCM");if(i&&o){e.set(s.replace("_HCM",""),r);continue}!i&&!o&&e.set(s,r)}return ut(this,"highlightColors",e)}get highlightColorNames(){return ut(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#B=t}editAltText(t,e=!1){this.#o?.editAltText(this,t,e)}hasCommentManager(){return!!this.#u}editComment(t,e,i,s){this.#u?.showDialog(this,t,e,i,s)}selectComment(t,e){this.#r.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#u?.updateComment(t.getData())}updatePopupColor(t){this.#u?.updatePopupColor(t)}removeComment(t){this.#u?.removeComments([t.uid])}deleteComment(t,e){const i=()=>{t.comment=e},s=()=>{this._editorUndoBar?.show(i,"comment"),this.toggleComment(null),t.comment=null};this.addCommands({cmd:s,undo:i,mustExec:!0})}toggleComment(t,e,i=void 0){this.#u?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&this.#u?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#u?.dialogElement||null}async waitForEditorsRendered(t){if(this.#r.has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),s=r=>{r.pageNumber===t&&(this._eventBus._off("editorsrendered",s),e())};this._eventBus.on("editorsrendered",s),await i}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#y=e)}onPagesEdited({pagesMapper:t}){for(const s of this.#n.values())s.updatePageIndex(t.getPrevPageNumber(s.pageIndex+1)-1);const e=this.#r,i=this.#r=new Map;for(const[s,r]of e){const o=t.getPrevPageNumber(s+1)-1;if(o===-1){r.destroy();continue}i.set(o,r),r.updatePageIndex(o)}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,e){for(const i of this.#r.values()){const{x:s,y:r,width:o,height:a}=i.div.getBoundingClientRect();if(t>=s&&t<=s+o&&e>=r&&e<=r+a)return i}return null}disableUserSelect(t=!1){this.#J.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*ji.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Z({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#r.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:s,anchorOffset:r,focusNode:o,focusOffset:a}=i,u=i.toString(),c=this.#Z(i).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;i.empty();const d=this.#tt(c),f=this.#S===ct.NONE,p=()=>{const g=d?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:h,anchorNode:s,anchorOffset:r,focusNode:o,focusOffset:a,text:u});f&&this.showAllEditors("highlight",!0,!0),e&&g?.editComment()};if(f){this.switchToMode(ct.HIGHLIGHT,p);return}p()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#Z(t).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(this.#E||=new b2(this),this.#E.show(i,s,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const e=`${Ms}${t}`,i=this.#s.getRawValue(e);return i&&this.#s.remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#Q;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#rt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#R&&(this.#E?.hide(),this.#R=null,this.#P({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#R)return;const s=this.#Z(t).closest(".textLayer");if(!s){this.#R&&(this.#E?.hide(),this.#R=null,this.#P({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#R=e,this.#P({hasSelectedText:!0}),!(this.#S!==ct.HIGHLIGHT&&this.#S!==ct.NONE)&&(this.#S===ct.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#_=this.isShiftKeyDown,!this.isShiftKeyDown)){const r=this.#S===ct.HIGHLIGHT?this.#tt(s):null;if(r?.toggleDrawing(),this.#D){const o=new AbortController,a=this.combinedSignal(o),u=l=>{l.type==="pointerup"&&l.button!==0||(o.abort(),r?.toggleDrawing(!0),l.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})}else r?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(t=""){this.#S===ct.HIGHLIGHT?this.highlightSelection(t):this.#b&&this.#st()}#ot(){document.addEventListener("selectionchange",this.#rt.bind(this),{signal:this._signal})}#at(){if(this.#x)return;this.#x=new AbortController;const t=this.combinedSignal(this.#x);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ut(){this.#x?.abort(),this.#x=null}blur(){if(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#w)if(e.div.contains(t)){this.#I=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#I)return;const[t,e]=this.#I;this.#I=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#F)return;this.#F=new AbortController;const t=this.combinedSignal(this.#F);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#lt(){this.#F?.abort(),this.#F=null}#ct(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#lt(),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#c)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#c)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#w){const s=i.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const o of this.#c)if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){at(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const u of i){const l=await s.deserialize(u);if(!l)return;r.push(l)}const o=()=>{for(const u of r)this.#nt(u);this.#it(r)},a=()=>{for(const u of r)u.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(r){at(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#S!==ct.NONE&&!this.isEditorHandlingKeyboard&&Kn._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#Y("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#P(t){Object.entries(t).some(([i,s])=>this.#X[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,t)}),this.#S===ct.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#j([[yt.HIGHLIGHT_FREE,!0]]))}#j(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#at(),this.#ct(),this.#P({isEditing:this.#S!==ct.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:this.#l.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ut(),this.#ht(),this.#P({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#c){this.#c=t;for(const e of this.#c)this.#j(e.defaultPropertiesToUpdate)}}getId(){return this.#M.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#k?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,s=!1,r=!1,o=!1){if(this.#S!==t&&!(this.#H&&(await this.#H.promise,!this.#H))){if(this.#H=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#S===ct.POPUP&&this.#u?.hideSidebar(),this.#u?.destroyPopup(),this.#S=t,t===ct.NONE){this.setEditingState(!1),this.#pt();for(const a of this.#n.values())a.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#H.resolve();return}for(const a of this.#n.values())a.addStandaloneCommentButton();t===ct.SIGNATURE&&await this.#U?.loadSignatures(),i&&Et.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const a of this.#r.values())a.updateMode(t);if(t===ct.POPUP){this.#i||=await this.#W.getAnnotationsByType(new Set(this.#c.map(l=>l._editorType)));const a=new Set,u=[];for(const l of this.#n.values()){const{annotationElementId:c,hasComment:h,deleted:d}=l;c&&a.add(c),h&&!d&&u.push(l.getData())}for(const l of this.#i){const{id:c,popupRef:h,contentsObj:d}=l;h&&d?.str&&!a.has(c)&&!this.#m.has(c)&&u.push(l)}this.#u?.showSidebar(u)}if(!e){s&&this.addNewEditorFromKeyboard(),this.#H.resolve();return}for(const a of this.#n.values())a.uid===e?(this.setSelected(a),o?a.editComment():r?a.enterInEditMode():a.focus()):a.unselect();this.#H.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#S&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#c){switch(t){case yt.CREATE:this.currentLayer.addNewEditor(e);return;case yt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#q||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#w)i.updateParams(t,e);else for(const i of this.#c)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const r of this.#n.values())r.editorType===t&&r.show(e);(this.#q?.get(yt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#j([[yt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#N!==t){this.#N=t;for(const e of this.#r.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#k){this.#k=!0;const t=[];for(const e of this.#r.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#pt(){if(this.unselectAll(),this.#k){this.#k=!1;for(const t of this.#r.values())t.disable();for(const t of this.#n.values())t.disable()}}*getEditors(t){for(const e of this.#n.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.focusMainContainer(),this.#v=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#L?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#r.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#j(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#w);return t}updateUI(t){this.#gt===t&&this.#j(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#j(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#P({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#j(t.propertiesToUpdate),this.#P({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const e of this.#w)e!==t&&e.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#j(t.propertiesToUpdate),this.#P({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#P({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#l.undo(),this.#P({hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#l.redo(),this.#P({hasSomethingToUndo:!0,hasSomethingToRedo:this.#l.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(t){this.#l.add(t),this.#P({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(t){this.#l.cleanType(t)}#K(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#w],i=()=>{this._editorUndoBar?.show(s,e.length===1?e[0].editorType:e.length);for(const r of e)r.remove()},s=()=>{for(const r of e)this.#nt(r)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#it(t){for(const e of this.#w)e.unselect();this.#w.clear();for(const e of t)e.isEmpty()||(this.#w.add(e),e.select());this.#P({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#w)t.commit();this.#it(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#S!==ct.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#w)t.unselect();this.#w.clear(),this.#P({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#$[0]+=t,this.#$[1]+=e;const[s,r]=this.#$,o=[...this.#w],a=1e3;this.#O&&clearTimeout(this.#O),this.#O=setTimeout(()=>{this.#O=null,this.#$[0]=this.#$[1]=0,this.addCommands({cmd:()=>{for(const u of o)this.#n.has(u.id)&&(u.translateInPage(s,r),u.translationDone())},undo:()=>{for(const u of o)this.#n.has(u.id)&&(u.translateInPage(-s,-r),u.translationDone())},mustExec:!1})},a);for(const u of o)u.translateInPage(t,e),u.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#w)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let e=!1;for(const[{x:s,y:r,pageIndex:o},a]of t)a.newX=s,a.newY=r,a.newPageIndex=o,e||=s!==a.savedX||r!==a.savedY||o!==a.savedPageIndex;if(!e)return!1;const i=(s,r,o,a)=>{if(this.#n.has(s.id)){const u=this.#r.get(a);u?s._setParentAndPosition(u,r,o):(s.pageIndex=a,s.x=r,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:o,newPageIndex:a}]of t)i(s,r,o,a)},undo:()=>{for(const[s,{savedX:r,savedY:o,savedPageIndex:a}]of t)i(s,r,o,a)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#g)for(const i of this.#g.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#S}isEditingMode(){return this.#S!==ct.NONE}get imageManager(){return ut(this,"imageManager",new hu)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let l=0,c=e.rangeCount;l<c;l++)if(!t.contains(e.getRangeAt(l).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:o}=t.getBoundingClientRect();let a;switch(t.getAttribute("data-main-rotation")){case"90":a=(l,c,h,d)=>({x:(c-s)/o,y:1-(l+h-i)/r,width:d/o,height:h/r});break;case"180":a=(l,c,h,d)=>({x:1-(l+h-i)/r,y:1-(c+d-s)/o,width:h/r,height:d/o});break;case"270":a=(l,c,h,d)=>({x:1-(c+d-s)/o,y:(l-i)/r,width:d/o,height:h/r});break;default:a=(l,c,h,d)=>({x:(l-i)/r,y:(c-s)/o,width:h/r,height:d/o});break}const u=[];for(let l=0,c=e.rangeCount;l<c;l++){const h=e.getRangeAt(l);if(!h.collapsed)for(const{x:d,y:f,width:p,height:g}of h.getClientRects())p===0||g===0||u.push(a(d,f,p,g))}return u.length===0?null:u}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#a||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#a?.delete(t)}renderAnnotationElement(t){const e=this.#a?.get(t.data.id);if(!e)return;const i=this.#s.getRawValue(e);i&&(this.#S===ct.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const s=this.#L?.get(t);s&&(s.setCanvas(e,i),this.#L.delete(t))}addMissingCanvas(t,e){(this.#L||=new Map).set(t,e)}}class hn{#t=null;#e=!1;#i=null;#n=null;#r=null;#o=null;#s=!1;#a=null;#l=null;#u=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#l=t,this.#h=t._uiManager.useNewAltTextFlow,hn.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){hn._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",hn.#f.missing),e.setAttribute("data-l10n-id",hn.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#l._uiManager._signal;t.addEventListener("contextmenu",Xe,{signal:i}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),this.#l._uiManager.editAltText(this.#l),this.#h&&this.#l._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#s=!0,s(r))},{signal:i}),await this.#g(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#u:this.isEmpty()}get guessedText(){return this.#u}async setGuessedText(t){this.#t===null&&(this.#u=t,this.#d=await hn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#a?.remove(),this.#a=null;return}if(!this.#a){const e=this.#a=document.createElement("div");e.className="noAltTextBadge",this.#l.div.append(e)}this.#a.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#u===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#u,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(this.#u=i,this.#d=s),!(this.#t===t&&this.#e===e)&&(r||(this.#t=t,this.#e=e),this.#g())}toggle(t=!1){this.#i&&(!t&&this.#o&&(clearTimeout(this.#o),this.#o=null),this.#i.disabled=!t)}shown(){this.#l._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#r=null,this.#a?.remove(),this.#a=null}async#g(){const t=this.#i;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",hn.#f[this.#m]),this.#n?.setAttribute("data-l10n-id",hn.#f[`${this.#m}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#r;if(!e){this.#r=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#l.id}`;const s=100,r=this.#l._uiManager._signal;r.addEventListener("abort",()=>{clearTimeout(this.#o),this.#o=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#o=setTimeout(()=>{this.#o=null,this.#r.classList.add("show"),this.#l._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:r}),t.addEventListener("mouseleave",()=>{this.#o&&(clearTimeout(this.#o),this.#o=null),this.#r?.classList.remove("show")},{signal:r})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#l.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class nr{#t=null;#e=null;#i=!1;#n=null;#r=null;#o=null;#s=null;#a=null;#l=!1;#u=null;constructor(t){this.#n=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#n.commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const s=this.#n.commentButtonColor;s&&(i.backgroundColor=s)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#n.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#u)return this.#u;if(!this.#t)return null;const{x:t,y:e,height:i}=this.#t.getBoundingClientRect(),{x:s,y:r,width:o,height:a}=this.#n.parent.boundingClientRect;return[(t-s)/o,(e+i-r)/a]}set commentPopupPositionInLayer(t){this.#u=t}hasDefaultPopupPosition(){return this.#u===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#n._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const i=this.#n._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",Xe,{signal:i}),e&&(t.addEventListener("focusin",r=>{this.#n._focusEventsAllowed=!1,jt(r)},{capture:!0,signal:i}),t.addEventListener("focusout",r=>{this.#n._focusEventsAllowed=!0,jt(r)},{capture:!0,signal:i})),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),t===this.#e?this.edit():this.#n.toggleComment(!0)};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#i=!0,s(r))},{signal:i}),t.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:i}),t}edit(t){const e=this.commentPopupPositionInLayer;let i,s;if(e)[i,s]=e;else{[i,s]=this.#n.commentButtonPosition;const{width:c,height:h,x:d,y:f}=this.#n;i=d+i*c,s=f+s*h}const r=this.#n.parent.boundingClientRect,{x:o,y:a,width:u,height:l}=r;this.#n._uiManager.editComment(this.#n,o+i*u,a+s*l,{...t,parentDimensions:r})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#l||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#r}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#o,date:this.#a,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#o=null),t===null){this.#s="",this.#l=!0;return}this.#s=t,this.#a=new Date,this.#l=!1}restoreData({text:t,richText:e,date:i}){this.#s=t,this.#o=e,this.#a=i,this.#l=!1}setInitialText(t,e=null){this.#r=t,this.data=t,this.#a=null,this.#o=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#o=null,this.#a=null,this.#n=null,this.#i=!1,this.#l=!1}}class eo{#t;#e=!1;#i=null;#n;#r;#o;#s;#a=null;#l;#u=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:o=null,signal:a}){this.#t=t,this.#i=i,this.#n=e,this.#r=s,this.#o=r,this.#s=o,this.#d=new AbortController,this.#l=AbortSignal.any([a,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#l})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/bn.pixelRatio}#f(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#a)return;const s=this.#a=new AbortController,r=AbortSignal.any([this.#l,s.signal]),o=this.#t,a={capture:!0,signal:r,passive:!1},u=l=>{l.pointerType==="touch"&&(this.#a?.abort(),this.#a=null)};o.addEventListener("pointerdown",l=>{l.pointerType==="touch"&&(jt(l),u(l))},a),o.addEventListener("pointerup",u,a),o.addEventListener("pointercancel",u,a);return}if(!this.#h){this.#h=new AbortController;const s=AbortSignal.any([this.#l,this.#h.signal]),r=this.#t,o={signal:s,capture:!1,passive:!1};r.addEventListener("touchmove",this.#m.bind(this),o);const a=this.#g.bind(this);r.addEventListener("touchend",a,o),r.addEventListener("touchcancel",a,o),o.capture=!0,r.addEventListener("pointerdown",jt,o),r.addEventListener("pointermove",jt,o),r.addEventListener("pointercancel",jt,o),r.addEventListener("pointerup",jt,o),this.#r?.()}if(jt(t),t.touches.length!==2||this.#i?.()){this.#u=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#u={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#m(t){if(!this.#u||t.touches.length!==2)return;jt(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:s,screenY:r}=e,{screenX:o,screenY:a}=i,u=this.#u,{touch0X:l,touch0Y:c,touch1X:h,touch1Y:d}=u,f=h-l,p=d-c,g=o-s,b=a-r,m=Math.hypot(g,b)||1,A=Math.hypot(f,p)||1;if(!this.#e&&Math.abs(A-m)<=eo.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(u.touch0X=s,u.touch0Y=r,u.touch1X=o,u.touch1Y=a,!this.#e){this.#e=!0;return}const y=[(s+o)/2,(r+a)/2];this.#o?.(y,A,m)}#g(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#u&&(jt(t),this.#u=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#a?.abort(),this.#a=null}}class tt{#t=null;#e=null;#i=null;#n=null;#r=null;#o=!1;#s=null;#a="";#l=null;#u=null;#d=null;#h=null;#f=null;#m="";#g=!1;#c=null;#p=!1;#b=!1;#A=!1;#y=null;#C=0;#v=0;#x=null;#T=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#_=!1;#E=tt._zIndex++;static _borderLineWidth=-1;static _colorManager=new du;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=tt.prototype._resizeWithKeyboard,e=Kn.TRANSLATE_SMALL,i=Kn.TRANSLATE_BIG;return ut(this,"_resizerKeyboardManager",new js([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],tt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,o];const[a,u]=this.parentDimensions;this.x=t.x/a,this.y=t.y/u,this.isAttachedToDOM=!1,this.deleted=!1}updatePageIndex(t){this.pageIndex=t}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ut(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new _2({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(tt._l10n??=t,tt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),tt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);tt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){St("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#_}set _isDraggable(t){this.#_=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#E}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#O(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,s){const[r,o]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(t+i)/r,this.y=(e+s)/o,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,s]=this.parentDimensions;this.setAt(t*i,e*s,this.width*i,this.height*s),this._onTranslated()}#M([t,e],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/t,this.y+=s/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#M(this.parentDimensions,t,e)}translateInPage(t,e){this.#c||=[this.x,this.y,this.width,this.height],this.#M(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#c||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[s,r]}=this;if(this.x+=t/s,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[u,l]=this.getBaseTranslation();o+=u,a+=l;const{style:c}=i;c.left=`${(100*o).toFixed(2)}%`,c.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#c&&(this.#c[0]!==this.x||this.#c[1]!==this.y)}get _hasBeenResized(){return!!this.#c&&(this.#c[2]!==this.width||this.#c[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=tt,s=i/t,r=i/e;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,s]}=this;let{x:r,y:o,width:a,height:u}=this;if(a*=i,u*=s,r*=i,o*=s,this._mustFixPosition)switch(t){case 0:r=ue(r,0,i-a),o=ue(o,0,s-u);break;case 90:r=ue(r,0,i-u),o=ue(o,a,s);break;case 180:r=ue(r,a,i),o=ue(o,u,s);break;case 270:r=ue(r,u,i),o=ue(o,0,s-a);break}this.x=r/=i,this.y=o/=s;const[l,c]=this.getBaseTranslation();r+=l,o+=c,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#k(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return tt.#k(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return tt.#k(t,e,360-this.parentRotation)}#D(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#N(){if(this.#l)return;this.#l=document.createElement("div"),this.#l.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const s=document.createElement("div");this.#l.append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",this.#F.bind(this,i),{signal:e}),s.addEventListener("contextmenu",Xe,{signal:e}),s.tabIndex=-1}this.div.prepend(this.#l)}#F(t,e){e.preventDefault();const{isMac:i}=Zt.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#i?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#u=[e.screenX,e.screenY];const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#L.bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",jt,{passive:!1,signal:o}),window.addEventListener("contextmenu",Xe,{signal:o}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const a=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const l=()=>{r.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=a,this.div.style.cursor=u,this.#B()};window.addEventListener("pointerup",l,{signal:o}),window.addEventListener("blur",l,{signal:o})}#I(t,e,i,s){this.width=i,this.height=s,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#B(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:s}=this.#d;this.#d=null;const r=this.x,o=this.y,a=this.width,u=this.height;r===t&&o===e&&a===i&&u===s||this.addCommands({cmd:this.#I.bind(this,r,o,a,u),undo:this.#I.bind(this,t,e,i,s),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#L(t,e){const[i,s]=this.parentDimensions,r=this.x,o=this.y,a=this.width,u=this.height,l=tt.MIN_SIZE/i,c=tt.MIN_SIZE/s,h=this.#D(this.rotation),d=(U,O)=>[h[0]*U+h[2]*O,h[1]*U+h[3]*O],f=this.#D(360-this.rotation),p=(U,O)=>[f[0]*U+f[2]*O,f[1]*U+f[3]*O];let g,b,m=!1,A=!1;switch(t){case"topLeft":m=!0,g=(U,O)=>[0,0],b=(U,O)=>[U,O];break;case"topMiddle":g=(U,O)=>[U/2,0],b=(U,O)=>[U/2,O];break;case"topRight":m=!0,g=(U,O)=>[U,0],b=(U,O)=>[0,O];break;case"middleRight":A=!0,g=(U,O)=>[U,O/2],b=(U,O)=>[0,O/2];break;case"bottomRight":m=!0,g=(U,O)=>[U,O],b=(U,O)=>[0,0];break;case"bottomMiddle":g=(U,O)=>[U/2,O],b=(U,O)=>[U/2,0];break;case"bottomLeft":m=!0,g=(U,O)=>[0,O],b=(U,O)=>[U,0];break;case"middleLeft":A=!0,g=(U,O)=>[0,O/2],b=(U,O)=>[U,O/2];break}const y=g(a,u),_=b(a,u);let x=d(..._);const v=tt._round(r+x[0]),S=tt._round(o+x[1]);let M=1,R=1,j,I;if(e.fromKeyboard)({deltaX:j,deltaY:I}=e);else{const{screenX:U,screenY:O}=e,[q,At]=this.#u;[j,I]=this.screenToPageTranslation(U-q,O-At),this.#u[0]=U,this.#u[1]=O}if([j,I]=p(j/i,I/s),m){const U=Math.hypot(a,u);M=R=Math.max(Math.min(Math.hypot(_[0]-y[0]-j,_[1]-y[1]-I)/U,1/a,1/u),l/a,c/u)}else A?M=ue(Math.abs(_[0]-y[0]-j),l,1)/a:R=ue(Math.abs(_[1]-y[1]-I),c,1)/u;const Y=tt._round(a*M),dt=tt._round(u*R);x=d(...b(Y,dt));const et=v-x[0],mt=S-x[1];this.#c||=[this.x,this.y,this.width,this.height],this.width=Y,this.height=dt,this.x=et,this.y=mt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#b)return this._editToolbar;this._editToolbar=new _s(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(hn.initialize(tt._l10n),this.#i=new hn(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new nr(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#n.renderForStandalone(),this.div.append(this.#r))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){if(!this.#n)return null;const{data:{richText:t,text:e,date:i,deleted:s}}=this.#n;return{text:e,richText:t,date:i,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#n||=new nr(this),typeof t=="object"&&t!==null?this.#n.restoreData(t):this.#n.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(this.#n||=new nr(this),this.#n.setInitialText(t,i),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(t){this.#n||=new nr(this),this.#n.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#n.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,s]=t.rect,[r]=this.pageDimensions,[o]=this.pageTranslation,a=o+r+1,u=s-100,l=a+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[a,u,l,s]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#n.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#o?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[s,r]=this.getInitialTranslation();return this.translate(s,r),Dd(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#T||=new eo({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#S.bind(this),onPinchEnd:this.#w.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#S(t,e,i){let r=.7*(i/e)+1-.7;if(r===1)return;const o=this.#D(this.rotation),a=(v,S)=>[o[0]*v+o[2]*S,o[1]*v+o[3]*S],[u,l]=this.parentDimensions,c=this.x,h=this.y,d=this.width,f=this.height,p=tt.MIN_SIZE/u,g=tt.MIN_SIZE/l;r=Math.max(Math.min(r,1/d,1/f),p/d,g/f);const b=tt._round(d*r),m=tt._round(f*r);if(b===d&&m===f)return;this.#c||=[c,h,d,f];const A=a(d/2,f/2),y=tt._round(c+A[0]),_=tt._round(h+A[1]),x=a(b/2,m/2);this.x=y-x[0],this.y=_-x[1],this.width=b,this.height=m,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#w(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#B()}pointerdown(t){const{isMac:e}=Zt.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#U(t);return}this.#R(t)}#R(t){const{isMac:e}=Zt.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),o={capture:!0,passive:!1,signal:r},a=l=>{s.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#R(l),i&&this._onStopDragging()};e&&(this.#C=t.clientX,this.#v=t.clientY,this.#s=t.pointerId,this.#a=t.pointerType,window.addEventListener("pointermove",l=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:c,clientY:h,pointerId:d}=l;if(d!==this.#s){jt(l);return}const[f,p]=this.screenToPageTranslation(c-this.#C,h-this.#v);this.#C=c,this.#v=h,this._uiManager.dragSelectedEditors(f,p)},o),window.addEventListener("touchmove",jt,o),window.addEventListener("pointerdown",l=>{l.pointerType===this.#a&&(this.#T||l.isPrimary)&&a(l),jt(l)},o));const u=l=>{if(!this.#s||this.#s===l.pointerId){a(l);return}jt(l)};window.addEventListener("pointerup",u,{signal:r}),window.addEventListener("blur",u,{signal:r})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const s=this.parentScale,[r,o]=this.pageDimensions,[a,u]=this.pageTranslation,l=t/s,c=e/s,h=this.x*r,d=this.y*o,f=this.width*r,p=this.height*o;switch(i){case 0:return[h+l+a,o-d-c-p+u,h+l+f+a,o-d-c+u];case 90:return[h+c+a,o-d+l+u,h+c+p+a,o-d+l+f+u];case 180:return[h-l-f+a,o-d+c+u,h-l+a,o-d+c+p+u];case 270:return[h-c-p+a,o-d-l-f+u,h-c+a,o-d-l+u];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,s,r,o]=t,a=r-i,u=o-s;switch(this.rotation){case 0:return[i,e-o,a,u];case 90:return[i,e-s,u,a];case 180:return[r,e-s,a,u];case 270:return[r,e-o,u,a];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&tt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:s,deleted:r,richText:o},uid:a,pageIndex:u,creationDate:l,modificationDate:c}=this;return{id:a,pageIndex:u,rect:this.getPDFRect(),richText:o,contentsObj:{str:t},creationDate:l,modificationDate:i||c,popupRef:!r,color:e,opacity:s}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#b=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#b=!1,!0):!1}isInEditMode(){return this.#b}shouldGetKeyboardEvents(){return this.#A}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return e<o&&s>0&&t<r&&i>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});s.rotation=t.rotation,s.#t=t.accessibilityData,s._isCopy=t.isCopy||!1;const[r,o]=s.pageDimensions,[a,u,l,c]=s.getRectInCurrentCoords(t.rect,o);return s.x=a/r,s.y=u/o,s.width=l/r,s.height=c/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#O(),this.removeEditToolbar(),this.#x){for(const t of this.#x.values())clearTimeout(t);this.#x=null}this.parent=null,this.#T?.destroy(),this.#T=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#N(),this.#l.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,s,r,o]=this.getPDFRect();return[tt._round(i+(r-i)*t),tt._round(s+(o-s)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(t){this.#n.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#n?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#l.children;if(!this.#e){this.#e=Array.from(e);const o=this.#q.bind(this),a=this.#W.bind(this),u=this._uiManager._signal;for(const l of this.#e){const c=l.getAttribute("data-resizer-name");l.setAttribute("role","spinbutton"),l.addEventListener("keydown",o,{signal:u}),l.addEventListener("blur",a,{signal:u}),l.addEventListener("focus",this.#X.bind(this,c),{signal:u}),l.setAttribute("data-l10n-id",tt._l10nResizer[c])}}const i=this.#e[0];let s=0;for(const o of e){if(o===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(r!==s){if(r<s)for(let a=0;a<s-r;a++)this.#l.append(this.#l.firstElementChild);else if(r>s)for(let a=0;a<r-s;a++)this.#l.firstElementChild.before(this.#l.lastElementChild);let o=0;for(const a of e){const l=this.#e[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",tt._l10nResizer[l])}}this.#$(0),this.#A=!0,this.#l.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#q(t){tt._resizerKeyboardManager.exec(this,t)}#W(t){this.#A&&t.relatedTarget?.parentNode!==this.#l&&this.#O()}#X(t){this.#m=this.#A?t:""}#$(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#A&&this.#L(this.#m,{deltaX:t,deltaY:e,fromKeyboard:!0})}#O(){this.#A=!1,this.#$(-1),this.#B()}_stopResizingWithKeyboard(){this.#O(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#l?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#x||=new Map;const{action:i}=t;let s=this.#x.get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),this.#x.delete(i),this.#x.size===0&&(this.#x=null)},tt._telemetryTimeout),this.#x.set(i,s);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#o=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#o=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class _2 extends tt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const ec=3285377520,$e=4294901760,un=65535;class Md{constructor(t){this.h1=t?t&4294967295:ec,this.h2=t?t&4294967295:ec}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let g=0,b=t.length;g<b;g++){const m=t.charCodeAt(g);m<=255?e[i++]=m:(e[i++]=m>>>8,e[i++]=m&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,o=new Uint32Array(e.buffer,0,s);let a=0,u=0,l=this.h1,c=this.h2;const h=3432918353,d=461845907,f=h&un,p=d&un;for(let g=0;g<s;g++)g&1?(a=o[g],a=a*h&$e|a*f&un,a=a<<15|a>>>17,a=a*d&$e|a*p&un,l^=a,l=l<<13|l>>>19,l=l*5+3864292196):(u=o[g],u=u*h&$e|u*f&un,u=u<<15|u>>>17,u=u*d&$e|u*p&un,c^=u,c=c<<13|c>>>19,c=c*5+3864292196);switch(a=0,r){case 3:a^=e[s*4+2]<<16;case 2:a^=e[s*4+1]<<8;case 1:a^=e[s*4],a=a*h&$e|a*f&un,a=a<<15|a>>>17,a=a*d&$e|a*p&un,s&1?l^=a:c^=a}this.h1=l,this.h2=c}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&$e|t*36045&un,e=e*4283543511&$e|((e<<16|t>>>16)*2950163797&$e)>>>16,t^=e>>>1,t=t*444984403&$e|t*60499&un,e=e*3301882366&$e|((e<<16|t>>>16)*3120437893&$e)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const va=Object.freeze({map:null,hash:"",transfer:void 0});class fu{#t=!1;#e=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#n.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#n.get(t)}remove(t){const e=this.#n.get(t);if(e!==void 0&&(e instanceof tt&&this.#i.delete(e.annotationElementId),this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#n.values())if(i instanceof tt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#n.get(t);let s=!1;if(i!==void 0)for(const[r,o]of Object.entries(e))i[r]!==o&&(s=!0,i[r]=o);else s=!0,this.#n.set(t,e);s&&this.#r(),e instanceof tt&&((this.#i||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#n.has(t)}get size(){return this.#n.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Pd(this)}get serializable(){if(this.#n.size===0)return va;const t=new Map,e=new Md,i=[],s=Object.create(null);let r=!1;for(const[o,a]of this.#n){const u=a instanceof tt?a.serialize(!1,s):a;a.page&&(a.pageIndex=a.page._pageIndex,delete a.page),u&&(t.set(o,u),e.update(`${o}:${JSON.stringify(u)}`),r||=!!u.bitmap)}if(r)for(const o of t.values())o.bitmap&&i.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:va}get editorStats(){let t=null;const e=new Map;let i=0,s=0;for(const r of this.#n.values()){if(!(r instanceof tt)){r.popup&&(r.popup.deleted?s+=1:i+=1);continue}r.isCommentDeleted?s+=1:r.hasEditedComment&&(i+=1);const o=r.telemetryFinalData;if(!o)continue;const{type:a}=o;e.has(a)||e.set(a,Object.getPrototypeOf(r).constructor),t||=Object.create(null);const u=t[a]||=new Map;for(const[l,c]of Object.entries(o)){if(l==="type")continue;let h=u.get(l);h||(h=new Map,u.set(l,h));const d=h.get(c)??0;h.set(c,d+1)}}if((s>0||i>0)&&(t||=Object.create(null),t.comments={deleted:s,edited:i}),!t)return null;for(const[r,o]of e)t[r]=o.computeTelemetryFinalData(t[r]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const i=this.#i?.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#i?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#i)for(const e of this.#i.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class Pd extends fu{#t;constructor(t){super();const{map:e,hash:i,transfer:s}=t.serializable,r=structuredClone(e,s?{transfer:s}:null);this.#t={map:r,hash:i,transfer:s}}get print(){St("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return ut(this,"modifiedIds",{ids:new Set,hash:""})}}class x2{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Ct(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:r,style:o}=t,a=new FontFace(s,r,o);this.addNativeFontFace(a);try{await a.load(),this.#t.add(s),i?.(t)}catch{at(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}St("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw at(`Failed to load font '${i.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return ut(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return ut(this,"isSyncFontLoadingSupported",_e||Zt.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Ct(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:e,callback:t};return i.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ut(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(_,x){return _.charCodeAt(x)<<24|_.charCodeAt(x+1)<<16|_.charCodeAt(x+2)<<8|_.charCodeAt(x+3)&255}function s(_,x,v,S){const M=_.substring(0,x),R=_.substring(x+v);return M+S+R}let r,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const u=a.getContext("2d");let l=0;function c(_,x){if(++l>30){at("Load test font never loaded."),x();return}if(u.font="30px "+_,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0){x();return}setTimeout(c.bind(null,_,x))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=s(d,976,h.length,h);const p=16,g=1482184792;let b=i(d,p);for(r=0,o=h.length-3;r<o;r+=4)b=b-g+i(h,r)|0;r<h.length&&(b=b-g+i(h+"XXX",r)|0),d=s(d,p,4,n2(b));const m=`url(data:font/opentype;base64,${btoa(d)});`,A=`@font-face {font-family:"${h}";src:${m}}`;this.insertRule(A);const y=this._document.createElement("div");y.style.visibility="hidden",y.style.width=y.style.height="10px",y.style.position="absolute",y.style.top=y.style.left="0px";for(const _ of[t.loadedName,h]){const x=this._document.createElement("span");x.textContent="Hi",x.style.fontFamily=_,y.append(x)}this._document.body.append(y),c(h,()=>{y.remove(),e.complete()})}}class w2{#t;constructor(t,e=null,i,s){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,i&&Object.assign(this,i),s&&(this.charProcOperatorList=s)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let s;try{s=t.get(i)}catch(o){at(`getPathGenerator - ignoring character: "${o}".`)}const r=kd(s?.path);return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=r}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){ut(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){ut(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class Li{#t;#e;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,i={};let s=0;for(const l of Li.strings){const c=e.encode(t[l]);i[l]=c,s+=4+c.length}const r=new ArrayBuffer(s),o=new Uint8Array(r),a=new DataView(r);let u=0;for(const l of Li.strings){const c=i[l],h=c.length;a.setUint32(u,h),o.set(c,u+4),u+=4+h}return Ct(u===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}#n(t){Ct(t<Li.strings.length,"Invalid string index");let e=0;for(let s=0;s<t;s++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class Oi{#t;#e;#i;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,i={};let s=0;for(const d of Oi.strings){const f=e.encode(t[d]);i[d]=f,s+=4+f.length}s+=4;let r,o,a=1+s;t.style&&(r=e.encode(t.style.style),o=e.encode(t.style.weight),a+=4+r.length+4+o.length);const u=new ArrayBuffer(a),l=new Uint8Array(u),c=new DataView(u);let h=0;c.setUint8(h++,t.guessFallback?1:0),c.setUint32(h,0),h+=4,s=0;for(const d of Oi.strings){const f=i[d],p=f.length;s+=4+p,c.setUint32(h,p),l.set(f,h+4),h+=4+p}return c.setUint32(h-s-4,s),t.style&&(c.setUint32(h,r.length),l.set(r,h+4),h+=4+r.length,c.setUint32(h,o.length),l.set(o,h+4),h+=4+o.length),Ct(h<=u.byteLength,"SubstitionInfo.write: Buffer overflow"),u.transferToFixedLength(h)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#n(t){Ct(t<Oi.strings.length,"Invalid string index");let e=5;for(let s=0;s<t;s++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),i=this.#i.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const s=this.#e.getUint32(t),r=this.#i.decode(new Uint8Array(this.#t,t+4,s));return{style:i,weight:r}}}class Mt{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#i=this.#e+1+8;static#n=this.#i+1+48;static#r=this.#n+1+6;#o;#s;#a;constructor({data:t,extra:e}){this.#o=t,this.#s=new TextDecoder,this.#a=new DataView(this.#o),e&&Object.assign(this,e)}#l(t){Ct(t<Mt.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,s=this.#a.getUint8(e)>>i&3;return s===0?void 0:s===2}get black(){return this.#l(0)}get bold(){return this.#l(1)}get disableFontFace(){return this.#l(2)}get fontExtraProperties(){return this.#l(3)}get isInvalidPDFjsFont(){return this.#l(4)}get isType3Font(){return this.#l(5)}get italic(){return this.#l(6)}get missingFile(){return this.#l(7)}get remeasure(){return this.#l(8)}get vertical(){return this.#l(9)}#u(t){return Ct(t<Mt.numbers.length,"Invalid number index"),this.#a.getFloat64(Mt.#t+t*8)}get ascent(){return this.#u(0)}get defaultWidth(){return this.#u(1)}get descent(){return this.#u(2)}get bbox(){let t=Mt.#e;if(this.#a.getUint8(t)===0)return;t+=1;const i=[];for(let s=0;s<4;s++)i.push(this.#a.getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=Mt.#i;if(this.#a.getUint8(t)===0)return;t+=1;const i=[];for(let s=0;s<6;s++)i.push(this.#a.getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=Mt.#n;if(this.#a.getUint8(t)===0)return;t+=1;const i=[];for(let s=0;s<3;s++)i.push(this.#a.getInt16(t,!0)),t+=2;return i}#d(t){Ct(t<Mt.strings.length,"Invalid string index");let e=Mt.#r+4;for(let r=0;r<t;r++)e+=this.#a.getUint32(e)+4;const i=this.#a.getUint32(e),s=new Uint8Array(i);return s.set(new Uint8Array(this.#o,e+4,i)),this.#s.decode(s)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Mt.#r;const e=this.#a.getUint32(t);t+=4+e;const i=this.#a.getUint32(t);t+=4+i;const s=this.#a.getUint32(t);t+=4+s;const r=this.#a.getUint32(t);if(r!==0)return new Uint8Array(this.#o,t+4,r)}clearData(){let t=Mt.#r;const e=this.#a.getUint32(t);t+=4+e;const i=this.#a.getUint32(t);t+=4+i;const s=this.#a.getUint32(t);t+=4+s;const r=this.#a.getUint32(t);new Uint8Array(this.#o,t+4,r).fill(0),this.#a.setUint32(t,0)}get cssFontInfo(){let t=Mt.#r;const e=this.#a.getUint32(t);t+=4+e;const i=this.#a.getUint32(t);t+=4+i;const s=this.#a.getUint32(t);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(this.#o,t+4,s)),new Li(r.buffer)}get systemFontInfo(){let t=Mt.#r;const e=this.#a.getUint32(t);t+=4+e;const i=this.#a.getUint32(t);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(this.#o,t+4,i)),new Oi(s.buffer)}static write(t){const e=t.systemFontInfo?Oi.write(t.systemFontInfo):null,i=t.cssFontInfo?Li.write(t.cssFontInfo):null,s=new TextEncoder,r={};let o=0;for(const g of Mt.strings)r[g]=s.encode(t[g]),o+=4+r[g].length;const a=Mt.#r+4+o+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),u=new ArrayBuffer(a),l=new Uint8Array(u),c=new DataView(u);let h=0;const d=Mt.bools.length;let f=0,p=0;for(let g=0;g<d;g++){const b=t[Mt.bools[g]];f|=(b===void 0?0:b?2:1)<<p,p+=2,(p===8||g===d-1)&&(c.setUint8(h++,f),f=0,p=0)}Ct(h===Mt.#t,"FontInfo.write: Boolean properties offset mismatch");for(const g of Mt.numbers)c.setFloat64(h,t[g]),h+=8;if(Ct(h===Mt.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){c.setUint8(h++,4);for(const g of t.bbox)c.setInt16(h,g,!0),h+=2}else c.setUint8(h++,0),h+=8;if(Ct(h===Mt.#i,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){c.setUint8(h++,6);for(const g of t.fontMatrix)c.setFloat64(h,g,!0),h+=8}else c.setUint8(h++,0),h+=48;if(Ct(h===Mt.#n,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){c.setUint8(h++,1);for(const g of t.defaultVMetrics)c.setInt16(h,g,!0),h+=2}else c.setUint8(h++,0),h+=6;Ct(h===Mt.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),c.setUint32(Mt.#r,0),h+=4;for(const g of Mt.strings){const b=r[g],m=b.length;c.setUint32(h,m),l.set(b,h+4),h+=4+m}if(c.setUint32(Mt.#r,h-Mt.#r-4),!e)c.setUint32(h,0),h+=4;else{const g=e.byteLength;c.setUint32(h,g),Ct(h+4+g<=u.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),l.set(new Uint8Array(e),h+4),h+=4+g}if(!i)c.setUint32(h,0),h+=4;else{const g=i.byteLength;c.setUint32(h,g),Ct(h+4+g<=u.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),l.set(new Uint8Array(i),h+4),h+=4+g}return t.data===void 0?(c.setUint32(h,0),h+=4):(c.setUint32(h,t.data.length),l.set(t.data,h+4),h+=4+t.data.length),Ct(h<=u.byteLength,"FontInfo.write: Buffer overflow"),u.transferToFixedLength(h)}}class ne{static#t=0;static#e=1;static#i=2;static#n=3;static#r=4;static#o=8;static#s=12;static#a=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,i=null,s=[],r=[],o=[],a=[],u=null,l=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,i=t[2],o=t[3],e===1?s.push(...t[4],...t[5]):s.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,u=t[1],s=t[2],r=t[3],a=t[4]||[],i=t[6],l=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const c=Math.floor(s.length/2),h=Math.floor(r.length/3),d=o.length,f=a.length;let p=0;for(const x of a)p+=1,p=Math.ceil(p/4)*4,p+=4+x.coords.length*4,p+=4+x.colors.length*4,x.verticesPerRow!==void 0&&(p+=4);const g=20+c*8+h*3+d*8+(i?16:0)+(l?3:0)+p,b=new ArrayBuffer(g),m=new DataView(b),A=new Uint8Array(b);m.setUint8(ne.#t,e),m.setUint8(ne.#e,i?1:0),m.setUint8(ne.#i,l?1:0),m.setUint8(ne.#n,u),m.setUint32(ne.#r,c,!0),m.setUint32(ne.#o,h,!0),m.setUint32(ne.#s,d,!0),m.setUint32(ne.#a,f,!0);let y=20;new Float32Array(b,y,c*2).set(s),y+=c*8,A.set(r,y),y+=h*3;for(const[x,v]of o)m.setFloat32(y,x,!0),y+=4,m.setUint32(y,parseInt(v.slice(1),16),!0),y+=4;if(i)for(const x of i)m.setFloat32(y,x,!0),y+=4;l&&(A.set(l,y),y+=3);for(let x=0;x<a.length;x++){const v=a[x];m.setUint8(y,v.type),y+=1,y=Math.ceil(y/4)*4,m.setUint32(y,v.coords.length,!0),y+=4,new Int32Array(b,y,v.coords.length).set(v.coords),y+=v.coords.length*4,m.setUint32(y,v.colors.length,!0),y+=4,new Int32Array(b,y,v.colors.length).set(v.colors),y+=v.colors.length*4,v.verticesPerRow!==void 0&&(m.setUint32(y,v.verticesPerRow,!0),y+=4)}return b}getIR(){const t=this.view,e=this.data[ne.#t],i=!!this.data[ne.#e],s=!!this.data[ne.#i],r=t.getUint32(ne.#r,!0),o=t.getUint32(ne.#o,!0),a=t.getUint32(ne.#s,!0),u=t.getUint32(ne.#a,!0);let l=20;const c=new Float32Array(this.buffer,l,r*2);l+=r*8;const h=new Uint8Array(this.buffer,l,o*3);l+=o*3;const d=[];for(let b=0;b<a;++b){const m=t.getFloat32(l,!0);l+=4;const A=t.getUint32(l,!0);l+=4,d.push([m,`#${A.toString(16).padStart(6,"0")}`])}let f=null;if(i){f=[];for(let b=0;b<4;++b)f.push(t.getFloat32(l,!0)),l+=4}let p=null;s&&(p=new Uint8Array(this.buffer,l,3),l+=3);const g=[];for(let b=0;b<u;++b){const m=t.getUint8(l);l+=1,l=Math.ceil(l/4)*4;const A=t.getUint32(l,!0);l+=4;const y=new Int32Array(this.buffer,l,A);l+=A*4;const _=t.getUint32(l,!0);l+=4;const x=new Int32Array(this.buffer,l,_);l+=_*4;const v={type:m,coords:y,colors:x};m===ya.LATTICE&&(v.verticesPerRow=t.getUint32(l,!0),l+=4),g.push(v)}if(e===1)return["RadialAxial","axial",f,d,Array.from(c.slice(0,2)),Array.from(c.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",f,d,[c[0],c[1]],[c[3],c[4]],c[2],c[5]];if(e===3){const b=this.data[ne.#n];let m=null;if(c.length>0){let A=c[0],y=c[0],_=c[1],x=c[1];for(let v=0;v<c.length;v+=2){const S=c[v],M=c[v+1];A=A>S?S:A,_=_>M?M:_,y=y<S?S:y,x=x<M?M:x}m=[A,_,y,x]}return["Mesh",b,c,h,g,m,f,p]}throw new Error(`Unsupported pattern kind: ${e}`)}}class v2{static write(t){let e,i;return Zt.isFloat16ArraySupported?(i=new ArrayBuffer(t.length*2),e=new Float16Array(i)):(i=new ArrayBuffer(t.length*4),e=new Float32Array(i)),e.set(t),i}#t;constructor(t){this.#t=t}get path(){return Zt.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function E2(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(_e)return n;const t=URL.parse(n,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function C2(n){if(_e&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Qr(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function ir(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const Ea=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,S2=n=>typeof n=="object"&&typeof n?.name=="string",T2=a2.bind(null,Ea,S2);class k2{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[s]of this.#t)s.call(this,i)})}addEventListener(t,e,i=null){let s=null;if(i?.signal instanceof AbortSignal){const{signal:r}=i;if(r.aborted){at("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);s=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}this.#t.set(e,s)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const sr={DATA:1,ERROR:2},qt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function nc(){}function Me(n){if(n instanceof Yn||n instanceof Aa||n instanceof Xl||n instanceof Rr||n instanceof jo)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||St('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Yn(n.message);case"InvalidPDFException":return new Aa(n.message);case"PasswordException":return new Xl(n.message,n.code);case"ResponseException":return new Rr(n.message,n.status,n.missing);case"UnknownErrorException":return new jo(n.message,n.details)}return new jo(n.message,n.toString())}class hs{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const i=t.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===sr.DATA)s.resolve(t.data);else if(t.callback===sr.ERROR)s.reject(Me(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,s=t.sourceName,r=this.comObj;Promise.try(e,t.data).then(function(o){r.postMessage({sourceName:i,targetName:s,callback:sr.DATA,callbackId:t.callbackId,data:o})},function(o){r.postMessage({sourceName:i,targetName:s,callback:sr.ERROR,callbackId:t.callbackId,reason:Me(o)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},i)}catch(o){r.reject(o)}return r.promise}sendWithStream(t,e,i,s){const r=this.streamId++,o=this.sourceName,a=this.targetName,u=this.comObj;return new ReadableStream({start:l=>{const c=Promise.withResolvers();return this.streamControllers[r]={controller:l,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:o,targetName:a,action:t,streamId:r,data:e,desiredSize:l.desiredSize},s),c.promise},pull:l=>{const c=Promise.withResolvers();return this.streamControllers[r].pullCall=c,u.postMessage({sourceName:o,targetName:a,stream:qt.PULL,streamId:r,desiredSize:l.desiredSize}),c.promise},cancel:l=>{Ct(l instanceof Error,"cancel must have a valid reason");const c=Promise.withResolvers();return this.streamControllers[r].cancelCall=c,this.streamControllers[r].isClosed=!0,u.postMessage({sourceName:o,targetName:a,stream:qt.CANCEL,streamId:r,reason:Me(l)}),c.promise}},i)}#i(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,r=this.comObj,o=this,a=this.actionHandler[t.action],u={enqueue(l,c=1,h){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=c,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:qt.ENQUEUE,streamId:e,chunk:l},h)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:qt.CLOSE,streamId:e}),delete o.streamSinks[e])},error(l){Ct(l instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:qt.ERROR,streamId:e,reason:Me(l)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[e]=u,Promise.try(a,t.data,u).then(function(){r.postMessage({sourceName:i,targetName:s,stream:qt.START_COMPLETE,streamId:e,success:!0})},function(l){r.postMessage({sourceName:i,targetName:s,stream:qt.START_COMPLETE,streamId:e,reason:Me(l)})})}#n(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,r=this.comObj,o=this.streamControllers[e],a=this.streamSinks[e];switch(t.stream){case qt.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(Me(t.reason));break;case qt.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(Me(t.reason));break;case qt.PULL:if(!a){r.postMessage({sourceName:i,targetName:s,stream:qt.PULL_COMPLETE,streamId:e,success:!0});break}a.desiredSize<=0&&t.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=t.desiredSize,Promise.try(a.onPull||nc).then(function(){r.postMessage({sourceName:i,targetName:s,stream:qt.PULL_COMPLETE,streamId:e,success:!0})},function(l){r.postMessage({sourceName:i,targetName:s,stream:qt.PULL_COMPLETE,streamId:e,reason:Me(l)})});break;case qt.ENQUEUE:if(Ct(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case qt.CLOSE:if(Ct(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#r(o,e);break;case qt.ERROR:Ct(o,"error should have stream controller"),o.controller.error(Me(t.reason)),this.#r(o,e);break;case qt.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(Me(t.reason)),this.#r(o,e);break;case qt.CANCEL:if(!a)break;const u=Me(t.reason);Promise.try(a.onCancel||nc,u).then(function(){r.postMessage({sourceName:i,targetName:s,stream:qt.CANCEL_COMPLETE,streamId:e,success:!0})},function(l){r.postMessage({sourceName:i,targetName:s,stream:qt.CANCEL_COMPLETE,streamId:e,reason:Me(l)})}),a.sinkCapability.reject(u),a.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#r(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class Fd{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){St("Abstract method `_createCanvas` called.")}}class D2 extends Fd{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class Rd{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){St("Abstract method `_fetch` called.")}}class ic extends Rd{async _fetch(t){const e=await Hs(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Qr(e)}}class Id{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,s,r){return"none"}destroy(t=!1){}}class M2 extends Id{#t;#e;#i;#n;#r;#o;#s=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#r=e}get#a(){return this.#e||=new Map}get#l(){return this.#o||=new Map}get#u(){if(!this.#i){const t=this.#r.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#r.createElementNS(Cn,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#i=this.#r.createElementNS(Cn,"defs"),t.append(i),i.append(this.#i),this.#r.body.append(t)}return this.#i}#d(t){if(t.length===1){const u=t[0],l=new Array(256);for(let h=0;h<256;h++)l[h]=u[h]/255;const c=l.join(",");return[c,c,c]}const[e,i,s]=t,r=new Array(256),o=new Array(256),a=new Array(256);for(let u=0;u<256;u++)r[u]=e[u]/255,o[u]=i[u]/255,a[u]=s[u]/255;return[r.join(","),o.join(","),a.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#r.URL;e!==this.#r.baseURI&&(to(e)?at('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Ed(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#a.get(t);if(e)return e;const[i,s,r]=this.#d(t),o=t.length===1?i:`${i}${s}${r}`;if(e=this.#a.get(o),e)return this.#a.set(t,e),e;const a=`g_${this.#n}_transfer_map_${this.#s++}`,u=this.#h(a);this.#a.set(t,u),this.#a.set(o,u);const l=this.#g(a);return this.#p(i,s,r,l),u}addHCMFilter(t,e){const i=`${t}-${e}`,s="base";let r=this.#l.get(s);if(r?.key===i||(r?(r.filter?.remove(),r.key=i,r.url="none",r.filter=null):(r={key:i,url:"none",filter:null},this.#l.set(s,r)),!t||!e))return r.url;const o=this.#A(t);t=X.makeHexColor(...o);const a=this.#A(e);if(e=X.makeHexColor(...a),this.#u.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return r.url;const u=new Array(256);for(let f=0;f<=255;f++){const p=f/255;u[f]=p<=.03928?p/12.92:((p+.055)/1.055)**2.4}const l=u.join(","),c=`g_${this.#n}_hcm_filter`,h=r.filter=this.#g(c);this.#p(l,l,l,h),this.#m(h);const d=(f,p)=>{const g=o[f]/255,b=a[f]/255,m=new Array(p+1);for(let A=0;A<=p;A++)m[A]=g+A/p*(b-g);return m.join(",")};return this.#p(d(0,5),d(1,5),d(2,5),h),r.url=this.#h(c),r.url}addAlphaFilter(t){let e=this.#a.get(t);if(e)return e;const[i]=this.#d([t]),s=`alpha_${i}`;if(e=this.#a.get(s),e)return this.#a.set(t,e),e;const r=`g_${this.#n}_alpha_map_${this.#s++}`,o=this.#h(r);this.#a.set(t,o),this.#a.set(s,o);const a=this.#g(r);return this.#b(i,a),o}addLuminosityFilter(t){let e=this.#a.get(t||"luminosity");if(e)return e;let i,s;if(t?([i]=this.#d([t]),s=`luminosity_${i}`):s="luminosity",e=this.#a.get(s),e)return this.#a.set(t,e),e;const r=`g_${this.#n}_luminosity_map_${this.#s++}`,o=this.#h(r);this.#a.set(t,o),this.#a.set(s,o);const a=this.#g(r);return this.#f(a),t&&this.#b(i,a),o}addHighlightHCMFilter(t,e,i,s,r){const o=`${e}-${i}-${s}-${r}`;let a=this.#l.get(t);if(a?.key===o||(a?(a.filter?.remove(),a.key=o,a.url="none",a.filter=null):(a={key:o,url:"none",filter:null},this.#l.set(t,a)),!e||!i))return a.url;const[u,l]=[e,i].map(this.#A.bind(this));let c=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),h=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),[d,f]=[s,r].map(this.#A.bind(this));h<c&&([c,h,d,f]=[h,c,f,d]),this.#u.style.color="";const p=(m,A,y)=>{const _=new Array(256),x=(h-c)/y,v=m/255,S=(A-m)/(255*y);let M=0;for(let R=0;R<=y;R++){const j=Math.round(c+R*x),I=v+R*S;for(let Y=M;Y<=j;Y++)_[Y]=I;M=j+1}for(let R=M;R<256;R++)_[R]=_[M-1];return _.join(",")},g=`g_${this.#n}_hcm_${t}_filter`,b=a.filter=this.#g(g);return this.#m(b),this.#p(p(d[0],f[0],5),p(d[1],f[1],5),p(d[2],f[2],5),b),a.url=this.#h(g),a.url}destroy(t=!1){t&&this.#o?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#o?.clear(),this.#o=null,this.#s=0)}#f(t){const e=this.#r.createElementNS(Cn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#m(t){const e=this.#r.createElementNS(Cn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#g(t){const e=this.#r.createElementNS(Cn,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#u.append(e),e}#c(t,e,i){const s=this.#r.createElementNS(Cn,e);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),t.append(s)}#p(t,e,i,s){const r=this.#r.createElementNS(Cn,"feComponentTransfer");s.append(r),this.#c(r,"feFuncR",t),this.#c(r,"feFuncG",e),this.#c(r,"feFuncB",i)}#b(t,e){const i=this.#r.createElementNS(Cn,"feComponentTransfer");e.append(i),this.#c(i,"feFuncA",t)}#A(t){return this.#u.style.color=t,$s(getComputedStyle(this.#u).getPropertyValue("color"))}}class Ld{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){St("Abstract method `_fetch` called.")}}class sc extends Ld{async _fetch(t){const e=await Hs(t,"arraybuffer");return new Uint8Array(e)}}class Od{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){St("Abstract method `_fetch` called.")}}class rc extends Od{async _fetch(t){const e=await Hs(t,"arraybuffer");return new Uint8Array(e)}}_e&&at("Please use the `legacy` build in Node.js environments.");async function pu(n){const e=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(e)}class P2 extends Id{}class F2 extends Fd{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class R2 extends Rd{async _fetch(t){return pu(t)}}class I2 extends Ld{async _fetch(t){return pu(t)}}class L2 extends Od{async _fetch(t){return pu(t)}}const yi="__forcedDependency",{floor:oc,ceil:ac}=Math;function rr(n,t,e,i,s,r){n[t*4+0]=Math.min(n[t*4+0],e),n[t*4+1]=Math.min(n[t*4+1],i),n[t*4+2]=Math.max(n[t*4+2],s),n[t*4+3]=Math.max(n[t*4+3],r)}const Ca=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class O2{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Ca}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const or=(n,t)=>{if(!n)return;let e=n.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},n.set(t,e)),e};class N2{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[yi]:[]};#i=new Map;#n=[];#r=[];#o=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#a=new Float64Array([1/0,1/0,-1/0,-1/0]);#l=-1;#u=new Set;#d=new Map;#h=new Map;#f;#m;#g;#c;#p;constructor(t,e,i=!1){this.#f=t.width,this.#m=t.height,this.#b(e),i&&(this.#p=new Map)}growOperationsCount(t){t>=this.#c.length&&this.#b(t,this.#c)}#b(t,e){const i=new ArrayBuffer(t*4);this.#g=new Uint8ClampedArray(i),this.#c=new Uint32Array(i),e&&e.length>0?(this.#c.set(e),this.#c.fill(Ca,e.length)):this.#c.fill(Ca)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[yi]:{__proto__:this.#e[yi]}},this.#s={__proto__:this.#s},this.#n.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const i=this.#n.pop();return i!==void 0&&(or(this.#p,t)?.dependencies.add(i),this.#c[t]=this.#c[i]),this}recordOpenMarker(t){return this.#n.push(t),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(or(this.#p,t)?.dependencies.add(e),this.#c[t]=this.#c[e]),this}beginMarkedContent(t){return this.#r.push(t),this}endMarkedContent(t){const e=this.#r.pop();return e!==void 0&&(or(this.#p,t)?.dependencies.add(e),this.#c[t]=this.#c[e]),this}pushBaseTransform(t){return this.#o.push(X.multiplyByDOMMatrix(this.#o.at(-1),t.getTransform())),this}popBaseTransform(){return this.#o.length>1&&this.#o.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordSimpleDataFromNamed(t,e,i){this.#t[t]=this.#i.get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(yi,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#u)this.recordFutureForcedDependency(yi,t);return this}resetBBox(t){return this.#l!==t&&(this.#l=t,this.#a[0]=1/0,this.#a[1]=1/0,this.#a[2]=-1/0,this.#a[3]=-1/0),this}recordClipBox(t,e,i,s,r,o){const a=X.multiplyByDOMMatrix(this.#o.at(-1),e.getTransform()),u=[1/0,1/0,-1/0,-1/0];X.axialAlignedBoundingBox([i,r,s,o],a,u);const l=X.intersect(this.#s,u);return l?(this.#s[0]=l[0],this.#s[1]=l[1],this.#s[2]=l[2],this.#s[3]=l[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,e,i,s,r,o){const a=this.#s;if(a[0]===1/0)return this;const u=X.multiplyByDOMMatrix(this.#o.at(-1),e.getTransform());if(a[0]===-1/0)return X.axialAlignedBoundingBox([i,r,s,o],u,this.#a),this;const l=[1/0,1/0,-1/0,-1/0];return X.axialAlignedBoundingBox([i,r,s,o],u,l),this.#a[0]=Math.min(this.#a[0],Math.max(l[0],a[0])),this.#a[1]=Math.min(this.#a[1],Math.max(l[1],a[1])),this.#a[2]=Math.max(this.#a[2],Math.min(l[2],a[2])),this.#a[3]=Math.max(this.#a[3],Math.min(l[3],a[3])),this}recordCharacterBBox(t,e,i,s=1,r=0,o=0,a){const u=i.bbox;let l,c;if(u&&(l=u[2]!==u[0]&&u[3]!==u[1]&&this.#h.get(i),l!==!1&&(c=[0,0,0,0],X.axialAlignedBoundingBox(u,i.fontMatrix,c),(s!==1||r!==0||o!==0)&&X.scaleMinMax([s,0,0,-s,r,o],c),l)))return this.recordBBox(t,e,c[0],c[2],c[1],c[3]);if(!a)return this.recordFullPageBBox(t);const h=a();return u&&c&&l===void 0&&(l=c[0]<=r-h.actualBoundingBoxLeft&&c[2]>=r+h.actualBoundingBoxRight&&c[1]<=o-h.actualBoundingBoxAscent&&c[3]>=o+h.actualBoundingBoxDescent,this.#h.set(i,l),l)?this.recordBBox(t,e,c[0],c[2],c[1],c[3]):this.recordBBox(t,e,r-h.actualBoundingBoxLeft,r+h.actualBoundingBoxRight,o-h.actualBoundingBoxAscent,o+h.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#a[0]=Math.max(0,this.#s[0]),this.#a[1]=Math.max(0,this.#s[1]),this.#a[2]=Math.min(this.#f,this.#s[2]),this.#a[3]=Math.min(this.#m,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#u,s=this.#t,r=this.#e;for(const o of e)o in this.#t?i.add(s[o]):o in r&&r[o].forEach(i.add,i);return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#u.add(this.#i.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[yi]),this.#p){const i=or(this.#p,t),{dependencies:s}=i;this.#u.forEach(s.add,s),this.#n.forEach(s.add,s),this.#r.forEach(s.add,s),s.delete(t),i.isRenderingOperation=!0}if(this.#l===t){const i=oc(this.#a[0]*256/this.#f),s=oc(this.#a[1]*256/this.#m),r=ac(this.#a[2]*256/this.#f),o=ac(this.#a[3]*256/this.#m);rr(this.#g,t,i,s,r,o);for(const a of this.#u)a!==t&&rr(this.#g,a,i,s,r,o);for(const a of this.#n)a!==t&&rr(this.#g,a,i,s,r,o);for(const a of this.#r)a!==t&&rr(this.#g,a,i,s,r,o);e||(this.#u.clear(),this.#l=-1)}return this}recordShowTextOperation(t,e=!1){const i=Array.from(this.#u);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const s of i)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#l===t&&(this.#l=-1,this.#s[0]=Math.max(this.#s[0],this.#a[0]),this.#s[1]=Math.max(this.#s[1],this.#a[1]),this.#s[2]=Math.min(this.#s[2],this.#a[2]),this.#s[3]=Math.min(this.#s[3],this.#a[3]),e||this.#u.clear()),this}_takePendingDependencies(){const t=this.#u;return this.#u=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#u.add(e)}take(){return this.#h.clear(),new O2(this.#c,this.#g)}takeDebugMetadata(){return this.#p}}class Ir{#t;#e;#i;#n=0;#r=0;constructor(t,e,i){if(t instanceof Ir&&t.#i===!!i)return t;this.#t=t,this.#e=e,this.#i=!!i}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#i||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,i,s,r,o){return this.#i||this.#t.recordClipBox(this.#e,e,i,s,r,o),this}recordBBox(t,e,i,s,r,o){return this.#i||this.#t.recordBBox(this.#e,e,i,s,r,o),this}recordCharacterBBox(t,e,i,s,r,o,a){return this.#i||this.#t.recordCharacterBBox(this.#e,e,i,s,r,o,a),this}recordFullPageBBox(t){return this.#i||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#i||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const je={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},le={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Sa(n,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,i),n.clip(s)}class gu{isModifyingCurrentTransform(){return!1}getPattern(){St("Abstract method `getPattern` called.")}}class B2 extends gu{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let i,s=this._p0,r=this._p1;if(e&&(s=s.slice(),r=r.slice(),X.applyTransform(s,e),X.applyTransform(r,e)),this._type==="axial")i=t.createLinearGradient(s[0],s[1],r[0],r[1]);else if(this._type==="radial"){let o=this._r0,a=this._r1;if(e){const u=new Float32Array(2);X.singularValueDecompose2dScale(e,u),o*=u[0],a*=u[0]}i=t.createRadialGradient(s[0],s[1],o,r[0],r[1],a)}for(const o of this._colorStops)i.addColorStop(o[0],o[1]);return i}getPattern(t,e,i,s){let r;if(s===le.STROKE||s===le.FILL){if(this.isOriginBased()){let d=X.transform(i,e.baseTransform);this.matrix&&(d=X.transform(d,this.matrix));const f=.001,p=Math.hypot(d[0],d[1]),g=Math.hypot(d[2],d[3]),b=(d[0]*d[2]+d[1]*d[3])/(p*g);if(Math.abs(b)<f)if(this.isRadial()){if(Math.abs(p-g)<f)return this._createGradient(t,d)}else return this._createGradient(t,d)}const o=e.current.getClippedPathBoundingBox(s,Ht(t))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,u=Math.ceil(o[3]-o[1])||1,l=e.cachedCanvases.getCanvas("pattern",a,u),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-o[0],-o[1]),i=X.transform(i,[1,0,0,1,o[0],o[1]]),c.transform(...e.baseTransform),this.matrix&&c.transform(...this.matrix),Sa(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),r=t.createPattern(l.canvas,"no-repeat");const h=new DOMMatrix(i);r.setTransform(h)}else Sa(t,this._bbox),r=this._createGradient(t);return r}}function Wo(n,t,e,i,s,r,o,a){const u=t.coords,l=t.colors,c=n.data,h=n.width*4;let d;u[e+1]>u[i+1]&&(d=e,e=i,i=d,d=r,r=o,o=d),u[i+1]>u[s+1]&&(d=i,i=s,s=d,d=o,o=a,a=d),u[e+1]>u[i+1]&&(d=e,e=i,i=d,d=r,r=o,o=d);const f=(u[e]+t.offsetX)*t.scaleX,p=(u[e+1]+t.offsetY)*t.scaleY,g=(u[i]+t.offsetX)*t.scaleX,b=(u[i+1]+t.offsetY)*t.scaleY,m=(u[s]+t.offsetX)*t.scaleX,A=(u[s+1]+t.offsetY)*t.scaleY;if(p>=A)return;const y=l[r],_=l[r+1],x=l[r+2],v=l[o],S=l[o+1],M=l[o+2],R=l[a],j=l[a+1],I=l[a+2],Y=Math.round(p),dt=Math.round(A);let et,mt,U,O,q,At,Ot,T;for(let D=Y;D<=dt;D++){if(D<b){const nt=D<p?0:(p-D)/(p-b);et=f-(f-g)*nt,mt=y-(y-v)*nt,U=_-(_-S)*nt,O=x-(x-M)*nt}else{let nt;D>A?nt=1:b===A?nt=0:nt=(b-D)/(b-A),et=g-(g-m)*nt,mt=v-(v-R)*nt,U=S-(S-j)*nt,O=M-(M-I)*nt}let B;D<p?B=0:D>A?B=1:B=(p-D)/(p-A),q=f-(f-m)*B,At=y-(y-R)*B,Ot=_-(_-j)*B,T=x-(x-I)*B;const rt=Math.round(Math.min(et,q)),W=Math.round(Math.max(et,q));let ot=h*D+rt*4;for(let nt=rt;nt<=W;nt++)B=(et-nt)/(et-q),B<0?B=0:B>1&&(B=1),c[ot++]=mt-(mt-At)*B|0,c[ot++]=U-(U-Ot)*B|0,c[ot++]=O-(O-T)*B|0,c[ot++]=255}}function U2(n,t,e){const i=t.coords,s=t.colors;let r,o;switch(t.type){case ya.LATTICE:const a=t.verticesPerRow,u=Math.floor(i.length/a)-1,l=a-1;for(r=0;r<u;r++){let c=r*a;for(let h=0;h<l;h++,c++)Wo(n,e,i[c],i[c+1],i[c+a],s[c],s[c+1],s[c+a]),Wo(n,e,i[c+a+1],i[c+1],i[c+a],s[c+a+1],s[c+1],s[c+a])}break;case ya.TRIANGLES:for(r=0,o=i.length;r<o;r+=3)Wo(n,e,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class H2 extends gu{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const a=Math.floor(this._bounds[0]),u=Math.floor(this._bounds[1]),l=Math.ceil(this._bounds[2])-a,c=Math.ceil(this._bounds[3])-u,h=Math.min(Math.ceil(Math.abs(l*t[0]*1.1)),3e3),d=Math.min(Math.ceil(Math.abs(c*t[1]*1.1)),3e3),f=l/h,p=c/d,g={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-u,scaleX:1/f,scaleY:1/p},b=h+4,m=d+4,A=i.getCanvas("mesh",b,m),y=A.context,_=y.createImageData(h,d);if(e){const v=_.data;for(let S=0,M=v.length;S<M;S+=4)v[S]=e[0],v[S+1]=e[1],v[S+2]=e[2],v[S+3]=255}for(const v of this._figures)U2(_,v,g);return y.putImageData(_,2,2),{canvas:A.canvas,offsetX:a-2*f,offsetY:u-2*p,scaleX:f,scaleY:p}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,s){Sa(t,this._bbox);const r=new Float32Array(2);if(s===le.SHADING)X.singularValueDecompose2dScale(Ht(t),r);else if(this.matrix){X.singularValueDecompose2dScale(this.matrix,r);const[a,u]=r;X.singularValueDecompose2dScale(e.baseTransform,r),r[0]*=a,r[1]*=u}else X.singularValueDecompose2dScale(e.baseTransform,r);const o=this._createMeshCanvas(r,s===le.SHADING?null:this._background,e.cachedCanvases);return s!==le.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class z2 extends gu{getPattern(){return"hotpink"}}function $2(n){switch(n[0]){case"RadialAxial":return new B2(n);case"Mesh":return new H2(n);case"Dummy":return new z2}throw new Error(`Unknown IR type: ${n[0]}`)}const uc={COLORED:1,UNCOLORED:2};class mu{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,s){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(t,e){const{bbox:i,operatorList:s,paintType:r,tilingType:o,color:a,canvasGraphicsFactory:u}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),Jr("TilingType: "+o);const h=i[0],d=i[1],f=i[2],p=i[3],g=f-h,b=p-d,m=new Float32Array(2);X.singularValueDecompose2dScale(this.matrix,m);const[A,y]=m;X.singularValueDecompose2dScale(this.baseTransform,m);const _=A*m[0],x=y*m[1];let v=g,S=b,M=!1,R=!1;const j=Math.ceil(l*_),I=Math.ceil(c*x),Y=Math.ceil(g*_),dt=Math.ceil(b*x);j>=Y?v=l:M=!0,I>=dt?S=c:R=!0;const et=this.getSizeAndScale(v,this.ctx.canvas.width,_),mt=this.getSizeAndScale(S,this.ctx.canvas.height,x),U=t.cachedCanvases.getCanvas("pattern",et.size,mt.size),O=U.context,q=u.createCanvasGraphics(O,e);if(q.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(q,r,a),O.translate(-et.scale*h,-mt.scale*d),q.transform(0,et.scale,0,0,mt.scale,0,0),O.save(),q.dependencyTracker?.save(),this.clipBbox(q,h,d,f,p),q.baseTransform=Ht(q.ctx),q.executeOperatorList(s),q.endDrawing(),q.dependencyTracker?.restore(),O.restore(),M||R){const At=U.canvas;M&&(v=l),R&&(S=c);const Ot=this.getSizeAndScale(v,this.ctx.canvas.width,_),T=this.getSizeAndScale(S,this.ctx.canvas.height,x),D=Ot.size,B=T.size,rt=t.cachedCanvases.getCanvas("pattern-workaround",D,B),W=rt.context,ot=M?Math.floor(g/l):0,nt=R?Math.floor(b/c):0;for(let Ft=0;Ft<=ot;Ft++)for(let $t=0;$t<=nt;$t++)W.drawImage(At,D*Ft,B*$t,D,B,0,0,D,B);return{canvas:rt.canvas,scaleX:Ot.scale,scaleY:T.scale,offsetX:h,offsetY:d}}return{canvas:U.canvas,scaleX:et.scale,scaleY:mt.scale,offsetX:h,offsetY:d}}getSizeAndScale(t,e,i){const s=Math.max(mu.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*i);return r>=s?r=s:i=r/t,{scale:i,size:r}}clipBbox(t,e,i,s,r){const o=s-e,a=r-i;t.ctx.rect(e,i,o,a),X.axialAlignedBoundingBox([e,i,s,r],Ht(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const s=t.ctx,r=t.current;switch(e){case uc.COLORED:const{fillStyle:o,strokeStyle:a}=this.ctx;s.fillStyle=r.fillColor=o,s.strokeStyle=r.strokeColor=a;break;case uc.UNCOLORED:s.fillStyle=s.strokeStyle=i,r.fillColor=r.strokeColor=i;break;default:throw new t2(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,s,r){let o=i;s!==le.SHADING&&(o=X.transform(o,e.baseTransform),this.matrix&&(o=X.transform(o,this.matrix)));const a=this.createPatternCanvas(e,r);let u=new DOMMatrix(o);u=u.translate(a.offsetX,a.offsetY),u=u.scale(1/a.scaleX,1/a.scaleY);const l=t.createPattern(a.canvas,"repeat");return l.setTransform(u),l}}function j2({src:n,srcPos:t=0,dest:e,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const a=Zt.isLittleEndian?4278190080:255,[u,l]=o?[r,a]:[a,r],c=i>>3,h=i&7,d=n.length;e=new Uint32Array(e.buffer);let f=0;for(let p=0;p<s;p++){for(const b=t+c;t<b;t++){const m=t<d?n[t]:255;e[f++]=m&128?l:u,e[f++]=m&64?l:u,e[f++]=m&32?l:u,e[f++]=m&16?l:u,e[f++]=m&8?l:u,e[f++]=m&4?l:u,e[f++]=m&2?l:u,e[f++]=m&1?l:u}if(h===0)continue;const g=t<d?n[t++]:255;for(let b=0;b<h;b++)e[f++]=g&1<<7-b?l:u}return{srcPos:t,destPos:f}}const lc=16,cc=100,G2=15,hc=10,Fe=16,qo=new DOMMatrix,Be=new Float32Array(2),Si=new Float32Array([1/0,1/0,-1/0,-1/0]);function V2(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},n.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},n.transform=function(e,i,s,r,o,a){t.transform(e,i,s,r,o,a),this.__originalTransform(e,i,s,r,o,a)},n.setTransform=function(e,i,s,r,o,a){t.setTransform(e,i,s,r,o,a),this.__originalSetTransform(e,i,s,r,o,a)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(e){t.rotate(e),this.__originalRotate(e)},n.clip=function(e){t.clip(e),this.__originalClip(e)},n.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},n.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},n.bezierCurveTo=function(e,i,s,r,o,a){t.bezierCurveTo(e,i,s,r,o,a),this.__originalBezierCurveTo(e,i,s,r,o,a)},n.rect=function(e,i,s,r){t.rect(e,i,s,r),this.__originalRect(e,i,s,r)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class W2{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,i)):(s=this.canvasFactory.create(e,i),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function ar(n,t,e,i,s,r,o,a,u,l){const[c,h,d,f,p,g]=Ht(n);if(h===0&&d===0){const A=o*c+p,y=Math.round(A),_=a*f+g,x=Math.round(_),v=(o+u)*c+p,S=Math.abs(Math.round(v)-y)||1,M=(a+l)*f+g,R=Math.abs(Math.round(M)-x)||1;return n.setTransform(Math.sign(c),0,0,Math.sign(f),y,x),n.drawImage(t,e,i,s,r,0,0,S,R),n.setTransform(c,h,d,f,p,g),[S,R]}if(c===0&&f===0){const A=a*d+p,y=Math.round(A),_=o*h+g,x=Math.round(_),v=(a+l)*d+p,S=Math.abs(Math.round(v)-y)||1,M=(o+u)*h+g,R=Math.abs(Math.round(M)-x)||1;return n.setTransform(0,Math.sign(h),Math.sign(d),0,y,x),n.drawImage(t,e,i,s,r,0,0,R,S),n.setTransform(c,h,d,f,p,g),[R,S]}n.drawImage(t,e,i,s,r,o,a,u,l);const b=Math.hypot(c,h),m=Math.hypot(d,f);return[b*u,m*l]}class dc{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=ba;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Kt.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Si.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=le.FILL,e=null){const i=this.minMax.slice();if(t===le.STROKE){e||St("Stroke bounding box must include transform."),X.singularValueDecompose2dScale(e,Be);const s=Be[0]*this.lineWidth/2,r=Be[1]*this.lineWidth/2;i[0]-=s,i[1]-=r,i[2]+=s,i[3]+=r}return i}updateClipFromPath(){const t=X.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Si,0)}getClippedPathBoundingBox(t=le.FILL,e=null){return X.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function fc(n,t){if(t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,i=t.width,s=e%Fe,r=(e-s)/Fe,o=s===0?r:r+1,a=n.createImageData(i,Fe);let u=0,l;const c=t.data,h=a.data;let d,f,p,g;if(t.kind===yr.GRAYSCALE_1BPP){const b=c.byteLength,m=new Uint32Array(h.buffer,0,h.byteLength>>2),A=m.length,y=i+7>>3,_=4294967295,x=Zt.isLittleEndian?4278190080:255;for(d=0;d<o;d++){for(p=d<r?Fe:s,l=0,f=0;f<p;f++){const v=b-u;let S=0;const M=v>y?i:v*8-7,R=M&-8;let j=0,I=0;for(;S<R;S+=8)I=c[u++],m[l++]=I&128?_:x,m[l++]=I&64?_:x,m[l++]=I&32?_:x,m[l++]=I&16?_:x,m[l++]=I&8?_:x,m[l++]=I&4?_:x,m[l++]=I&2?_:x,m[l++]=I&1?_:x;for(;S<M;S++)j===0&&(I=c[u++],j=128),m[l++]=I&j?_:x,j>>=1}for(;l<A;)m[l++]=0;n.putImageData(a,0,d*Fe)}}else if(t.kind===yr.RGBA_32BPP){for(f=0,g=i*Fe*4,d=0;d<r;d++)h.set(c.subarray(u,u+g)),u+=g,n.putImageData(a,0,f),f+=Fe;d<o&&(g=i*s*4,h.set(c.subarray(u,u+g)),n.putImageData(a,0,f))}else if(t.kind===yr.RGB_24BPP)for(p=Fe,g=i*p,d=0;d<o;d++){for(d>=r&&(p=s,g=i*p),l=0,f=g;f--;)h[l++]=c[u++],h[l++]=c[u++],h[l++]=c[u++],h[l++]=255;n.putImageData(a,0,d*Fe)}else throw new Error(`bad image kind: ${t.kind}`)}function pc(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,s=e%Fe,r=(e-s)/Fe,o=s===0?r:r+1,a=n.createImageData(i,Fe);let u=0;const l=t.data,c=a.data;for(let h=0;h<o;h++){const d=h<r?Fe:s;({srcPos:u}=j2({src:l,srcPos:u,dest:c,width:i,height:d,nonBlackColor:0})),n.putImageData(a,0,h*Fe)}}function rs(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)n[i]!==void 0&&(t[i]=n[i]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function ur(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}function gc(n,t){if(t)return!0;X.singularValueDecompose2dScale(n,Be);const e=Math.fround(bn.pixelRatio*ji.PDF_TO_CSS_UNITS);return Be[0]<=e&&Be[1]<=e}const q2=["butt","round","square"],X2=["miter","round","bevel"],Y2={},mc={};class Ni{constructor(t,e,i,s,r,{optionalContentConfig:o,markedContentStack:a=null},u,l,c){this.ctx=t,this.current=new dc(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new W2(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=u,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=l,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=c??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,i){const u=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=u.canvas,this.ctx=u.context,this.ctx.save(),this.ctx.transform(...Ht(this.compositeCtx))}this.ctx.save(),ur(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Ht(this.ctx)}executeOperatorList(t,e,i,s,r){const o=t.argsArray,a=t.fnArray;let u=e||0;const l=o.length;if(l===u)return u;const c=l-u>hc&&typeof i=="function",h=c?Date.now()+G2:0;let d=0;const f=this.commonObjs,p=this.objs;let g,b;for(;;){if(s!==void 0&&u===s.nextBreakPoint)return s.breakIt(u,i),u;if(!r||r(u))if(g=a[u],b=o[u]??null,g!==Ps.dependency)b===null?this[g](u):this[g](u,...b);else for(const m of b){this.dependencyTracker?.recordNamedData(m,u);const A=m.startsWith("g_")?f:p;if(!A.has(m))return A.get(m,i),u}if(u++,u===l)return u;if(c&&++d>hc){if(Date.now()>h)return i(),u;d=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,s=t.height??t.displayHeight;let r=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),a=i,u=s,l="prescale1",c,h;for(;r>2&&a>1||o>2&&u>1;){let d=a,f=u;r>2&&a>1&&(d=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),r/=a/d),o>2&&u>1&&(f=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u)/2,o/=u/f),c=this.cachedCanvases.getCanvas(l,d,f),h=c.context,h.clearRect(0,0,d,f),h.drawImage(t,0,0,a,u,0,0,d,f),t=c.canvas,a=d,u=f,l=l==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:a,paintHeight:u}}_createMaskCanvas(t,e){const i=this.ctx,{width:s,height:r}=e,o=this.current.fillColor,a=this.current.patternFill,u=Ht(i);let l,c,h,d;if((e.bitmap||e.data)&&e.count>1){const j=e.bitmap||e.data.buffer;c=JSON.stringify(a?u:[u.slice(0,4),o]),l=this._cachedBitmapsMap.get(j),l||(l=new Map,this._cachedBitmapsMap.set(j,l));const I=l.get(c);if(I&&!a){const Y=Math.round(Math.min(u[0],u[2])+u[4]),dt=Math.round(Math.min(u[1],u[3])+u[5]);return this.dependencyTracker?.recordDependencies(t,je.transformAndFill),{canvas:I,offsetX:Y,offsetY:dt}}h=I}h||(d=this.cachedCanvases.getCanvas("maskCanvas",s,r),pc(d.context,e));let f=X.transform(u,[1/s,0,0,-1/r,0,0]);f=X.transform(f,[1,0,0,1,0,-r]);const p=Si.slice();X.axialAlignedBoundingBox([0,0,s,r],f,p);const[g,b,m,A]=p,y=Math.round(m-g)||1,_=Math.round(A-b)||1,x=this.cachedCanvases.getCanvas("fillCanvas",y,_),v=x.context,S=g,M=b;v.translate(-S,-M),v.transform(...f),h||(h=this._scaleImage(d.canvas,an(v)),h=h.img,l&&a&&l.set(c,h)),v.imageSmoothingEnabled=gc(Ht(v),e.interpolate),ar(v,h,0,0,h.width,h.height,0,0,s,r),v.globalCompositeOperation="source-in";const R=X.transform(an(v),[1,0,0,1,-S,-M]);return v.fillStyle=a?o.getPattern(i,this,R,le.FILL,t):o,v.fillRect(0,0,s,r),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,x.canvas)),this.dependencyTracker?.recordDependencies(t,je.transformAndFill),{canvas:x.canvas,offsetX:Math.round(S),offsetY:Math.round(M)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=q2[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=X2[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,s]of e)switch(i){case"LW":this.setLineWidth(t,s);break;case"LC":this.setLineCap(t,s);break;case"LJ":this.setLineJoin(t,s);break;case"ML":this.setMiterLimit(t,s);break;case"D":this.setDash(t,s[0],s[1]);break;case"RI":this.setRenderingIntent(t,s);break;case"FL":this.setFlatness(t,s);break;case"Font":this.setFont(t,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(s,e,i);this.suspendedCtx=this.ctx;const o=this.ctx=r.context;o.setTransform(this.suspendedCtx.getTransform()),rs(this.suspendedCtx,o),V2(o,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),rs(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,s){const r=s[0],o=s[1],a=s[2]-r,u=s[3]-o;a===0||u===0||(this.genericComposeSMask(e.context,i,a,u,e.subtype,e.backdrop,e.transferMap,r,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,s,r,o,a,u,l,c,h){let d=t.canvas,f=u-c,p=l-h;if(o)if(f<0||p<0||f+i>d.width||p+s>d.height){const b=this.cachedCanvases.getCanvas("maskExtension",i,s),m=b.context;m.drawImage(d,-f,-p),m.globalCompositeOperation="destination-atop",m.fillStyle=o,m.fillRect(0,0,i,s),m.globalCompositeOperation="source-over",d=b.canvas,f=p=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(f,p,i,s),t.clip(b),t.globalCompositeOperation="destination-atop",t.fillStyle=o,t.fillRect(f,p,i,s),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&a?e.filter=this.filterFactory.addAlphaFilter(a):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(a));const g=new Path2D;g.rect(u,l,i,s),e.clip(g),e.globalCompositeOperation="destination-in",e.drawImage(d,f,p,i,s,u,l,i,s),e.restore()}save(t){this.inSMaskMode&&rs(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&rs(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,s,r,o,a){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,s,r,o,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,s){let[r]=i;if(!s){r||=i[0]=new Path2D,this[e](t,r);return}if(this.dependencyTracker!==null){const o=e===Ps.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,s[0]-o,s[2]+o,s[1]-o,s[3]+o).recordDependencies(t,["transform"])}r instanceof Path2D||(r=i[0]=kd(r)),X.axialAlignedBoundingBox(s,Ht(this.ctx),this.current.minMax),this[e](t,r),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const s=this.ctx,r=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&r?.getPattern){const o=r.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=r.getPattern(s,this,an(s),le.STROKE,t),o){const a=new Path2D;a.addPath(e,s.getTransform().invertSelf().multiplySelf(o)),e=a}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,je.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(le.STROKE,Ht(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const s=this.ctx,r=this.current.fillColor,o=this.current.patternFill;let a=!1;if(o){const l=r.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(t),s.save(),s.fillStyle=r.getPattern(s,this,an(s),le.FILL,t),l){const c=new Path2D;c.addPath(e,s.getTransform().invertSelf().multiplySelf(l)),e=c}a=!0}const u=this.current.getClippedPathBoundingBox();this.contentVisible&&u!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),this.dependencyTracker?.recordDependencies(t,je.fill),a&&(s.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,u)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,je.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Y2}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=mc}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;e!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",t),s.recordCloseMarker(t)}if(e!==void 0){const s=new Path2D,r=i.getTransform().invertSelf();for(const{transform:o,x:a,y:u,fontSize:l,path:c}of e)c&&s.addPath(c,new DOMMatrix(o).preMultiplySelf(r).translate(a,u).scale(l,-l));i.clip(s)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const s=this.commonObjs.get(e),r=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=s.fontMatrix||ba,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&at("Invalid font matrix for font "+e),i<0?(i=-i,r.fontDirection=-1):r.fontDirection=1,this.current.font=s,this.current.fontSize=i,s.isType3Font)return;const o=s.loadedName||"sans-serif",a=s.systemFontInfo?.css||`"${o}", ${s.fallbackName}`;let u="normal";s.black?u="900":s.bold&&(u="bold");const l=s.italic?"italic":"normal";let c=i;i<lc?c=lc:i>cc&&(c=cc),this.current.fontSizeScale=i/c,this.ctx.font=`${l} ${u} ${c}px ${a}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,i){const s=new Path2D;return s.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),s}paintChar(t,e,i,s,r,o){const a=this.ctx,u=this.current,l=u.font,c=u.textRenderingMode,h=u.fontSize/u.fontSizeScale,d=c&Kt.FILL_STROKE_MASK,f=!!(c&Kt.ADD_TO_PATH_FLAG),p=u.patternFill&&!l.missingFile,g=u.patternStroke&&!l.missingFile;let b;if((l.disableFontFace||f||p||g)&&!l.missingFile&&(b=l.getPathGenerator(this.commonObjs,e)),b&&(l.disableFontFace||p||g)){a.save(),a.translate(i,s),a.scale(h,-h),this.dependencyTracker?.recordCharacterBBox(t,a,l);let m;if(d===Kt.FILL||d===Kt.FILL_STROKE)if(r){m=a.getTransform(),a.setTransform(...r);const A=this.#i(b,m,r);a.fill(A)}else a.fill(b);if(d===Kt.STROKE||d===Kt.FILL_STROKE)if(o){m||=a.getTransform(),a.setTransform(...o);const{a:A,b:y,c:_,d:x}=m,v=X.inverseTransform(o),S=X.transform([A,y,_,x,0,0],v);X.singularValueDecompose2dScale(S,Be),a.lineWidth*=Math.max(Be[0],Be[1])/h,a.stroke(this.#i(b,m,o))}else a.lineWidth/=h,a.stroke(b);a.restore()}else(d===Kt.FILL||d===Kt.FILL_STROKE)&&(a.fillText(e,i,s),this.dependencyTracker?.recordCharacterBBox(t,a,l,h,i,s,()=>a.measureText(e))),(d===Kt.STROKE||d===Kt.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,a,l,h,i,s,()=>a.measureText(e)).recordDependencies(t,je.stroke),a.strokeText(e,i,s));f&&((this.pendingTextPaths||=[]).push({transform:Ht(a),x:i,y:s,fontSize:h,path:b}),this.dependencyTracker?.recordCharacterBBox(t,a,l,h,i,s))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){i=!0;break}return ut(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,je.showText).resetBBox(t),this.current.textRenderingMode&Kt.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,s=i.font;if(s.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const r=i.fontSize;if(r===0){this.dependencyTracker?.recordOperation(t);return}const o=this.ctx,a=i.fontSizeScale,u=i.charSpacing,l=i.wordSpacing,c=i.fontDirection,h=i.textHScale*c,d=e.length,f=s.vertical,p=f?1:-1,g=s.defaultVMetrics,b=r*i.fontMatrix[0],m=i.textRenderingMode===Kt.FILL&&!s.disableFontFace&&!i.patternFill;o.save(),i.textMatrix&&o.transform(...i.textMatrix),o.translate(i.x,i.y+i.textRise),c>0?o.scale(h,-1):o.scale(h,1);let A,y;const _=i.textRenderingMode&Kt.FILL_STROKE_MASK,x=_===Kt.FILL||_===Kt.FILL_STROKE,v=_===Kt.STROKE||_===Kt.FILL_STROKE;if(x&&i.patternFill){o.save();const I=i.fillColor.getPattern(o,this,an(o),le.FILL,t);A=Ht(o),o.restore(),o.fillStyle=I}if(v&&i.patternStroke){o.save();const I=i.strokeColor.getPattern(o,this,an(o),le.STROKE,t);y=Ht(o),o.restore(),o.strokeStyle=I}let S=i.lineWidth;const M=i.textMatrixScale;if(M===0||S===0?v&&(S=this.getSinglePixelWidth()):S/=M,a!==1&&(o.scale(a,a),S/=a),o.lineWidth=S,s.isInvalidPDFjsFont){const I=[];let Y=0;for(const et of e)I.push(et.unicode),Y+=et.width;const dt=I.join("");if(o.fillText(dt,0,0),this.dependencyTracker!==null){const et=o.measureText(dt);this.dependencyTracker.recordBBox(t,this.ctx,-et.actualBoundingBoxLeft,et.actualBoundingBoxRight,-et.actualBoundingBoxAscent,et.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=Y*b*h,o.restore(),this.compose();return}let R=0,j;for(j=0;j<d;++j){const I=e[j];if(typeof I=="number"){R+=p*I*r/1e3;continue}let Y=!1;const dt=(I.isSpace?l:0)+u,et=I.fontChar,mt=I.accent;let U,O,q=I.width;if(f){const T=I.vmetric||g,D=-(I.vmetric?T[1]:q*.5)*b,B=T[2]*b;q=T?-T[0]:q,U=D/a,O=(R+B)/a}else U=R/a,O=0;let At;if(s.remeasure&&q>0){At=o.measureText(et);const T=At.width*1e3/r*a;if(q<T&&this.isFontSubpixelAAEnabled){const D=q/T;Y=!0,o.save(),o.scale(D,1),U/=D}else q!==T&&(U+=(q-T)/2e3*r/a)}if(this.contentVisible&&(I.isInFont||s.missingFile)){if(m&&!mt)o.fillText(et,U,O),this.dependencyTracker?.recordCharacterBBox(t,o,At?{bbox:null}:s,r/a,U,O,()=>At??o.measureText(et));else if(this.paintChar(t,et,U,O,A,y),mt){const T=U+r*mt.offset.x/a,D=O-r*mt.offset.y/a;this.paintChar(t,mt.fontChar,T,D,A,y)}}const Ot=f?q*b-dt*c:q*b+dt*c;R+=Ot,Y&&o.restore()}f?i.y-=R:i.x+=R*h,o.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,s=this.current,r=s.font,o=s.fontSize,a=s.fontDirection,u=r.vertical?1:-1,l=s.charSpacing,c=s.wordSpacing,h=s.textHScale*a,d=s.fontMatrix||ba,f=e.length,p=s.textRenderingMode===Kt.INVISIBLE;let g,b,m,A;if(p||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),s.textMatrix&&i.transform(...s.textMatrix),i.translate(s.x,s.y+s.textRise),i.scale(h,a);const y=this.dependencyTracker;for(this.dependencyTracker=y?new Ir(y,t):null,g=0;g<f;++g){if(b=e[g],typeof b=="number"){A=u*b*o/1e3,this.ctx.translate(A,0),s.x+=A*h;continue}const _=(b.isSpace?c:0)+l,x=r.charProcOperatorList[b.operatorListId];x?this.contentVisible&&(this.save(),i.scale(o,o),i.transform(...d),this.executeOperatorList(x),this.restore()):at(`Type3 character "${b.operatorListId}" is not available.`);const v=[b.width,0];X.applyTransform(v,d),m=v[0]*o+_,i.translate(m,0),s.x+=m*h}i.restore(),y&&(this.dependencyTracker=y)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,s,r,o,a){const u=new Path2D;u.rect(s,r,o-s,a-r),this.ctx.clip(u),this.dependencyTracker?.recordBBox(t,this.ctx,s,o,r,a).recordClipBox(t,this.ctx,s,o,r,a),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const s=this.baseTransform||Ht(this.ctx),r={createCanvasGraphics:(o,a)=>new Ni(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Ir(this.dependencyTracker,a,!0):null)};i=new mu(e,this.ctx,r,s)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=$2(this.getObject(t,e)),this.cachedPatterns.set(e,s)),i&&(s.matrix=i),s}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const s=this._getPattern(t,e);i.fillStyle=s.getPattern(i,this,an(i),le.SHADING,t);const r=an(i);if(r){const{width:o,height:a}=i.canvas,u=Si.slice();X.axialAlignedBoundingBox([0,0,o,a],r,u);const[l,c,h,d]=u;this.ctx.fillRect(l,c,h-l,d-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,je.transform).recordDependencies(t,je.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){St("Should not call beginInlineImage")}beginImageData(){St("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=Ht(this.ctx),i)){X.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[s,r,o,a]=i,u=new Path2D;u.rect(s,r,o-s,a-r),this.ctx.clip(u),this.dependencyTracker?.recordClipBox(t,this.ctx,s,o,r,a),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||Jr("TODO: Support non-isolated groups."),e.knockout&&at("Knockout groups not supported.");const s=Ht(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=Si.slice();X.axialAlignedBoundingBox(e.bbox,Ht(i),r);const o=[0,0,i.canvas.width,i.canvas.height];r=X.intersect(r,o)||[0,0,0,0];const a=Math.floor(r[0]),u=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-a,1),c=Math.max(Math.ceil(r[3])-u,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,l,c),f=d.context;f.translate(-a,-u),f.transform(...s);let p=new Path2D;const[g,b,m,A]=e.bbox;if(p.rect(g,b,m-g,A-b),e.matrix){const y=new Path2D;y.addPath(p,new DOMMatrix(e.matrix)),p=y}f.clip(p),e.smask&&this.smaskStack.push({canvas:d.canvas,context:f,offsetX:a,offsetY:u,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(a,u),i.save()),rs(i,f),this.ctx=f,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const r=Ht(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...r);const o=Si.slice();X.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],r,o),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(t,e,i,s,r,o){if(this.#t(),ur(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const a=i[2]-i[0],u=i[3]-i[1];if(o&&this.annotationCanvasMap){s=s.slice(),s[4]-=i[0],s[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=a,i[3]=u,X.singularValueDecompose2dScale(Ht(this.ctx),Be);const{viewportScale:l}=this,c=Math.ceil(a*this.outputScaleX*l),h=Math.ceil(u*this.outputScaleY*l);this.annotationCanvas=this.canvasFactory.create(c,h);const{canvas:d,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(e,d),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,this.ctx.save(),this.ctx.setTransform(Be[0],0,0,-Be[1],0,u*Be[1]),ur(this.ctx)}else{ur(this.ctx),this.endPath(t);const l=new Path2D;l.rect(i[0],i[1],a,u),this.ctx.clip(l)}}this.current=new dc(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...s),this.transform(t,...r)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const s=this.ctx,r=this._createMaskCanvas(t,e),o=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(o,r.offsetX,r.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,r.offsetX,r.offsetX+o.width,r.offsetY,r.offsetY+o.height).recordOperation(t),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,s=0,r=0,o,a){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const u=this.ctx;u.save();const l=Ht(u);u.transform(i,s,r,o,0,0);const c=this._createMaskCanvas(t,e);u.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]),this.dependencyTracker?.resetBBox(t);for(let h=0,d=a.length;h<d;h+=2){const f=X.transform(l,[i,s,r,o,a[h],a[h+1]]);u.drawImage(c.canvas,f[4],f[5]),this.dependencyTracker?.recordBBox(t,this.ctx,f[4],f[4]+c.canvas.width,f[5],f[5]+c.canvas.height)}u.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,s=this.current.fillColor,r=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,je.transformAndFill);for(const o of e){const{data:a,width:u,height:l,transform:c}=o,h=this.cachedCanvases.getCanvas("maskCanvas",u,l),d=h.context;d.save();const f=this.getObject(t,a,o);pc(d,f),d.globalCompositeOperation="source-in",d.fillStyle=r?s.getPattern(d,this,an(i),le.FILL,t):s,d.fillRect(0,0,u,l),d.restore(),i.save(),i.transform(...c),i.scale(1,-1),ar(i,h.canvas,0,0,u,l,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,u,0,l),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){at("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,s,r){if(!this.contentVisible)return;const o=this.getObject(t,e);if(!o){at("Dependent image isn't ready yet");return}const a=o.width,u=o.height,l=[];for(let c=0,h=r.length;c<h;c+=2)l.push({transform:[i,0,0,s,r[c],r[c+1]],x:0,y:0,w:a,h:u});this.paintInlineImageXObjectGroup(t,o,l)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:s}=t,r=this.cachedCanvases.getCanvas("inlineImage",i,s),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",r.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,s=e.height,r=this.ctx;this.save(t);const{filter:o}=r;o!=="none"&&o!==""&&(r.filter="none"),r.scale(1/i,-1/s);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",i,s).context;fc(c,e),a=this.applyTransferMapsToCanvas(c)}const u=this._scaleImage(a,an(r));r.imageSmoothingEnabled=gc(Ht(r),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,r,0,i,-s,0).recordDependencies(t,je.imageXObject).recordOperation(t),ar(r,u.img,0,0,u.paintWidth,u.paintHeight,0,-s,i,s),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const s=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const o=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",o,a).context;fc(l,e),r=this.applyTransferMapsToCanvas(l)}this.dependencyTracker?.resetBBox(t);for(const o of i)s.save(),s.transform(...o.transform),s.scale(1,-1),ar(s,r,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,je.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const r=this.ctx;this.pendingClip?(s||(this.pendingClip===mc?r.clip(e,"evenodd"):r.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Ht(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:s,d:r}=this.ctx.getTransform();let o,a;if(i===0&&s===0){const u=Math.abs(e),l=Math.abs(r);if(u===l)if(t===0)o=a=1/u;else{const c=u*t;o=a=c<1?1/c:1}else if(t===0)o=1/u,a=1/l;else{const c=u*t,h=l*t;o=c<1?1/c:1,a=h<1?1/h:1}}else{const u=Math.abs(e*r-i*s),l=Math.hypot(e,i),c=Math.hypot(s,r);if(t===0)o=c/u,a=l/u;else{const h=t*u;o=c>h?c/h:1,a=l>h?l/h:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:s}}=this,[r,o]=this.getScaleForStroking();if(r===o){i.lineWidth=(s||1)*r,i.stroke(t);return}const a=i.getLineDash();e&&i.save(),i.scale(r,o),qo.a=1/r,qo.d=1/o;const u=new Path2D;if(u.addPath(t,qo),a.length>0){const l=Math.max(r,o);i.setLineDash(a.map(c=>c/l)),i.lineDashOffset/=l}i.lineWidth=s||1,i.stroke(u),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const n in Ps)Ni.prototype[n]!==void 0&&(Ni.prototype[Ps[n]]=Ni.prototype[n]);class Bi{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class K2{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const vi=Symbol("INTERNAL");class Z2{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:i,usage:s,rbGroups:r}){this.#t=!!(t&Oe.DISPLAY),this.#e=!!(t&Oe.PRINT),this.name=e,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==vi&&St("Internal method `_setVisible` called."),this.#i=i,this.#n=e}}class J2{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=Oe.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const i of t.groups)this.#e.set(i.id,new Z2(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(vi,!1);for(const i of t.on)this.#e.get(i)._setVisible(vi,!0);for(const i of t.off)this.#e.get(i)._setVisible(vi,!1);this.#i=this.getHash()}}#r(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let s=1;s<e;s++){const r=t[s];let o;if(Array.isArray(r))o=this.#r(r);else if(this.#e.has(r))o=this.#e.get(r).visible;else return at(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Jr("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(at(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return at(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return at(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return at(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return at(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return at(`Unknown optional content policy ${t.policy}.`),!0}return at(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const s=this.#e.get(t);if(!s){at(`Optional content group not found: ${t}`);return}if(i&&e&&s.rbGroups.length)for(const r of s.rbGroups)for(const o of r)o!==t&&this.#e.get(o)?._setVisible(vi,!1,!0);s._setVisible(vi,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=this.#e.get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!r.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Md;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class no{#t=null;#e=null;_fullReader=null;_rangeReaders=new Set;_source=null;constructor(t,e,i){this._source=t,this.#t=e,this.#e=i}get _progressiveDataLength(){return this._fullReader?._loaded??0}getFullReader(){return Ct(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new this.#t(this)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new this.#e(this,t,e);return this._rangeReaders.add(i),i}cancelAllRequests(t){this._fullReader?.cancel(t);for(const e of new Set(this._rangeReaders))e.cancel(t)}}class io{onProgress=null;_contentLength=0;_filename=null;_headersCapability=Promise.withResolvers();_isRangeSupported=!1;_isStreamingSupported=!1;_loaded=0;_stream=null;constructor(t){this._stream=t}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){St("Abstract method `read` called")}cancel(t){St("Abstract method `cancel` called")}}class so{_stream=null;constructor(t,e,i){this._stream=t}async read(){St("Abstract method `read` called")}cancel(t){St("Abstract method `cancel` called")}}function bc(n){return n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}class Q2 extends no{_progressiveDone=!1;_queuedChunks=[];constructor(t){super(t,ty,ey);const{pdfDataRangeTransport:e}=t,{initialData:i,progressiveDone:s}=e;if(i?.length>0){const r=bc(i);this._queuedChunks.push(r)}this._progressiveDone=s,e.addRangeListener((r,o)=>{this.#t(r,o)}),e.addProgressListener((r,o)=>{o!==void 0&&this._fullReader?.onProgress?.({loaded:r,total:o})}),e.addProgressiveReadListener(r=>{this.#t(void 0,r)}),e.addProgressiveDoneListener(()=>{this._fullReader?.progressiveDone(),this._progressiveDone=!0}),e.transportReady()}#t(t,e){const i=bc(e);if(t===void 0)this._fullReader?this._fullReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.keys().find(r=>r._begin===t);Ct(s,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),s._enqueue(i)}}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,e){const i=super.getRangeReader(t,e);return i&&(i.onDone=()=>this._rangeReaders.delete(i),this._source.pdfDataRangeTransport.requestDataRange(t,e)),i}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}class ty extends io{_done=!1;_queuedChunks=null;_requests=[];constructor(t){super(t);const{pdfDataRangeTransport:e,disableRange:i,disableStream:s}=t._source,{length:r,contentDispositionFilename:o}=e;this._queuedChunks=t._queuedChunks||[];for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._done=t._progressiveDone,this._contentLength=r,this._isStreamingSupported=!s,this._isRangeSupported=!i,cu(o)&&(this._filename=o),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||=!0}}class ey extends so{onDone=null;_begin=-1;_done=!1;_queuedChunk=null;_requests=[];constructor(t,e,i){super(t,e,i),this._begin=e}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this.onDone?.()}}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onDone?.()}}function ny(n){let t=!0,e=i("filename\\*","i").exec(n);if(e){e=e[1];let c=a(e);return c=unescape(c),c=u(c),c=l(c),r(c)}if(e=o(n),e){const c=l(e);return r(c)}if(e=i("filename","i").exec(n),e){e=e[1];let c=a(e);return c=l(c),r(c)}function i(c,h){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function s(c,h){if(c){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const d=new TextDecoder(c,{fatal:!0}),f=Qr(h);h=d.decode(f),t=!1}catch{}}return h}function r(c){return t&&/[\x80-\xff]/.test(c)&&(c=s("utf-8",c),t&&(c=s("iso-8859-1",c))),c}function o(c){const h=[];let d;const f=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(d=f.exec(c))!==null;){let[,g,b,m]=d;if(g=parseInt(g,10),g in h){if(g===0)break;continue}h[g]=[b,m]}const p=[];for(let g=0;g<h.length&&g in h;++g){let[b,m]=h[g];m=a(m),b&&(m=unescape(m),g===0&&(m=u(m))),p.push(m)}return p.join("")}function a(c){if(c.startsWith('"')){const h=c.slice(1).split('\\"');for(let d=0;d<h.length;++d){const f=h[d].indexOf('"');f!==-1&&(h[d]=h[d].slice(0,f),h.length=d+1),h[d]=h[d].replaceAll(/\\(.)/g,"$1")}c=h.join('"')}return c}function u(c){const h=c.indexOf("'");if(h===-1)return c;const d=c.slice(0,h),p=c.slice(h+1).replace(/^[^']*'/,"");return s(d,p)}function l(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,d,f,p){if(f==="q"||f==="Q")return p=p.replaceAll("_"," "),p=p.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,b){return String.fromCharCode(parseInt(b,16))}),s(d,p);try{p=atob(p)}catch{}return s(d,p)})}return""}function Nd(n,t){const e=new Headers;if(!n||!t||typeof t!="object")return e;for(const i in t){const s=t[i];s!==void 0&&e.append(i,s)}return e}function ro(n){return URL.parse(n)?.origin??null}function Bd({responseHeaders:n,isHttp:t,rangeChunkSize:e,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*e)||i||!t||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function Ud(n){const t=n.get("Content-Disposition");if(t){let e=ny(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(cu(e))return e}return null}function oo(n,t){return new Rr(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n,n===404||n===0&&t.startsWith("file:"))}function Hd(n,t){if(n!==t)throw new Error(`Expected range response-origin "${n}" to match "${t}".`)}function zd(n,t,e,i){return fetch(n,{method:"GET",headers:t,signal:i.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"})}function $d(n,t){if(n!==200&&n!==206)throw oo(n,t)}function jd(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(at(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class iy extends no{_responseOrigin=null;constructor(t){super(t,sy,ry),this.isHttp=/^https?:/i.test(t.url),this.headers=Nd(this.isHttp,t.httpHeaders)}}class sy extends io{_abortController=new AbortController;_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:i,length:s,rangeChunkSize:r,url:o,withCredentials:a}=t._source;this._contentLength=s,this._isStreamingSupported=!i,this._isRangeSupported=!e;const u=new Headers(t.headers);zd(o,u,a,this._abortController).then(l=>{t._responseOrigin=ro(l.url),$d(l.status,o),this._reader=l.body.getReader();const c=l.headers,{allowRangeRequests:h,suggestedLength:d}=Bd({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:r,disableRange:e});this._isRangeSupported=h,this._contentLength=d||this._contentLength,this._filename=Ud(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Yn("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:jd(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class ry extends so{_abortController=new AbortController;_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,i){super(t,e,i);const{url:s,withCredentials:r}=t._source,o=new Headers(t.headers);o.append("Range",`bytes=${e}-${i-1}`),zd(s,o,r,this._abortController).then(a=>{const u=ro(a.url);Hd(u,t._responseOrigin),$d(a.status,s),this._reader=a.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:jd(t),done:!1}}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Xo=200,yc=206;function oy(n){return typeof n!="string"?n:Qr(n).buffer}class ay extends no{#t=new WeakMap;_responseOrigin=null;constructor(t){super(t,uy,ly),this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=Nd(this.isHttp,t.httpHeaders)}_request(t){const e=new XMLHttpRequest,i={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};this.#t.set(e,i),e.open("GET",this.url),e.withCredentials=this._source.withCredentials;for(const[s,r]of this.headers)e.setRequestHeader(s,r);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.validateStatus=s=>s===yc||s===Xo):i.validateStatus=s=>s===Xo,e.responseType="arraybuffer",Ct(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>t.onError(e.status),e.onreadystatechange=this.#i.bind(this,e),e.onprogress=this.#e.bind(this,e),e.send(null),e}#e(t,e){this.#t.get(t)?.onProgress?.(e)}#i(t,e){const i=this.#t.get(t);if(!i||(t.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),t.readyState!==4)||!this.#t.has(t))return;if(this.#t.delete(t),t.status===0&&this.isHttp){i.onError(t.status);return}const s=t.status||Xo;if(!i.validateStatus(s)){i.onError(t.status);return}const r=oy(t.response);if(s===yc){const o=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(o)?i.onDone(r):(at('Missing or invalid "Content-Range" header.'),i.onError(0))}else r?i.onDone(r):i.onError(t.status)}_abortRequest(t){this.#t.has(t)&&(this.#t.delete(t),t.abort())}getRangeReader(t,e){const i=super.getRangeReader(t,e);return i&&(i.onClosed=()=>this._rangeReaders.delete(i)),i}}class uy extends io{_cachedChunks=[];_done=!1;_requests=[];_storedError=null;constructor(t){super(t);const{length:e}=t._source;this._contentLength=e,this._fullRequestXhr=t._request({onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:this.#n.bind(this)})}#t(){const t=this._stream,{disableRange:e,rangeChunkSize:i}=t._source,s=this._fullRequestXhr;t._responseOrigin=ro(s.responseURL);const r=s.getAllResponseHeaders(),o=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[c,...h]=l.split(": ");return[c,h.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:u}=Bd({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:i,disableRange:e});a&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=Ud(o),this._isRangeSupported&&t._abortRequest(s),this._headersCapability.resolve()}#e(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}#i(t){this._storedError=oo(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}#n(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}class ly extends so{onClosed=null;_done=!1;_queuedChunk=null;_requests=[];_storedError=null;constructor(t,e,i){super(t,e,i),this._requestXhr=t._request({begin:e,end:i,onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:null})}#t(){const t=ro(this._requestXhr?.responseURL);try{Hd(t,this._stream._responseOrigin)}catch(e){this._storedError=e,this.#i(0)}}#e(t){this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onClosed?.()}#i(t){this._storedError??=oo(t,this._stream.url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),this.onClosed?.()}}const cy=/^[a-z][a-z0-9\-+.]+:/i;function hy(n){if(cy.test(n))return new URL(n);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(n))}function Gd(n){const{Readable:t}=process.getBuiltinModule("stream");return typeof t.toWeb=="function"?t.toWeb(n):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(n)}function Vd(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(at(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class dy extends no{constructor(t){super(t,fy,py),this.url=hy(t.url),Ct(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class fy extends io{_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:i,length:s,rangeChunkSize:r}=t._source;this._contentLength=s,this._isStreamingSupported=!i,this._isRangeSupported=!e;const o=t.url,a=process.getBuiltinModule("fs");a.promises.lstat(o).then(u=>{const l=a.createReadStream(o),c=Gd(l);this._reader=c.getReader();const{size:h}=u;h<=2*r&&(this._isRangeSupported=!1),this._contentLength=h,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Yn("Streaming is disabled.")),this._headersCapability.resolve()}).catch(u=>{u.code==="ENOENT"&&(u=oo(0,o.href)),this._headersCapability.reject(u)})}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Vd(t),done:!1})}cancel(t){this._reader?.cancel(t)}}class py extends so{_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,i){super(t,e,i);const s=t.url,r=process.getBuiltinModule("fs");try{const o=r.createReadStream(s,{start:e,end:i-1}),a=Gd(o);this._reader=a.getReader(),this._readCapability.resolve()}catch(o){this._readCapability.reject(o)}}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:Vd(t),done:!1}}cancel(t){this._reader?.cancel(t)}}const os=Symbol("INITIAL_DATA");class Wd{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:os}}get(t,e=null){if(e){const s=this.#e(t);return s.promise.then(()=>e(s.data)),null}const i=this.#t[t];if(!i||i.data===os)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==os}delete(t){const e=this.#t[t];return!e||e.data===os?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==os&&(yield[t,e])}}}const gy=1e5,Ac=30;class Ne{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#r=null;#o=null;#s=0;#a=0;#l=null;#u=null;#d=0;#h=0;#f=Object.create(null);#m=[];#g=null;#c=[];#p=new WeakMap;#b=null;static#A=new Map;static#y=new Map;static#C=new WeakMap;static#v=null;static#x=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(u){u.enqueue(t),u.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#u=e,this.#h=i.scale*bn.pixelRatio,this.#d=i.rotation,this.#o={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:r,pageX:o,pageY:a}=i.rawDims;this.#b=[1,0,0,-1,-o,a+r],this.#a=s,this.#s=r,Ne.#D(),e.style.setProperty("--min-font-size",Ne.#v),ui(e,i),this.#t.promise.finally(()=>{Ne.#x.delete(this),this.#o=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Zt.platform;return ut(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#l.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#r??=e.lang,Object.assign(this.#f,e.styles),this.#T(e.items),t()},this.#t.reject)};return this.#l=this.#g.getReader(),Ne.#x.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*bn.pixelRatio,s=t.rotation;if(s!==this.#d&&(e?.(),this.#d=s,ui(this.#u,{rotation:s})),i!==this.#h){e?.(),this.#h=i;const r={div:null,properties:null,ctx:Ne.#M(this.#r)};for(const o of this.#c)r.properties=this.#p.get(o),r.div=o,this.#E(r)}}cancel(){const t=new Yn("TextLayer task cancelled.");this.#l?.cancel(t).catch(()=>{}),this.#l=null,this.#t.reject(t)}get textDivs(){return this.#c}get textContentItemsStr(){return this.#m}#T(t){if(this.#i)return;this.#o.ctx??=Ne.#M(this.#r);const e=this.#c,i=this.#m;for(const s of t){if(e.length>gy){at("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const r=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),s.id&&this.#e.setAttribute("id",`${s.id}`),s.tag==="Artifact"&&(this.#e.ariaHidden=!0),r.append(this.#e)}else s.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(s.str),this.#_(s)}}#_(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#c.push(e);const s=X.transform(this.#b,t.transform);let r=Math.atan2(s[1],s[0]);const o=this.#f[t.fontName];o.vertical&&(r+=Math.PI/2);let a=this.#n&&o.fontSubstitution||o.fontFamily;a=Ne.fontFamilyMap.get(a)||a;const u=Math.hypot(s[2],s[3]),l=u*Ne.#N(a,o,this.#r);let c,h;r===0?(c=s[4],h=s[5]-l):(c=s[4]+l*Math.sin(r),h=s[5]-l*Math.cos(r));const d=e.style;d.left=`${(100*c/this.#a).toFixed(2)}%`,d.top=`${(100*h/this.#s).toFixed(2)}%`,d.setProperty("--font-height",`${u.toFixed(2)}px`),d.fontFamily=a,i.fontSize=u,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),r!==0&&(i.angle=r*(180/Math.PI));let f=!1;if(t.str.length>1)f=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const p=Math.abs(t.transform[0]),g=Math.abs(t.transform[3]);p!==g&&Math.max(p,g)/Math.min(p,g)>1.5&&(f=!0)}if(f&&(i.canvasWidth=o.vertical?t.height:t.width),this.#p.set(e,i),this.#o.div=e,this.#o.properties=i,this.#E(this.#o),i.hasText&&this.#e.append(e),i.hasEOL){const p=document.createElement("br");p.setAttribute("role","presentation"),this.#e.append(p)}}#E(t){const{div:e,properties:i,ctx:s}=t,{style:r}=e;if(i.canvasWidth!==0&&i.hasText){const{fontFamily:o}=r,{canvasWidth:a,fontSize:u}=i;Ne.#k(s,u*this.#h,o);const{width:l}=s.measureText(e.textContent);l>0&&r.setProperty("--scale-x",a*this.#h/l)}i.angle!==0&&r.setProperty("--rotate",`${i.angle}deg`)}static cleanup(){if(!(this.#x.size>0)){this.#A.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#M(t=null){let e=this.#y.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,e),this.#C.set(e,{size:0,family:""})}return e}static#k(t,e,i){const s=this.#C.get(t);e===s.size&&i===s.family||(t.font=`${e}px ${i}`,s.size=e,s.family=i)}static#D(){if(this.#v!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#v=t.getBoundingClientRect().height,t.remove()}static#N(t,e,i){const s=this.#A.get(t);if(s)return s;const r=this.#M(i);r.canvas.width=r.canvas.height=Ac,this.#k(r,Ac,t);const o=r.measureText(""),a=o.fontBoundingBoxAscent,u=Math.abs(o.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let l=.8;return a?l=a/(a+u):(Zt.platform.isFirefox&&at("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?l=e.ascent:e.descent&&(l=1+e.descent)),this.#A.set(t,l),l}}const my=100;function qd(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const t=new bu,{docId:e}=t,i=n.url?E2(n.url):null,s=n.data?C2(n.data):null,r=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,u=n.range instanceof Xd?n.range:null,l=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let c=n.worker instanceof Rs?n.worker:null;const h=n.verbosity,d=typeof n.docBaseUrl=="string"&&!to(n.docBaseUrl)?n.docBaseUrl:null,f=ir(n.cMapUrl),p=n.cMapPacked!==!1,g=n.CMapReaderFactory||(_e?R2:ic),b=ir(n.iccUrl),m=ir(n.standardFontDataUrl),A=n.StandardFontDataFactory||(_e?I2:sc),y=ir(n.wasmUrl),_=n.WasmFactory||(_e?L2:rc),x=n.stopAtErrors!==!0,v=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,S=n.isEvalSupported!==!1,M=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!_e,R=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!_e&&(Zt.platform.isFirefox||!globalThis.chrome),j=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,I=typeof n.disableFontFace=="boolean"?n.disableFontFace:_e,Y=n.fontExtraProperties===!0,dt=n.enableXfa===!0,et=n.ownerDocument||globalThis.document,mt=n.disableRange===!0,U=n.disableStream===!0,O=n.disableAutoFetch===!0,q=n.pdfBug===!0,At=n.CanvasFactory||(_e?F2:D2),Ot=n.FilterFactory||(_e?P2:M2),T=n.enableHWA===!0,D=n.useWasm!==!1,B=u?u.length:n.length??NaN,rt=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!_e&&!I,W=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(g===ic&&A===sc&&_===rc&&f&&m&&y&&cs(f,document.baseURI)&&cs(m,document.baseURI)&&cs(y,document.baseURI)),ot=null;Z1(h);const nt={canvasFactory:new At({ownerDocument:et,enableHWA:T}),filterFactory:new Ot({docId:e,ownerDocument:et}),cMapReaderFactory:W?null:new g({baseUrl:f,isCompressed:p}),standardFontDataFactory:W?null:new A({baseUrl:m}),wasmFactory:W?null:new _({baseUrl:y})};c||(c=Rs.create({verbosity:h,port:Bi.workerPort}),t._worker=c);const Ft={docId:e,apiVersion:"5.4.624",data:s,password:a,disableAutoFetch:O,rangeChunkSize:l,length:B,docBaseUrl:d,enableXfa:dt,evaluatorOptions:{maxImageSize:v,disableFontFace:I,ignoreErrors:x,isEvalSupported:S,isOffscreenCanvasSupported:M,isImageDecoderSupported:R,canvasMaxAreaInBytes:j,fontExtraProperties:Y,useSystemFonts:rt,useWasm:D,useWorkerFetch:W,cMapUrl:f,iccUrl:b,standardFontDataUrl:m,wasmUrl:y}},$t={ownerDocument:et,pdfBug:q,styleElement:ot,enableHWA:T,loadingParams:{disableAutoFetch:O,enableXfa:dt}};return c.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const lt=c.messageHandler.sendWithPromise("GetDocRequest",Ft,s?[s.buffer]:null);let re;if(u)re=new Q2({pdfDataRangeTransport:u,disableRange:mt,disableStream:U});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");const w=cs(i)?iy:_e?dy:ay;re=new w({url:i,length:B,httpHeaders:r,withCredentials:o,rangeChunkSize:l,disableRange:mt,disableStream:U})}return lt.then(w=>{if(t.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const E=new hs(e,w,c.port),k=new Ay(E,t,re,$t,nt);t._transport=k,E.send("Ready",null)})}).catch(t._capability.reject),t}class bu{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${bu.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Xd{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#r=[];constructor(t,e,i=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=s}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#r)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#n)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){St("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class by{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ut(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class yy{#t=!1;#e=vt.instance;constructor(t,e,i,s=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=s?new Kl:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new Wd,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(t){this._pageIndex=t-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new zs({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ut(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:s="display",annotationMode:r=jn.ENABLE,transform:o=null,background:a=null,optionalContentConfigPromise:u=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:d=!1,recordOperations:f=!1,operationsFilter:p=null}){this._stats?.time("Overall");const g=this._transport.getRenderingIntent(s,r,h,d),{renderingIntent:b,cacheKey:m}=g;this.#t=!1,u||=this._transport.getOptionalContentConfig(b);let A=this._intentStates.get(m);A||(A=Object.create(null),this._intentStates.set(m,A)),A.streamReaderCancelTimeout&&(clearTimeout(A.streamReaderCancelTimeout),A.streamReaderCancelTimeout=null);const y=!!(b&Oe.PRINT);A.displayReadyCapability||(A.displayReadyCapability=Promise.withResolvers(),A.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(g));const _=!!(this._pdfBug&&globalThis.StepperManager?.enabled),x=!this.recordedBBoxes&&(f||_),v=R=>{if(A.renderTasks.delete(S),x){const j=S.gfx?.dependencyTracker.take();j&&(S.stepper&&S.stepper.setOperatorBBoxes(j,S.gfx.dependencyTracker.takeDebugMetadata()),f&&(this.recordedBBoxes=j))}y&&(this.#t=!0),this.#i(),R?(S.capability.reject(R),this._abortOperatorList({intentState:A,reason:R instanceof Error?R:new Error(R)})):S.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},S=new Ti({callback:v,params:{canvas:e,canvasContext:t,dependencyTracker:x?new N2(e,A.operatorList.length,_):null,viewport:i,transform:o,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:A.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!y,pdfBug:this._pdfBug,pageColors:c,enableHWA:this._transport.enableHWA,operationsFilter:p});(A.renderTasks||=new Set).add(S);const M=S.task;return Promise.all([A.displayReadyCapability.promise,u]).then(([R,j])=>{if(this.destroyed){v();return}if(this._stats?.time("Rendering"),!(j.renderingIntent&b))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");S.initializeGraphics({transparency:R,optionalContentConfig:j}),S.operatorListChanged()}).catch(v),M}getOperatorList({intent:t="display",annotationMode:e=jn.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){function r(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(u))}const o=this._transport.getRenderingIntent(t,e,i,s,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let u;return a.opListReadCapability||(u=Object.create(null),u.operatorListChanged=r,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(u),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Fs.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,s){function r(){o.read().then(function({value:u,done:l}){if(l){i(a);return}a.lang??=u.lang,Object.assign(a.styles,u.styles),a.items.push(...u.items),r()},s)}const o=e.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#i();return t&&e&&(this._stats&&=new Kl),e}#i(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,s=t.length;i<s;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#i()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:o}=i,u=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:s},o).getReader(),l=this._intentStates.get(e);l.streamReader=u;const c=()=>{u.read().then(({value:h,done:d})=>{if(d){l.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,l),c())},h=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(const d of l.renderTasks)d.operatorListChanged();this.#i()}if(l.displayReadyCapability)l.displayReadyCapability.reject(h);else if(l.opListReadCapability)l.opListReadCapability.reject(h);else throw h}})};c()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof lu){let s=my;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new Yn(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var Gn,Ke,kn,ni,Or,ii,si,Ee,Ar,Yd,Kd,ds,Ui,_r;const Ut=class Ut{constructor({name:t=null,port:e=null,verbosity:i=J1()}={}){sn(this,Ee);sn(this,Gn,Promise.withResolvers());sn(this,Ke,null);sn(this,kn,null);sn(this,ni,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Bt(Ut,si).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Bt(Ut,si).set(e,this),rn(this,Ee,Yd).call(this,e)}else rn(this,Ee,Kd).call(this)}get promise(){return Bt(this,Gn).promise}get port(){return Bt(this,kn)}get messageHandler(){return Bt(this,Ke)}destroy(){this.destroyed=!0,Bt(this,ni)?.terminate(),De(this,ni,null),Bt(Ut,si).delete(Bt(this,kn)),De(this,kn,null),Bt(this,Ke)?.destroy(),De(this,Ke,null)}static create(t){const e=Bt(this,si).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Ut(t)}static get workerSrc(){if(Bi.workerSrc)return Bi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ut(this,"_setupFakeWorkerGlobal",(async()=>Bt(this,Ui,_r)?Bt(this,Ui,_r):(await import(this.workerSrc)).WorkerMessageHandler)())}};Gn=new WeakMap,Ke=new WeakMap,kn=new WeakMap,ni=new WeakMap,Or=new WeakMap,ii=new WeakMap,si=new WeakMap,Ee=new WeakSet,Ar=function(){Bt(this,Gn).resolve(),Bt(this,Ke).send("configure",{verbosity:this.verbosity})},Yd=function(t){De(this,kn,t),De(this,Ke,new hs("main","worker",t)),Bt(this,Ke).on("ready",()=>{}),rn(this,Ee,Ar).call(this)},Kd=function(){if(Bt(Ut,ii)||Bt(Ut,Ui,_r)){rn(this,Ee,ds).call(this);return}let{workerSrc:t}=Ut;try{Ut._isSameOrigin(window.location,t)||(t=Ut._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new hs("main","worker",e),s=()=>{r.abort(),i.destroy(),e.terminate(),this.destroyed?Bt(this,Gn).reject(new Error("Worker was destroyed")):rn(this,Ee,ds).call(this)},r=new AbortController;e.addEventListener("error",()=>{Bt(this,ni)||s()},{signal:r.signal}),i.on("test",a=>{if(r.abort(),this.destroyed||!a){s();return}De(this,Ke,i),De(this,kn,e),De(this,ni,e),rn(this,Ee,Ar).call(this)}),i.on("ready",a=>{if(r.abort(),this.destroyed){s();return}try{o()}catch{rn(this,Ee,ds).call(this)}});const o=()=>{const a=new Uint8Array;i.send("test",a,[a.buffer])};o();return}catch{Jr("The worker has been disabled.")}rn(this,Ee,ds).call(this)},ds=function(){Bt(Ut,ii)||(at("Setting up fake worker."),De(Ut,ii,!0)),Ut._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Bt(this,Gn).reject(new Error("Worker was destroyed"));return}const e=new k2;De(this,kn,e);const i=`fake${Bu(Ut,Or)._++}`,s=new hs(i+"_worker",i,e);t.setup(s,e),De(this,Ke,new hs(i,i+"_worker",e)),rn(this,Ee,Ar).call(this)}).catch(t=>{Bt(this,Gn).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Ui=new WeakSet,_r=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},sn(Ut,Ui),sn(Ut,Or,0),sn(Ut,ii,!1),sn(Ut,si,new WeakMap),_e&&(De(Ut,ii,!0),Bi.workerSrc||="./pdf.worker.mjs"),Ut._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const s=new URL(e,i);return i.origin===s.origin},Ut._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Ut.fromPort=t=>{if(c2("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Ut.create(t)};let Rs=Ut;class Ay{downloadInfoCapability=Promise.withResolvers();#t=null;#e=new Map;#i=null;#n=new Map;#r=new Map;#o=new Map;#s=null;#a=vt.instance;constructor(t,e,i,s,r){this.messageHandler=t,this.loadingTask=e,this.#i=i,this.commonObjs=new Wd,this.fontLoader=new x2({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.enableHWA=s.enableHWA,this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),this.#a.addListener(this.#l.bind(this))}#l(){const t=new Map,e=new Map;for(let i=0,s=this.#a.pagesNumber;i<s;i++){const r=this.#a.getPrevPageNumber(i+1)-1,o=this.#n.get(r);o&&t.set(i,o);const a=this.#r.get(r);a&&e.set(i,a)}this.#n=t,this.#r=e}#u(t,e=null){const i=this.#e.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,e);return this.#e.set(t,s),s}#d({loaded:t,total:e}){this.loadingTask.onProgress?.({loaded:t,total:e,percent:ue(Math.round(t/e*100),0,100)})}get annotationStorage(){return ut(this,"annotationStorage",new fu)}getRenderingIntent(t,e=jn.ENABLE,i=null,s=!1,r=!1){let o=Oe.DISPLAY,a=va;switch(t){case"any":o=Oe.ANY;break;case"display":break;case"print":o=Oe.PRINT;break;default:at(`getRenderingIntent - invalid intent: ${t}`)}const u=o&Oe.PRINT&&i instanceof Pd?i:this.annotationStorage;switch(e){case jn.DISABLE:o+=Oe.ANNOTATIONS_DISABLE;break;case jn.ENABLE:break;case jn.ENABLE_FORMS:o+=Oe.ANNOTATIONS_FORMS;break;case jn.ENABLE_STORAGE:o+=Oe.ANNOTATIONS_STORAGE,a=u.serializable;break;default:at(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(o+=Oe.IS_EDITING),r&&(o+=Oe.OPLIST);const{ids:l,hash:c}=u.modifiedIds,h=[o,a.hash,c];return{renderingIntent:o,cacheKey:h.join("_"),annotationStorageSerializable:a,modifiedIds:l}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#n.values())t.push(i._destroy());this.#n.clear(),this.#r.clear(),this.#o.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Ne.cleanup(),this.#i?.cancelAllRequests(new Yn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,s)=>{Ct(this.#i,"GetReader - no `BasePDFStream` instance available."),this.#t=this.#i.getFullReader(),this.#t.onProgress=r=>this.#d(r),s.onPull=()=>{this.#t.read().then(function({value:r,done:o}){if(o){s.close();return}Ct(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this.#t.cancel(r),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async i=>{await this.#t.headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:o}=this.#t;return s&&r&&(this.#t.onProgress=null),{isStreamingSupported:s,isRangeSupported:r,contentLength:o}}),t.on("GetRangeReader",(i,s)=>{Ct(this.#i,"GetRangeReader - no `BasePDFStream` instance available.");const r=this.#i.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:o,done:a}){if(a){s.close();return}Ct(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{r.cancel(o),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("GetDoc",({pdfInfo:i})=>{this.#a.pagesNumber=i.numPages,this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new by(i,this))}),t.on("DocException",i=>{e._capability.reject(Me(i))}),t.on("PasswordRequest",i=>{this.#s=Promise.withResolvers();try{if(!e.onPassword)throw Me(i);const s=r=>{r instanceof Error?this.#s.reject(r):this.#s.resolve({password:r})};e.onPassword(s,i.code)}catch(s){this.#s.reject(s)}return this.#s.promise}),t.on("DataLoaded",i=>{this.#d({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#n.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,s,r])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in r){const h=r.error;at(`Error during font loading: ${h}`),this.commonObjs.resolve(i,h);break}const o=new Mt(r),a=this._params.pdfBug&&globalThis.FontInspector?.enabled?(h,d)=>globalThis.FontInspector.fontAdded(h,d):null,u=new w2(o,a,r.extra,r.charProcOperatorList);this.fontLoader.bind(u).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(i,u)});break;case"CopyLocalImage":const{imageRef:l}=r;Ct(l,"The imageRef must be defined.");for(const h of this.#n.values())for(const[,d]of h.objs)if(d?.ref===l)return d.dataLen?(this.commonObjs.resolve(i,structuredClone(d)),d.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new v2(r));break;case"Image":this.commonObjs.resolve(i,r);break;case"Pattern":const c=new ne(r);this.commonObjs.resolve(i,c.getIR());break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([i,s,r,o])=>{if(this.destroyed)return;const a=this.#n.get(s);if(!a.objs.has(i)){if(a._intentStates.size===0){o?.bitmap?.close();return}switch(r){case"Image":case"Pattern":a.objs.resolve(i,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",i=>{this.destroyed||this.#d(i)}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[i.type];if(!s)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&at("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this.#t?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this.#a.pagesNumber)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#a.getPageId(t)-1,s=this.#r.get(e);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#o.set(o.refStr,i);const a=new yy(e,o,this,this._params.pdfBug);return this.#n.set(e,a),a});return this.#r.set(e,r),r}async getPageIndex(t){if(!Ea(t))throw new Error("Invalid pageIndex request.");const e=await this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen});return this.#a.getPageNumber(e+1)-1}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:this.#a.getPageId(t+1)-1,intent:e})}getFieldObjects(){return this.#u("GetFieldObjects")}hasJSActions(){return this.#u("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#u("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:this.#a.getPageId(t+1)-1})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:this.#a.getPageId(t+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#u("GetOptionalContentConfig").then(e=>new J2(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#e.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(s=>({info:s[0],metadata:s[1]?new K2(s[1]):null,contentDispositionFilename:this.#t?.filename??null,contentLength:this.#t?.contentLength??null,hasStructTree:s[2]}));return this.#e.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#n.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Ne.cleanup()}}cachedPageNumber(t){if(!Ea(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`,i=this.#o.get(e);return i>=0?this.#a.getPageNumber(i+1):null}}class _y{_internalRenderTask=null;onContinue=null;onError=null;constructor(t){this._internalRenderTask=t}get promise(){return this._internalRenderTask.capability.promise}cancel(t=0){this._internalRenderTask.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this._internalRenderTask.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this._internalRenderTask;return t.form||t.canvas&&e?.size>0}}class Ti{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:u,filterFactory:l,useRequestAnimationFrame:c=!1,pdfBug:h=!1,pageColors:d=null,enableHWA:f=!1,operationsFilter:p=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=u,this.filterFactory=l,this._pdfBug=h,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=c===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new _y(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=f,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=p}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Ti.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Ti.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:s,background:r,dependencyTracker:o}=this.params,a=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Ni(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Ti.#e.delete(this._canvas),t||=new lu(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Ti.#e.delete(this._canvas),this.callback())))}}const xy="5.4.624",wy="384c6208b";class Ge{#t=null;#e=null;#i;#n=null;#r=!1;#o=!1;#s=null;#a;#l=null;#u=null;static#d=null;static get _keyboardManager(){return ut(this,"_keyboardManager",new js([[["Escape","mac+Escape"],Ge.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ge.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ge.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ge.prototype._moveToPrevious],[["Home","mac+Home"],Ge.prototype._moveToBeginning],[["End","mac+End"],Ge.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#o=!1,this.#s=t):this.#o=!0,this.#u=t?._uiManager||e,this.#a=this.#u._eventBus,this.#i=t?.color?.toUpperCase()||this.#u?.highlightColors.values().next().value||"#FFFF98",Ge.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const e=this.#u._signal;t.addEventListener("click",this.#g.bind(this),{signal:e}),t.addEventListener("keydown",this.#m.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#i,t.append(i),t}renderMainDropdown(){const t=this.#n=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#u._signal;t.addEventListener("contextmenu",Xe,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[i,s]of this.#u.highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",Ge.#d[i]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=s,r.ariaSelected=s===this.#i,r.addEventListener("click",this.#f.bind(this,s),{signal:e}),t.append(r)}return t.addEventListener("keydown",this.#m.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#a.dispatch("switchannotationeditorparams",{source:this,type:yt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#g(t);return}if(t.target===this.#t){this.#n.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#g(t);return}this.#n.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#g(t);return}this.#n.lastElementChild?.focus()}#m(t){Ge._keyboardManager.exec(this,t)}#g(t){if(this.#p){this.hideDropdown();return}if(this.#r=t.detail===0,this.#l||(this.#l=new AbortController,window.addEventListener("pointerdown",this.#c.bind(this),{signal:this.#u.combinedSignal(this.#l)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#h();this.#t.append(e)}#c(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#l?.abort(),this.#l=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#o){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#u.highlightColors.values();for(const i of this.#n.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}}class Is{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,Is.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,color:i}=this.#e,s=this.#t=document.createElement("input");return s.type="color",s.value=i||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",Is.#n[t]),s.addEventListener("input",()=>{this.#i.updateParams(e,s.value)},{signal:this.#i._signal}),s}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function _c(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function as(n){return Math.max(0,Math.min(255,255*n))}class xc{static CMYK_G([t,e,i,s]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=as(t),[t,t,t]}static G_HTML([t]){const e=_c(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(as)}static RGB_HTML(t){return`#${t.map(_c).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,i,s]){return[as(1-Math.min(1,t+s)),as(1-Math.min(1,i+s)),as(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const s=1-t,r=1-e,o=1-i,a=Math.min(s,r,o);return["CMYK",s,r,o,a]}}class vy{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){St("Abstract method `_createSVG` called.")}}class Lr extends vy{_createSVG(t){return document.createElementNS(Cn,t)}}const Ey=9,li=new WeakSet,Cy=new Date().getTimezoneOffset()*60*1e3;class Yo{static create(t){switch(t.data.annotationType){case Xt.LINK:return new yu(t);case Xt.TEXT:return new Ty(t);case Xt.WIDGET:switch(t.data.fieldType){case"Tx":return new ky(t);case"Btn":return t.data.radioButton?new Zd(t):t.data.checkBox?new My(t):new Py(t);case"Ch":return new Fy(t);case"Sig":return new Dy(t)}return new di(t);case Xt.POPUP:return new Ta(t);case Xt.FREETEXT:return new Jd(t);case Xt.LINE:return new Iy(t);case Xt.SQUARE:return new Ly(t);case Xt.CIRCLE:return new Oy(t);case Xt.POLYLINE:return new Qd(t);case Xt.CARET:return new By(t);case Xt.INK:return new Au(t);case Xt.POLYGON:return new Ny(t);case Xt.HIGHLIGHT:return new tf(t);case Xt.UNDERLINE:return new Uy(t);case Xt.SQUIGGLY:return new Hy(t);case Xt.STRIKEOUT:return new zy(t);case Xt.STAMP:return new ef(t);case Xt.FILEATTACHMENT:return new $y(t);default:return new zt(t)}}}class zt{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return zt._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:s}=this.data;let r=-1/0,o=-1/0;if(e?.length>=8){for(let a=0;a<e.length;a+=8)e[a+1]>o?(o=e[a+1],r=e[a+2]):e[a+1]===o&&(r=Math.max(r,e[a+2]));return[r,o]}if(i?.length>=1){for(const a of i)for(let u=0,l=a.length;u<l;u+=2)a[u+1]>o?(o=a[u+1],r=a[u]):a[u+1]===o&&(r=Math.max(r,a[u]));if(r!==1/0)return[r,o]}return s?[s[2],s[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:o}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-r)/i,t[1]=100*(t[1]-o)/s,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Ms}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${Ms}${e.id}`,{id:e.id,annotationType:e.annotationType,page:this.parent.page,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#n(e);let s=this.#i?.popup||this.popup;!s&&i?.text&&(this._createPopup(i),s=this.#i.popup),s&&(s.updateEdited(t),i?.deleted&&(s.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#n(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#n(t){const{container:{style:e},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:u}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-a)/r}%`,e.top=`${100*(o-t[3]+u)/o}%`,s===0?(e.width=`${100*(t[2]-t[0])/r}%`,e.height=`${100*(t[3]-t[1])/o}%`):this.setRotation(s)}_createContainer(t){const{data:e,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),!(this instanceof di)&&!(this instanceof yu)&&(r.tabIndex=0);const{style:o}=r;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof Ta){const{rotation:g}=e;return!e.hasOwnCanvas&&g!==0&&this.setRotation(g,r),r}const{width:a,height:u}=this;if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const g=e.borderStyle.horizontalCornerRadius,b=e.borderStyle.verticalCornerRadius;if(g>0||b>0){const A=`calc(${g}px * var(--total-scale-factor)) / calc(${b}px * var(--total-scale-factor))`;o.borderRadius=A}else if(this instanceof Zd){const A=`calc(${a}px * var(--total-scale-factor)) / calc(${u}px * var(--total-scale-factor))`;o.borderRadius=A}switch(e.borderStyle.style){case wi.SOLID:o.borderStyle="solid";break;case wi.DASHED:o.borderStyle="dashed";break;case wi.BEVELED:at("Unimplemented border style: beveled");break;case wi.INSET:at("Unimplemented border style: inset");break;case wi.UNDERLINE:o.borderBottomStyle="solid";break}const m=e.borderColor||null;m?(this.#e=!0,o.borderColor=X.makeHexColor(m[0]|0,m[1]|0,m[2]|0)):o.borderWidth=0}const l=X.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:c,pageHeight:h,pageX:d,pageY:f}=s.rawDims;o.left=`${100*(l[0]-d)/c}%`,o.top=`${100*(l[1]-f)/h}%`;const{rotation:p}=e;return e.hasOwnCanvas||p===0?(o.width=`${100*a/c}%`,o.height=`${100*u/h}%`):this.setRotation(p,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims;let{width:r,height:o}=this;t%180!==0&&([r,o]=[o,r]),e.style.width=`${100*r/i}%`,e.style.height=`${100*o/s}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,s)=>{const r=s.detail[e],o=r[0],a=r.slice(1);s.target.style[i]=xc[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[i]:xc[`${o}_rgb`](a)})};return ut(this,"_commonActions",{display:e=>{const{display:i}=e.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const s of Object.keys(e.detail))(t[s]||i[s])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[s,r]of Object.entries(e)){const o=i[s];if(o){const a={detail:{[s]:r},target:t};o(a),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,s,r]=this.data.rect.map(g=>Math.fround(g));if(t.length===8){const[g,b,m,A]=t.subarray(2,6);if(s===g&&r===b&&e===m&&i===A)return}const{style:o}=this.container;let a;if(this.#e){const{borderColor:g,borderWidth:b}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${g}" stroke-width="${b}">`],this.container.classList.add("hasBorder")}const u=s-e,l=r-i,{svgFactory:c}=this,h=c.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0),h.role="none";const d=c.createElement("defs");h.append(d);const f=c.createElement("clipPath"),p=`clippath_${this.data.id}`;f.setAttribute("id",p),f.setAttribute("clipPathUnits","objectBoundingBox"),d.append(f);for(let g=2,b=t.length;g<b;g+=8){const m=t[g],A=t[g+1],y=t[g+2],_=t[g+3],x=c.createElement("rect"),v=(y-e)/u,S=(r-A)/l,M=(m-y)/u,R=(A-_)/l;x.setAttribute("x",v),x.setAttribute("y",S),x.setAttribute("width",M),x.setAttribute("height",R),f.append(x),a?.push(`<rect vector-effect="non-scaling-stroke" x="${v}" y="${S}" width="${M}" height="${R}"/>`)}this.#e&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(h),this.container.style.clipPath=`url(#${p})`}_createPopup(t=null){const{data:e}=this;let i,s;t?(i={str:t.text},s=t.date):(i=e.contentsObj,s=e.modificationDate),this.#i=new Ta({data:{color:e.color,titleObj:e.titleObj,modificationDate:s,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){St("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:r,id:o,exportValues:a}of s){if(r===-1||o===e)continue;const u=typeof a=="string"?a:null,l=document.querySelector(`[data-element-id="${o}"]`);if(l&&!li.has(l)){at(`_getElementsByName - element not allowed: ${o}`);continue}i.push({id:o,exportValue:u,domElement:l})}return i}for(const s of document.getElementsByName(t)){const{exportValue:r}=s,o=s.getAttribute("data-element-id");o!==e&&li.has(s)&&i.push({id:o,exportValue:r,domElement:s})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class Sy extends zt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class yu extends zt{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),s=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(this.#i(i,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=i,this.container.append(i)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",s=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,s),!1),this.#t()}#i(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(e.actions)){const r=i.get(s);r&&(t[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:s}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){at('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:s,refs:r,include:o}=e,a=[];if(s.length!==0||r.length!==0){const c=new Set(r);for(const h of s){const d=this._fieldObjects[h]||[];for(const{id:f}of d)c.add(f)}for(const h of Object.values(this._fieldObjects))for(const d of h)c.has(d.id)===o&&a.push(d)}else for(const c of Object.values(this._fieldObjects))a.push(...c);const u=this.annotationStorage,l=[];for(const c of a){const{id:h}=c;switch(l.push(h),c.type){case"text":{const f=c.defaultValue||"";u.setValue(h,{value:f});break}case"checkbox":case"radiobutton":{const f=c.defaultValue===c.exportValues;u.setValue(h,{value:f});break}case"combobox":case"listbox":{const f=c.defaultValue||"";u.setValue(h,{value:f});break}default:continue}const d=document.querySelector(`[data-element-id="${h}"]`);if(d){if(!li.has(d)){at(`_bindResetFormAction - element not allowed: ${h}`);continue}}else continue;d.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:l,name:"ResetForm"}}),!1}}}class Ty extends zt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class di extends zt{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Zt.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,s,r){i.includes("mouse")?t.addEventListener(i,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(i,o=>{if(i==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o)}})})}_setEventListeners(t,e,i,s){for(const[r,o]of i)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,r,o,s),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":X.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||Ey,r=t.style;let o;const a=2,u=l=>Math.round(10*l)/10;if(this.data.multiLine){const l=Math.abs(this.data.rect[3]-this.data.rect[1]-a),c=Math.round(l/($o*s))||1,h=l/c;o=Math.min(s,u(h/$o))}else{const l=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(s,u(l/$o))}r.fontSize=`calc(${o}px * var(--total-scale-factor))`,r.color=X.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class ky extends di{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,s){const r=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=i),r.setValue(o.id,{[s]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const s=t.getValue(e,{value:this.data.fieldValue});let r=s.value||"";const o=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;o&&r.length>o&&(r=r.slice(0,o));let a=s.formattedValue||this.data.textContent?.join(`
`)||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));const u={userValue:r,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=a??r,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",a??r),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),li.add(i),this.contentElement=i,i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:l,datetimeType:c,timeStep:h}=this.data,d=!!c&&this.enableScripting;l&&(i.title=l),this._setRequired(i,this.data.required),o&&(i.maxLength=o),i.addEventListener("input",p=>{t.setValue(e,{value:p.target.value}),this.setPropertyOnSiblings(i,"value",p.target.value,"value"),u.formattedValue=null}),i.addEventListener("resetform",p=>{const g=this.data.defaultFieldValue??"";i.value=u.userValue=g,u.formattedValue=null});let f=p=>{const{formattedValue:g}=u;g!=null&&(p.target.value=g),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",g=>{if(u.focused)return;const{target:b}=g;if(d&&(b.type=c,h&&(b.step=h)),u.userValue){const m=u.userValue;if(d)if(c==="time"){const A=new Date(m),y=[A.getHours(),A.getMinutes(),A.getSeconds()];b.value=y.map(_=>_.toString().padStart(2,"0")).join(":")}else b.value=new Date(m-Cy).toISOString().split(c==="date"?"T":".",1)[0];else b.value=m}u.lastCommittedValue=b.value,u.commitKey=1,this.data.actions?.Focus||(u.focused=!0)}),i.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const b={value(m){u.userValue=m.detail.value??"",d||t.setValue(e,{value:u.userValue.toString()}),m.target.value=u.userValue},formattedValue(m){const{formattedValue:A}=m.detail;u.formattedValue=A,A!=null&&m.target!==document.activeElement&&(m.target.value=A);const y={formattedValue:A};d&&(y.value=A),t.setValue(e,y)},selRange(m){m.target.setSelectionRange(...m.detail.selRange)},charLimit:m=>{const{charLimit:A}=m.detail,{target:y}=m;if(A===0){y.removeAttribute("maxLength");return}y.setAttribute("maxLength",A);let _=u.userValue;!_||_.length<=A||(_=_.slice(0,A),y.value=u.userValue=_,t.setValue(e,{value:_}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:1,selStart:y.selectionStart,selEnd:y.selectionEnd}}))}};this._dispatchEventFromSandbox(b,g)}),i.addEventListener("keydown",g=>{u.commitKey=1;let b=-1;if(g.key==="Escape"?b=0:g.key==="Enter"&&!this.data.multiLine?b=2:g.key==="Tab"&&(u.commitKey=3),b===-1)return;const{value:m}=g.target;u.lastCommittedValue!==m&&(u.lastCommittedValue=m,u.userValue=m,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:m,willCommit:!0,commitKey:b,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const p=f;f=null,i.addEventListener("blur",g=>{if(!u.focused||!g.relatedTarget)return;this.data.actions?.Blur||(u.focused=!1);const{target:b}=g;let{value:m}=b;if(d){if(m&&c==="time"){const A=m.split(":").map(y=>parseInt(y,10));m=new Date(2e3,0,1,A[0],A[1],A[2]||0).valueOf(),b.step=""}else m.includes("T")||(m=`${m}T00:00`),m=new Date(m).valueOf();b.type="text"}u.userValue=m,u.lastCommittedValue!==m&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:m,willCommit:!0,commitKey:u.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}),p(g)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",g=>{u.lastCommittedValue=null;const{data:b,target:m}=g,{value:A,selectionStart:y,selectionEnd:_}=m;let x=y,v=_;switch(g.inputType){case"deleteWordBackward":{const S=A.substring(0,y).match(/\w*[^\w]*$/);S&&(x-=S[0].length);break}case"deleteWordForward":{const S=A.substring(y).match(/^[^\w]*\w*/);S&&(v+=S[0].length);break}case"deleteContentBackward":y===_&&(x-=1);break;case"deleteContentForward":y===_&&(v+=1);break}g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:A,change:b||"",willCommit:!1,selStart:x,selEnd:v}})}),this._setEventListeners(i,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(f&&i.addEventListener("blur",f),this.data.comb){const g=(this.data.rect[2]-this.data.rect[0])/o;i.classList.add("comb"),i.style.letterSpacing=`calc(${g}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Dy extends di{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class My extends di{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return li.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=0,r.addEventListener("change",o=>{const{name:a,checked:u}=o.target;for(const l of this._getElementsByName(a,i)){const c=u&&l.exportValue===e.exportValue;l.domElement&&(l.domElement.checked=c),t.setValue(l.id,{value:c})}t.setValue(i,{value:u})}),r.addEventListener("resetform",o=>{const a=e.defaultFieldValue||"Off";o.target.checked=a===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const a={value(u){u.target.checked=u.detail.value!=="Off",t.setValue(i,{value:u.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Zd extends di{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(i,{value:s})),s)for(const o of this._getElementsByName(e.fieldName,i))t.setValue(o.id,{value:!1});const r=document.createElement("input");if(li.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",o=>{const{name:a,checked:u}=o.target;for(const l of this._getElementsByName(a,i))t.setValue(l.id,{value:!1});t.setValue(i,{value:u})}),r.addEventListener("resetform",o=>{const a=e.defaultFieldValue;o.target.checked=a!=null&&a===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;r.addEventListener("updatefromsandbox",a=>{const u={value:l=>{const c=o===l.detail.value;for(const h of this._getElementsByName(l.target.name)){const d=c&&h.id===i;h.domElement&&(h.domElement.checked=d),t.setValue(h.id,{value:d})}}};this._dispatchEventFromSandbox(u,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Py extends yu{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class Fy extends di{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");li.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",c=>{const h=this.data.defaultFieldValue;for(const d of s.options)d.selected=d.value===h});for(const c of this.data.options){const h=document.createElement("option");h.textContent=c.displayValue,h.value=c.exportValue,i.value.includes(c.exportValue)&&(h.setAttribute("selected",!0),r=!1),s.append(h)}let o=null;if(r){const c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),s.prepend(c),o=()=>{c.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const a=c=>{const h=c?"value":"textContent",{options:d,multiple:f}=s;return f?Array.prototype.filter.call(d,p=>p.selected).map(p=>p[h]):d.selectedIndex===-1?null:d[d.selectedIndex][h]};let u=a(!1);const l=c=>{const h=c.target.options;return Array.prototype.map.call(h,d=>({displayValue:d.textContent,exportValue:d.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",c=>{const h={value(d){o?.();const f=d.detail.value,p=new Set(Array.isArray(f)?f:[f]);for(const g of s.options)g.selected=p.has(g.value);t.setValue(e,{value:a(!0)}),u=a(!1)},multipleSelection(d){s.multiple=!0},remove(d){const f=s.options,p=d.detail.remove;f[p].selected=!1,s.remove(p),f.length>0&&Array.prototype.findIndex.call(f,b=>b.selected)===-1&&(f[0].selected=!0),t.setValue(e,{value:a(!0),items:l(d)}),u=a(!1)},clear(d){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),u=a(!1)},insert(d){const{index:f,displayValue:p,exportValue:g}=d.detail.insert,b=s.children[f],m=document.createElement("option");m.textContent=p,m.value=g,b?b.before(m):s.append(m),t.setValue(e,{value:a(!0),items:l(d)}),u=a(!1)},items(d){const{items:f}=d.detail;for(;s.length!==0;)s.remove(0);for(const p of f){const{displayValue:g,exportValue:b}=p,m=document.createElement("option");m.textContent=g,m.value=b,s.append(m)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:a(!0),items:l(d)}),u=a(!1)},indices(d){const f=new Set(d.detail.indices);for(const p of d.target.options)p.selected=f.has(p.index);t.setValue(e,{value:a(!0)}),u=a(!1)},editable(d){d.target.disabled=!d.detail.editable}};this._dispatchEventFromSandbox(h,c)}),s.addEventListener("input",c=>{const h=a(!0),d=a(!1);t.setValue(e,{value:h}),c.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:u,change:d,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],c=>c.target.value)):s.addEventListener("input",function(c){t.setValue(e,{value:a(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Ta extends zt{constructor(t){const{data:e,elements:i,parent:s}=t,r=!!s._commentManager;if(super(t,{isRenderable:!r&&zt._hasPopupData(e)}),this.elements=i,r&&zt._hasPopupData(e)){const o=this.popup=this.#t();for(const a of i)a.popup=o}else this.popup=null}#t(){return new Ry({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),i=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${Ci}${s}`).join(",")),this.container}}class Ry{#t=null;#e=this.#G.bind(this);#i=this.#U.bind(this);#n=this.#R.bind(this);#r=this.#w.bind(this);#o=null;#s=null;#a=null;#l=null;#u=null;#d=null;#h=null;#f=!1;#m=null;#g=null;#c=null;#p=null;#b=null;#A=null;#y=null;#C=null;#v=null;#x=null;#T=!1;#_=null;#E=null;constructor({container:t,color:e,elements:i,titleObj:s,modificationDate:r,contentsObj:o,richText:a,parent:u,rect:l,parentRect:c,open:h,commentManager:d=null}){this.#s=t,this.#v=s,this.#a=o,this.#C=a,this.#d=u,this.#o=e,this.#y=l,this.#h=c,this.#u=i,this.#t=d,this.#_=i[0],this.#l=_a.toDateObject(r),this.trigger=i.flatMap(f=>f.getElementsToTriggerPopup()),d||(this.#M(),this.#s.hidden=!0,h&&this.#w())}#M(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const e of this.trigger)e.addEventListener("click",this.#r,{signal:t}),e.addEventListener("pointerenter",this.#n,{signal:t}),e.addEventListener("pointerleave",this.#i,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#u)e.container?.addEventListener("keydown",this.#e,{signal:t})}#k(){const t=this.#u.find(e=>e.hasCommentButton);t&&(this.#b=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#_.container.after(this.#p);return}if(this.#b||this.#k(),!this.#b)return;const{signal:t}=this.#g=new AbortController,e=this.#_.hasOwnCommentButton,i=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},s=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},r=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#_.container;for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",this.#e,{signal:t}),o.addEventListener("click",i,{signal:t}),o.addEventListener("pointerenter",s,{signal:t}),o.addEventListener("pointerleave",r,{signal:t}),o.classList.add("popupTriggerArea")}else{const o=this.#p=document.createElement("button");o.className="annotationCommentButton";const a=this.#_.container;o.style.zIndex=a.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#N(),this.#D(),o.addEventListener("keydown",this.#e,{signal:t}),o.addEventListener("click",i,{signal:t}),o.addEventListener("pointerenter",s,{signal:t}),o.addEventListener("pointerleave",r,{signal:t}),a.after(o)}}#D(){if(this.#_.extraPopupElement&&!this.#_.editor)return;this.#p||this.renderCommentButton();const[t,e]=this.#b,{style:i}=this.#p;i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`}#N(){this.#_.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#_.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:s,modificationDate:r}=this.#_.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:s,modificationDate:r}}get elementBeforePopup(){return this.#p}get comment(){return this.#E||=this.#_.commentText,this.#E}set comment(t){t!==this.comment&&(this.#_.commentText=this.#E=t)}focus(){this.#_.container?.focus()}get parentBoundingClientRect(){return this.#_.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#A)return this.#A;const{x:t,y:e,height:i}=this.#p.getBoundingClientRect(),{x:s,y:r,width:o,height:a}=this.#_.layer.getBoundingClientRect();return[(t-s)/o,(e+i-r)/a]}set commentPopupPosition(t){this.#A=t}hasDefaultPopupPosition(){return this.#A===null}get commentButtonPosition(){return this.#b}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=this.#A||this.commentButtonPosition.map(l=>l/100),s=this.parentBoundingClientRect,{x:r,y:o,width:a,height:u}=s;this.#t.showDialog(null,this,r+e*a,o+i*u,{...t,parentDimensions:s})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#o){const i=t.style.outlineColor=X.makeHexColor(...this.#o);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#v?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#v}if(t.append(e),this.#l){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#l.valueOf()})),i.dateTime=this.#l.toISOString(),e.append(i)}Td({html:this.#F||this.#a.str,dir:this.#a?.dir,className:"popupContent"},t),this.#s.append(t)}get#F(){const t=this.#C,e=this.#a;return t?.str&&(!e?.str||e.str===t.str)&&this.#C.html||null}get#I(){return this.#F?.attributes?.style?.fontSize||0}get#B(){return this.#F?.attributes?.style?.color||null}#L(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:this.#B,fontSize:this.#I?`calc(${this.#I}px * var(--total-scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:s});return i}#G(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#w()}updateEdited({rect:t,popup:e,deleted:i}){if(this.#t){i?(this.remove(),this.#E=null):e&&(e.deleted?this.remove():(this.#N(),this.#E=e.text)),t&&(this.#b=null,this.#k(),this.#D());return}if(i||e?.deleted){this.remove();return}this.#M(),this.#x||={contentsObj:this.#a,richText:this.#C},t&&(this.#c=null),e&&e.text&&(this.#C=this.#L(e.text),this.#l=_a.toDateObject(e.date),this.#a=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#x&&({contentsObj:this.#a,richText:this.#C}=this.#x,this.#x=null,this.#m?.remove(),this.#m=null,this.#c=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#T=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#S(){if(this.#c!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:s,pageY:r}}}=this.#d;let o=!!this.#h,a=o?this.#h:this.#y;for(const p of this.#u)if(!a||X.intersect(p.data.rect,a)!==null){a=p.data.rect,o=!0;break}const u=X.normalizeRect([a[0],t[3]-a[1]+t[1],a[2],t[3]-a[3]+t[1]]),c=o?a[2]-a[0]+5:0,h=u[0]+c,d=u[1];this.#c=[100*(h-s)/e,100*(d-r)/i];const{style:f}=this.#s;f.left=`${this.#c[0]}%`,f.top=`${this.#c[1]}%`}#w(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#R(),this.#s.addEventListener("click",this.#r),this.#s.addEventListener("keydown",this.#e)):(this.#U(),this.#s.removeEventListener("click",this.#r),this.#s.removeEventListener("keydown",this.#e))}#R(){this.#m||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#S(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#U(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#T=this.isVisible,this.#T&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#M(),this.#T&&(this.#m||this.#R(),this.#T=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class Jd extends zt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=ct.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class Iy extends zt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),r=this.#t=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),s.append(r),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ly extends zt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),r=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",r/2),o.setAttribute("y",r/2),o.setAttribute("width",e-r),o.setAttribute("height",i-r),o.setAttribute("stroke-width",r||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Oy extends zt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),r=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",e/2),o.setAttribute("cy",i/2),o.setAttribute("rx",e/2-r/2),o.setAttribute("ry",i/2-r/2),o.setAttribute("stroke-width",r||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Qd extends zt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:s},width:r,height:o}=this;if(!e)return this.container;const a=this.svgFactory.create(r,o,!0);let u=[];for(let c=0,h=e.length;c<h;c+=2){const d=e[c]-t[0],f=t[3]-e[c+1];u.push(`${d},${f}`)}u=u.join(" ");const l=this.#t=this.svgFactory.createElement(this.svgElementName);return l.setAttribute("points",u),l.setAttribute("stroke-width",i.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ny extends Qd{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class By extends zt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Au extends zt{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ct.HIGHLIGHT:ct.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:s,popupRef:r}}=this,{transform:o,width:a,height:u}=this.#i(e,t),l=this.svgFactory.create(a,u,!0),c=this.#t=this.svgFactory.createElement("svg:g");l.append(c),c.setAttribute("stroke-width",s.width||1),c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit",10),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),c.setAttribute("transform",o);for(let h=0,d=i.length;h<d;h++){const f=this.svgFactory.createElement(this.svgElementName);this.#e.push(f),f.setAttribute("points",i[h].join(",")),c.append(f)}return!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(l),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:s}=t,r=this.#t;if(e>=0&&r.setAttribute("stroke-width",e||1),i)for(let o=0,a=this.#e.length;o<a;o++)this.#e[o].setAttribute("points",i[o].join(","));if(s){const{transform:o,width:a,height:u}=this.#i(this.data.rotation,s);r.parentElement.setAttribute("viewBox",`0 0 ${a} ${u}`),r.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class tf extends zt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ct.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class Uy extends zt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class Hy extends zt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class zy extends zt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class ef extends zt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ct.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class $y extends zt{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:s}=Zt.platform;return t.addEventListener("keydown",r=>{r.key==="Enter"&&(s?r.metaKey:r.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class _u{#t=null;#e=null;#i=null;#n=new Map;#r=null;#o=null;#s=[];#a=!1;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:o,structTreeLayer:a,commentManager:u,linkService:l,annotationStorage:c}){this.div=t,this.#t=e,this.#e=i,this.#r=a||null,this.#o=l||null,this.#i=c||new fu,this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=u||null}hasEditableAnnotations(){return this.#n.size>0}async render(t){const{annotations:e}=t,i=this.div;ui(i,this.viewport);const s=new Map,r=[],o={data:null,layer:i,linkService:this.#o,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Lr,annotationStorage:this.#i,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const u=a.annotationType===Xt.POPUP;if(u){const h=s.get(a.id);if(!h)continue;if(!this._commentManager){r.push(a);continue}o.elements=h}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;o.data=a;const l=Yo.create(o);if(!l.isRenderable)continue;if(!u&&(this.#s.push(l),a.popupRef)){const h=s.get(a.popupRef);h?h.push(l):s.set(a.popupRef,[l])}const c=l.render();a.hidden&&(c.style.visibility="hidden"),l._isEditable&&(this.#n.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}await this.#l();for(const a of r){const u=o.elements=s.get(a.id);o.data=a;const l=Yo.create(o);if(!l.isRenderable)continue;const c=l.render();l.contentElement.id=`${Ci}${a.id}`,a.hidden&&(c.style.visibility="hidden"),u.at(-1).container.after(c)}this.#u()}async#l(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#a){this.#a=!0;for(const{contentElement:i,data:{id:s}}of this.#s){const r=i.id=`${Ci}${s}`;t.push(this.#r?.getAriaAttributes(r).then(o=>{if(o)for(const[a,u]of o)i.setAttribute(a,u)}))}}this.#s.sort(({data:{rect:[i,s,r,o]}},{data:{rect:[a,u,l,c]}})=>{if(i===r&&s===o)return 1;if(a===l&&u===c)return-1;const h=o,d=s,f=(s+o)/2,p=c,g=u,b=(u+c)/2;if(f>=p&&b<=d)return-1;if(b>=h&&f<=g)return 1;const m=(i+r)/2,A=(a+l)/2;return m-A});const e=document.createDocumentFragment();for(const i of this.#s)e.append(i.container),this._commentManager?(i.extraPopupElement?.popup||i.popup)?.renderCommentButton():i.extraPopupElement&&e.append(i.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),this.#t)for(const i of this.#s)this.#t.addPointerInTextLayer(i.contentElement,!1)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#o,svgFactory:new Lr,parent:this};for(const i of t){i.borderStyle||=_u._defaultBorderStyle,e.data=i;const s=Yo.create(e);s.isRenderable&&(s.render(),s.contentElement.id=`${Ci}${i.id}`,this.#s.push(s))}await this.#l()}update({viewport:t}){const e=this.div;this.viewport=t,ui(e,{rotation:t.rotation}),this.#u(),e.hidden=!1}#u(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:r}=s;r?r.nodeName==="CANVAS"?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):s.append(i);const o=this.#n.get(e);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,s.id,i),o._hasNoCanvas=!1):o.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:s}=t,r=new Sy({data:{id:i,rect:t.getPDFRect(),rotation:s},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#o,annotationStorage:this.#i});return r.render(),r.contentElement.id=`${Ci}${i}`,r.createOrUpdatePopup(),this.#s.push(r),r}removeAnnotation(t){const e=this.#s.findIndex(s=>s.data.id===t);if(e<0)return;const[i]=this.#s.splice(e,1);this.#t?.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);this.#l()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return ut(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:wi.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const lr=/\r\n?|\n/g;class ie extends tt{#t="";#e=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=ie.prototype,e=r=>r.isEmpty(),i=Kn.TRANSLATE_SMALL,s=Kn.TRANSLATE_BIG;return ut(this,"_keyboardManager",new js([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}]]))}static _type="freetext";static _editorType=ct.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||ie._defaultColor||tt._defaultLineColor,this.#n=t.fontSize||ie._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,e){tt.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case yt.FREETEXT_SIZE:ie._defaultFontSize=e;break;case yt.FREETEXT_COLOR:ie._defaultColor=e;break}}updateParams(t,e){switch(t){case yt.FREETEXT_SIZE:this.#r(e);break;case yt.FREETEXT_COLOR:this.#o(e);break}}static get defaultPropertiesToUpdate(){return[[yt.FREETEXT_SIZE,ie._defaultFontSize],[yt.FREETEXT_COLOR,ie._defaultColor||tt._defaultLineColor]]}get propertiesToUpdate(){return[[yt.FREETEXT_SIZE,this.#n],[yt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Is(this),[["colorPicker",this._colorPicker]]}get colorType(){return yt.FREETEXT_COLOR}#r(t){const e=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#n)*this.parentScale),this.#n=s,this.#a()},i=this.#n;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:yt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#o(t){const e=s=>{this.color=s,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:yt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-ie._internalPadding*t,-(ie._internalPadding+this.#n)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(ie.#l(i)),e=i);return t.join(`
`)}#a(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:r}=this,o=r.style.display,a=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",s.div.append(this.div),i=r.getBoundingClientRect(),r.remove(),r.style.display=o,r.classList.toggle("hidden",a)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#s().trimEnd();if(t===e)return;const i=s=>{if(this.#t=s,!s){this.remove();return}this.#u(),this._uiManager.rebuild(this),this.#a()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#a()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){ie._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,r]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[a,u]=this.getInitialTranslation();[a,u]=this.pageTranslationToScreen(a,u);const[l,c]=this.pageDimensions,[h,d]=this.pageTranslation;let f,p;switch(this.rotation){case 0:f=t+(o[0]-h)/l,p=e+this.height-(o[1]-d)/c;break;case 90:f=t+(o[0]-h)/l,p=e-(o[1]-d)/c,[a,u]=[u,-a];break;case 180:f=t-this.width+(o[0]-h)/l,p=e-(o[1]-d)/c,[a,u]=[-a,-u];break;case 270:f=t+(o[0]-h-this.height*c)/l,p=e+(o[1]-d-this.width*l)/c,[a,u]=[-u,a];break}this.setAt(f*s,p*r,a,u)}else this._moveAfterPaste(t,e);this.#u(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#l(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(lr,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const s=ie.#h(e.getData("text")||"").replaceAll(lr,`
`);if(!s)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const o=r.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:a,startOffset:u}=o,l=[],c=[];if(a.nodeType===Node.TEXT_NODE){const f=a.parentElement;if(c.push(a.nodeValue.slice(u).replaceAll(lr,"")),f!==this.editorDiv){let p=l;for(const g of this.editorDiv.childNodes){if(g===f){p=c;continue}p.push(ie.#l(g))}}l.push(a.nodeValue.slice(0,u).replaceAll(lr,""))}else if(a===this.editorDiv){let f=l,p=0;for(const g of this.editorDiv.childNodes)p++===u&&(f=c),f.push(ie.#l(g))}this.#t=`${l.join(`
`)}${s}${c.join(`
`)}`,this.#u();const h=new Range;let d=Math.sumPrecise(l.map(f=>f.length));for(const{firstChild:f}of this.editorDiv.childNodes)if(f.nodeType===Node.TEXT_NODE){const p=f.nodeValue.length;if(d<=p){h.setStart(f,d),h.setEnd(f,d);break}d-=p}r.removeAllRanges(),r.addRange(h)}#u(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=ie._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let s=null;if(t instanceof Jd){const{data:{defaultAppearanceData:{fontSize:o,fontColor:a},rect:u,rotation:l,id:c,popupRef:h,richText:d,contentsObj:f,creationDate:p,modificationDate:g},textContent:b,textPosition:m,parent:{page:{pageNumber:A}}}=t;if(!b||b.length===0)return null;s=t={annotationType:ct.FREETEXT,color:Array.from(a),fontSize:o,value:b.join(`
`),position:m,pageIndex:A-1,rect:u.slice(0),rotation:l,annotationElementId:c,id:c,deleted:!1,popupRef:h,comment:f?.str||null,richText:d,creationDate:p,modificationDate:g}}const r=await super.deserialize(t,e,i);return r.#n=t.fontSize,r.color=X.makeHexColor(...t.color),r.#t=ie.#h(t.value),r._initialData=s,t.comment&&r.setCommentData(t),r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=tt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:this.#n,value:this.#d()});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(t){const{value:e,fontSize:i,color:s,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((o,a)=>o!==s[a])||t.pageIndex!==r}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const s of this.#t.split(`
`)){const r=document.createElement("div");r.append(s?document.createTextNode(s):document.createElement("br")),e.append(r)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class K{static PRECISION=1e-4;toSVGPath(){St("Abstract method `toSVGPath` must be implemented.")}get box(){St("Abstract getter `box` must be implemented.")}serialize(t,e){St("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,s,r,o){o||=new Float32Array(t.length);for(let a=0,u=t.length;a<u;a+=2)o[a]=e+t[a]*s,o[a+1]=i+t[a+1]*r;return o}static _rescaleAndSwap(t,e,i,s,r,o){o||=new Float32Array(t.length);for(let a=0,u=t.length;a<u;a+=2)o[a]=e+t[a+1]*s,o[a+1]=i+t[a]*r;return o}static _translate(t,e,i,s){s||=new Float32Array(t.length);for(let r=0,o=t.length;r<o;r+=2)s[r]=e+t[r],s[r+1]=i+t[r+1];return s}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,s,r){switch(r){case 90:return[1-e/i,t/s];case 180:return[1-t/i,1-e/s];case 270:return[e/i,1-t/s];default:return[t/i,e/s]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,s,r,o){return[(t+5*i)/6,(e+5*s)/6,(5*i+r)/6,(5*s+o)/6,(i+r)/2,(s+o)/2]}}class ei{#t;#e=[];#i;#n;#r=[];#o=new Float32Array(18);#s;#a;#l;#u;#d;#h;#f=[];static#m=8;static#g=2;static#c=ei.#m+ei.#g;constructor({x:t,y:e},i,s,r,o,a=0){this.#t=i,this.#h=r*s,this.#n=o,this.#o.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=a,this.#u=ei.#m*s,this.#l=ei.#c*s,this.#d=s,this.#f.push(t,e)}isEmpty(){return isNaN(this.#o[8])}#p(){const t=this.#o.subarray(4,6),e=this.#o.subarray(16,18),[i,s,r,o]=this.#t;return[(this.#s+(t[0]-e[0])/2-i)/r,(this.#a+(t[1]-e[1])/2-s)/o,(this.#s+(e[0]-t[0])/2-i)/r,(this.#a+(e[1]-t[1])/2-s)/o]}add({x:t,y:e}){this.#s=t,this.#a=e;const[i,s,r,o]=this.#t;let[a,u,l,c]=this.#o.subarray(8,12);const h=t-l,d=e-c,f=Math.hypot(h,d);if(f<this.#l)return!1;const p=f-this.#u,g=p/f,b=g*h,m=g*d;let A=a,y=u;a=l,u=c,l+=b,c+=m,this.#f?.push(t,e);const _=-m/p,x=b/p,v=_*this.#h,S=x*this.#h;return this.#o.set(this.#o.subarray(2,8),0),this.#o.set([l+v,c+S],4),this.#o.set(this.#o.subarray(14,18),12),this.#o.set([l-v,c-S],16),isNaN(this.#o[6])?(this.#r.length===0&&(this.#o.set([a+v,u+S],2),this.#r.push(NaN,NaN,NaN,NaN,(a+v-i)/r,(u+S-s)/o),this.#o.set([a-v,u-S],14),this.#e.push(NaN,NaN,NaN,NaN,(a-v-i)/r,(u-S-s)/o)),this.#o.set([A,y,a,u,l,c],6),!this.isEmpty()):(this.#o.set([A,y,a,u,l,c],6),Math.abs(Math.atan2(y-u,A-a)-Math.atan2(m,b))<Math.PI/2?([a,u,l,c]=this.#o.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((a+l)/2-i)/r,((u+c)/2-s)/o),[a,u,A,y]=this.#o.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((A+a)/2-i)/r,((y+u)/2-s)/o),!0):([A,y,a,u,l,c]=this.#o.subarray(0,6),this.#r.push(((A+5*a)/6-i)/r,((y+5*u)/6-s)/o,((5*a+l)/6-i)/r,((5*u+c)/6-s)/o,((a+l)/2-i)/r,((u+c)/2-s)/o),[l,c,a,u,A,y]=this.#o.subarray(12,18),this.#e.push(((A+5*a)/6-i)/r,((y+5*u)/6-s)/o,((5*a+l)/6-i)/r,((5*u+c)/6-s)/o,((a+l)/2-i)/r,((u+c)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,e=this.#e;if(isNaN(this.#o[6])&&!this.isEmpty())return this.#b();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);this.#y(i);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return this.#A(i),i.join(" ")}#b(){const[t,e,i,s]=this.#t,[r,o,a,u]=this.#p();return`M${(this.#o[2]-t)/i} ${(this.#o[3]-e)/s} L${(this.#o[4]-t)/i} ${(this.#o[5]-e)/s} L${r} ${o} L${a} ${u} L${(this.#o[16]-t)/i} ${(this.#o[17]-e)/s} L${(this.#o[14]-t)/i} ${(this.#o[15]-e)/s} Z`}#A(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#y(t){const[e,i,s,r]=this.#t,o=this.#o.subarray(4,6),a=this.#o.subarray(16,18),[u,l,c,h]=this.#p();t.push(`L${(o[0]-e)/s} ${(o[1]-i)/r} L${u} ${l} L${c} ${h} L${(a[0]-e)/s} ${(a[1]-i)/r}`)}newFreeDrawOutline(t,e,i,s,r,o){return new nf(t,e,i,s,r,o)}getOutlines(){const t=this.#r,e=this.#e,i=this.#o,[s,r,o,a]=this.#t,u=new Float32Array((this.#f?.length??0)+2);for(let h=0,d=u.length-2;h<d;h+=2)u[h]=(this.#f[h]-s)/o,u[h+1]=(this.#f[h+1]-r)/a;if(u[u.length-2]=(this.#s-s)/o,u[u.length-1]=(this.#a-r)/a,isNaN(i[6])&&!this.isEmpty())return this.#C(u);const l=new Float32Array(this.#r.length+24+this.#e.length);let c=t.length;for(let h=0;h<c;h+=2){if(isNaN(t[h])){l[h]=l[h+1]=NaN;continue}l[h]=t[h],l[h+1]=t[h+1]}c=this.#x(l,c);for(let h=e.length-6;h>=6;h-=6)for(let d=0;d<6;d+=2){if(isNaN(e[h+d])){l[c]=l[c+1]=NaN,c+=2;continue}l[c]=e[h+d],l[c+1]=e[h+d+1],c+=2}return this.#v(l,c),this.newFreeDrawOutline(l,u,this.#t,this.#d,this.#i,this.#n)}#C(t){const e=this.#o,[i,s,r,o]=this.#t,[a,u,l,c]=this.#p(),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(e[2]-i)/r,(e[3]-s)/o,NaN,NaN,NaN,NaN,(e[4]-i)/r,(e[5]-s)/o,NaN,NaN,NaN,NaN,a,u,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,(e[16]-i)/r,(e[17]-s)/o,NaN,NaN,NaN,NaN,(e[14]-i)/r,(e[15]-s)/o],0),this.newFreeDrawOutline(h,t,this.#t,this.#d,this.#i,this.#n)}#v(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#x(t,e){const i=this.#o.subarray(4,6),s=this.#o.subarray(16,18),[r,o,a,u]=this.#t,[l,c,h,d]=this.#p();return t.set([NaN,NaN,NaN,NaN,(i[0]-r)/a,(i[1]-o)/u,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,(s[0]-r)/a,(s[1]-o)/u],e),e+=24}}class nf extends K{#t;#e=new Float32Array(4);#i;#n;#r;#o;#s;constructor(t,e,i,s,r,o){super(),this.#s=t,this.#r=e,this.#t=i,this.#o=s,this.#i=r,this.#n=o,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#a(o);const[a,u,l,c]=this.#e;for(let h=0,d=t.length;h<d;h+=2)t[h]=(t[h]-a)/l,t[h+1]=(t[h+1]-u)/c;for(let h=0,d=e.length;h<d;h+=2)e[h]=(e[h]-a)/l,e[h+1]=(e[h+1]-u)/c}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let e=6,i=this.#s.length;e<i;e+=6){if(isNaN(this.#s[e])){t.push(`L${this.#s[e+4]} ${this.#s[e+5]}`);continue}t.push(`C${this.#s[e]} ${this.#s[e+1]} ${this.#s[e+2]} ${this.#s[e+3]} ${this.#s[e+4]} ${this.#s[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,s],r){const o=i-t,a=s-e;let u,l;switch(r){case 0:u=K._rescale(this.#s,t,s,o,-a),l=K._rescale(this.#r,t,s,o,-a);break;case 90:u=K._rescaleAndSwap(this.#s,t,e,o,a),l=K._rescaleAndSwap(this.#r,t,e,o,a);break;case 180:u=K._rescale(this.#s,i,e,-o,a),l=K._rescale(this.#r,i,e,-o,a);break;case 270:u=K._rescaleAndSwap(this.#s,i,s,-o,-a),l=K._rescaleAndSwap(this.#r,i,s,-o,-a);break}return{outline:Array.from(u),points:[Array.from(l)]}}#a(t){const e=this.#s;let i=e[4],s=e[5];const r=[i,s,i,s];let o=i,a=s,u=i,l=s;const c=t?Math.max:Math.min,h=new Float32Array(4);for(let f=6,p=e.length;f<p;f+=6){const g=e[f+4],b=e[f+5];isNaN(e[f])?(X.pointBoundingBox(g,b,r),a>b?(o=g,a=b):a===b&&(o=c(o,g)),l<b?(u=g,l=b):l===b&&(u=c(u,g))):(h[0]=h[1]=1/0,h[2]=h[3]=-1/0,X.bezierBoundingBox(i,s,...e.slice(f,f+6),h),X.rectBoundingBox(h[0],h[1],h[2],h[3],r),a>h[1]?(o=h[0],a=h[1]):a===h[1]&&(o=c(o,h[0])),l<h[3]?(u=h[2],l=h[3]):l===h[3]&&(u=c(u,h[2]))),i=g,s=b}const d=this.#e;d[0]=r[0]-this.#i,d[1]=r[1]-this.#i,d[2]=r[2]-r[0]+2*this.#i,d[3]=r[3]-r[1]+2*this.#i,this.firstPoint=[o,a],this.lastPoint=[u,l]}get box(){return this.#e}newOutliner(t,e,i,s,r,o=0){return new ei(t,e,i,s,r,o)}getNewOutline(t,e){const[i,s,r,o]=this.#e,[a,u,l,c]=this.#t,h=r*l,d=o*c,f=i*l+a,p=s*c+u,g=this.newOutliner({x:this.#r[0]*h+f,y:this.#r[1]*d+p},this.#t,this.#o,t,this.#n,e??this.#i);for(let b=2;b<this.#r.length;b+=2)g.add({x:this.#r[b]*h+f,y:this.#r[b+1]*d+p});return g.getOutlines()}}class ka{#t;#e;#i;#n=[];#r=[];constructor(t,e=0,i=0,s=!0){const r=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:g,y:b,width:m,height:A}of t){const y=Math.floor((g-e)/o)*o,_=Math.ceil((g+m+e)/o)*o,x=Math.floor((b-e)/o)*o,v=Math.ceil((b+A+e)/o)*o,S=[y,x,v,!0],M=[_,x,v,!1];this.#n.push(S,M),X.rectBoundingBox(y,x,_,v,r)}const a=r[2]-r[0]+2*i,u=r[3]-r[1]+2*i,l=r[0]-i,c=r[1]-i;let h=s?-1/0:1/0,d=1/0;const f=this.#n.at(s?-1:-2),p=[f[0],f[2]];for(const g of this.#n){const[b,m,A,y]=g;!y&&s?m<d?(d=m,h=b):m===d&&(h=Math.max(h,b)):y&&!s&&(m<d?(d=m,h=b):m===d&&(h=Math.min(h,b))),g[0]=(b-l)/a,g[1]=(m-c)/u,g[2]=(A-c)/u}this.#t=new Float32Array([l,c,a,u]),this.#e=[h,d],this.#i=p}getOutlines(){this.#n.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#u(e)),this.#a(e)):(this.#l(e),t.push(...this.#u(e)));return this.#o(t)}#o(t){const e=[],i=new Set;for(const o of t){const[a,u,l]=o;e.push([a,u,o],[a,l,o])}e.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=e.length;o<a;o+=2){const u=e[o][2],l=e[o+1][2];u.push(l),l.push(u),i.add(u),i.add(l)}const s=[];let r;for(;i.size>0;){const o=i.values().next().value;let[a,u,l,c,h]=o;i.delete(o);let d=a,f=u;for(r=[a,l],s.push(r);;){let p;if(i.has(c))p=c;else if(i.has(h))p=h;else break;i.delete(p),[a,u,l,c,h]=p,d!==a&&(r.push(d,f,a,f===u?u:l),d=a),f=f===u?l:u}r.push(d,f)}return new jy(s,this.#t,this.#e,this.#i)}#s(t){const e=this.#r;let i=0,s=e.length-1;for(;i<=s;){const r=i+s>>1,o=e[r][0];if(o===t)return r;o<t?i=r+1:s=r-1}return s+1}#a([,t,e]){const i=this.#s(t);this.#r.splice(i,0,[t,e])}#l([,t,e]){const i=this.#s(t);for(let s=i;s<this.#r.length;s++){const[r,o]=this.#r[s];if(r!==t)break;if(r===t&&o===e){this.#r.splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,o]=this.#r[s];if(r!==t)break;if(r===t&&o===e){this.#r.splice(s,1);return}}}#u(t){const[e,i,s]=t,r=[[e,i,s]],o=this.#s(s);for(let a=0;a<o;a++){const[u,l]=this.#r[a];for(let c=0,h=r.length;c<h;c++){const[,d,f]=r[c];if(!(l<=d||f<=u)){if(d>=u){if(f>l)r[c][1]=l;else{if(h===1)return[];r.splice(c,1),c--,h--}continue}r[c][2]=u,f>l&&r.push([e,l,f])}}}return r}}class jy extends K{#t;#e;constructor(t,e,i,s){super(),this.#e=t,this.#t=e,this.firstPoint=i,this.lastPoint=s}toSVGPath(){const t=[];for(const e of this.#e){let[i,s]=e;t.push(`M${i} ${s}`);for(let r=2;r<e.length;r+=2){const o=e[r],a=e[r+1];o===i?(t.push(`V${a}`),s=a):a===s&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,e,i,s],r){const o=[],a=i-t,u=s-e;for(const l of this.#e){const c=new Array(l.length);for(let h=0;h<l.length;h+=2)c[h]=t+l[h]*a,c[h+1]=s-l[h+1]*u;o.push(c)}return o}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Da extends ei{newFreeDrawOutline(t,e,i,s,r,o){return new Gy(t,e,i,s,r,o)}}class Gy extends nf{newOutliner(t,e,i,s,r,o=0){return new Da(t,e,i,s,r,o)}}class Vt extends tt{#t=null;#e=0;#i;#n=null;#r=null;#o=null;#s=null;#a=0;#l=null;#u=null;#d=null;#h=!1;#f=null;#m=null;#g=null;#c="";#p;#b="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=ct.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=Vt.prototype;return ut(this,"_keyboardManager",new js([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||Vt._defaultColor,this.#p=t.thickness||Vt._defaultThickness,this.opacity=t.opacity||Vt._defaultOpacity,this.#i=t.boxes||null,this.#b=t.methodOfCreation||"",this.#c=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#y(t),this.#_()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#a=t.focusOffset,this.#A(),this.#_(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#b}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#A(){const t=new ka(this.#i,.001);this.#u=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#u.box;const e=new ka(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#o=e.getOutlines();const{firstPoint:i}=this.#u;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:s}=this.#o;this.#m=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#u=t;const s=1.5;if(this.#o=t.getNewOutline(this.#p/2+s,.0025),e>=0)this.#d=e,this.#n=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#o.box,path:{d:this.#o.toSVGPath()}},!0);else if(this.parent){const h=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:Vt.#E(this.#u.box,(h-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:Vt.#E(this.#o.box,h),path:{d:this.#o.toSVGPath()}})}const[r,o,a,u]=t.box;switch(this.rotation){case 0:this.x=r,this.y=o,this.width=a,this.height=u;break;case 90:{const[h,d]=this.parentDimensions;this.x=o,this.y=1-r,this.width=a*d/h,this.height=u*h/d;break}case 180:this.x=1-r,this.y=1-o,this.width=a,this.height=u;break;case 270:{const[h,d]=this.parentDimensions;this.x=1-o,this.y=r,this.width=a*d/h,this.height=u*h/d;break}}const{firstPoint:l}=t;this.#f=[(l[0]-r)/a,(l[1]-o)/u];const{lastPoint:c}=this.#o;this.#m=[(c[0]-r)/a,(c[1]-o)/u]}static initialize(t,e){tt.initialize(t,e),Vt._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case yt.HIGHLIGHT_COLOR:Vt._defaultColor=e;break;case yt.HIGHLIGHT_THICKNESS:Vt._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case yt.HIGHLIGHT_COLOR:this.#C(e);break;case yt.HIGHLIGHT_THICKNESS:this.#v(e);break}}static get defaultPropertiesToUpdate(){return[[yt.HIGHLIGHT_COLOR,Vt._defaultColor],[yt.HIGHLIGHT_THICKNESS,Vt._defaultThickness]]}get propertiesToUpdate(){return[[yt.HIGHLIGHT_COLOR,this.color||Vt._defaultColor],[yt.HIGHLIGHT_THICKNESS,this.#p||Vt._defaultThickness],[yt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#C(t){const e=(r,o)=>{this.color=r,this.opacity=o,this.onUpdatedColor()},i=this.color,s=this.opacity;this.addCommands({cmd:e.bind(this,t,Vt._defaultOpacity),undo:e.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:yt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#v(t){const e=this.#p,i=s=>{this.#p=s,this.#x(s)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:yt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new Ge({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#T(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#_(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#T():t&&(this.#_(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#x(t){this.#h&&(this.#y({highlightOutlines:this.#u.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#T(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#_(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#u.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#u.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#o.box,path:{d:this.#o.toSVGPath()}},this.#h),this.#l&&(this.#l.style.clipPath=this.#n))}static#E([t,e,i,s],r){switch(r){case 90:return[1-e-s,t,s,i];case 180:return[1-t-i,1-e-s,i,s];case 270:return[e,1-t-i,s,i]}return[t,e,i,s]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#h?(t=(t-this.rotation+360)%360,i=Vt.#E(this.#u.box,t)):i=Vt.#E([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#g,{bbox:Vt.#E(this.#o.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#c&&(t.setAttribute("aria-label",this.#c),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#M.bind(this),{signal:this._uiManager._signal});const e=this.#l=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n,this.setDims(),Dd(this,this.#l,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#M(t){Vt._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#k(!0);break;case 1:case 3:this.#k(!1);break}}#k(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#s,this.#a)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#h||this.#k(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#D(){return this.#h?this.rotation:0}#N(){if(this.#h)return null;const[t,e]=this.pageDimensions,[i,s]=this.pageTranslation,r=this.#i,o=new Float32Array(r.length*8);let a=0;for(const{x:u,y:l,width:c,height:h}of r){const d=u*t+i,f=(1-l)*e+s;o[a]=o[a+4]=d,o[a+1]=o[a+3]=f,o[a+2]=o[a+6]=d+c*t,o[a+5]=o[a+7]=f-h*e,a+=8}return o}#F(t){return this.#u.serialize(t,this.#D())}static startHighlighting(t,e,{target:i,x:s,y:r}){const{x:o,y:a,width:u,height:l}=i.getBoundingClientRect(),c=new AbortController,h=t.combinedSignal(c),d=f=>{c.abort(),this.#B(t,f)};window.addEventListener("blur",d,{signal:h}),window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("pointerdown",jt,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",Xe,{signal:h}),i.addEventListener("pointermove",this.#I.bind(this,t),{signal:h}),this._freeHighlight=new Da({x:s,y:r},[o,a,u,l],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#I(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let s=null;if(t instanceof tf){const{data:{quadPoints:p,rect:g,rotation:b,id:m,color:A,opacity:y,popupRef:_,richText:x,contentsObj:v,creationDate:S,modificationDate:M},parent:{page:{pageNumber:R}}}=t;s=t={annotationType:ct.HIGHLIGHT,color:Array.from(A),opacity:y,quadPoints:p,boxes:null,pageIndex:R-1,rect:g.slice(0),rotation:b,annotationElementId:m,id:m,deleted:!1,popupRef:_,richText:x,comment:v?.str||null,creationDate:S,modificationDate:M}}else if(t instanceof Au){const{data:{inkLists:p,rect:g,rotation:b,id:m,color:A,borderStyle:{rawWidth:y},popupRef:_,richText:x,contentsObj:v,creationDate:S,modificationDate:M},parent:{page:{pageNumber:R}}}=t;s=t={annotationType:ct.HIGHLIGHT,color:Array.from(A),thickness:y,inkLists:p,boxes:null,pageIndex:R-1,rect:g.slice(0),rotation:b,annotationElementId:m,id:m,deleted:!1,popupRef:_,richText:x,comment:v?.str||null,creationDate:S,modificationDate:M}}const{color:r,quadPoints:o,inkLists:a,opacity:u}=t,l=await super.deserialize(t,e,i);l.color=X.makeHexColor(...r),l.opacity=u||1,a&&(l.#p=t.thickness),l._initialData=s,t.comment&&l.setCommentData(t);const[c,h]=l.pageDimensions,[d,f]=l.pageTranslation;if(o){const p=l.#i=[];for(let g=0;g<o.length;g+=8)p.push({x:(o[g]-d)/c,y:1-(o[g+1]-f)/h,width:(o[g+2]-o[g])/c,height:(o[g+1]-o[g+5])/h});l.#A(),l.#_(),l.rotate(l.rotation)}else if(a){l.#h=!0;const p=a[0],g={x:p[0]-d,y:h-(p[1]-f)},b=new Da(g,[0,0,c,h],1,l.#p/2,!0,.001);for(let y=0,_=p.length;y<_;y+=2)g.x=p[y]-d,g.y=h-(p[y+1]-f),b.add(g);const{id:m,clipPathId:A}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:l.color,"fill-opacity":l._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:b.toSVGPath()}},!0,!0);l.#y({highlightOutlines:b.getOutlines(),highlightId:m,clipPathId:A}),l.#_(),l.rotate(l.parentRotation)}return l}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=tt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#N(),outlines:this.#F(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#L(i)?null:(i.id=this.annotationElementId,i)}#L(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,s)=>i!==e[s])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class sf{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){St("Not implemented")}}class wt extends tt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#r=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#o(t),this.#l())}#o({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#h(t.box)}#s(t,e){const{id:i}=e.drawLayer.draw(wt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[s,r]of Object.entries(e))i.has(s)?Object.assign(t[s],r):t[s]=r;return t}static getDefaultDrawingOptions(t){St("Not implemented")}static get typesMap(){St("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(wt.#i.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)t.push([i,e[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,s]of this.constructor.typesMap)t.push([i,e[s]]);return t}_updateProperty(t,e,i){const s=this._drawingOptions,r=s[e],o=a=>{s.updateProperty(e,a);const u=this.#t.updateProperty(e,a);u&&this.#h(u),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#a(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#l(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#a()):t&&(this._uiManager.addShouldRescale(this),this.#l(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#a(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#l(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#u([t,e,i,s]){const{parentDimensions:[r,o],rotation:a}=this;switch(a){case 90:return[e,1-t,i*(o/r),s*(r/o)];case 180:return[1-t,1-e,i,s];case 270:return[1-e,t,i*(o/r),s*(r/o)];default:return[t,e,i,s]}}#d(){const{x:t,y:e,width:i,height:s,parentDimensions:[r,o],rotation:a}=this;switch(a){case 90:return[1-e,t,i*(r/o),s*(o/r)];case 180:return[1-t,1-e,i,s];case 270:return[e,1-t,i*(r/o),s*(o/r)];default:return[t,e,i,s]}}#h(t){[this.x,this.y,this.width,this.height]=this.#u(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:e,width:i,height:s,rotation:r,parentRotation:o,parentDimensions:[a,u]}=this;switch((r*4+o)/90){case 1:return[1-e-s,t,s,i];case 2:return[1-t-i,1-e-s,i,s];case 3:return[e,1-t-i,s,i];case 4:return[t,e-i*(a/u),s*(u/a),i*(a/u)];case 5:return[1-e,t,i*(a/u),s*(u/a)];case 6:return[1-t-s*(u/a),1-e,s*(u/a),i*(a/u)];case 7:return[e-i*(a/u),1-t-s*(u/a),i*(a/u),s*(u/a)];case 8:return[t-i,e-s,i,s];case 9:return[1-e,t-i,s,i];case 10:return[1-t,1-e,i,s];case 11:return[e-s,1-t,s,i];case 12:return[t-s*(u/a),e,s*(u/a),i*(a/u)];case 13:return[1-e-i*(a/u),t-s*(u/a),i*(a/u),s*(u/a)];case 14:return[1-t,1-e-i*(a/u),s*(u/a),i*(a/u)];case 15:return[e,1-t,i*(a/u),s*(u/a)];default:return[t,e,i,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const s=document.createElement("div");return i.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,s,r){St("Not implemented")}static startDrawing(t,e,i,s){const{target:r,offsetX:o,offsetY:a,pointerId:u,pointerType:l}=s;if(Et.isInitializedAndDifferentPointerType(l))return;const{viewport:{rotation:c}}=t,{width:h,height:d}=r.getBoundingClientRect(),f=wt.#n=new AbortController,p=t.combinedSignal(f);if(Et.setPointer(l,u),window.addEventListener("pointerup",g=>{Et.isSamePointerIdOrRemove(g.pointerId)&&this._endDraw(g)},{signal:p}),window.addEventListener("pointercancel",g=>{Et.isSamePointerIdOrRemove(g.pointerId)&&this._currentParent.endDrawingSession()},{signal:p}),window.addEventListener("pointerdown",g=>{Et.isSamePointerType(g.pointerType)&&(Et.initializeAndAddPointerId(g.pointerId),wt.#i.isCancellable()&&(wt.#i.removeLastElement(),wt.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Xe,{signal:p}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:p}),r.addEventListener("touchmove",g=>{Et.isSameTimeStamp(g.timeStamp)&&jt(g)},{signal:p}),t.toggleDrawing(),e._editorUndoBar?.hide(),wt.#i){t.drawLayer.updateProperties(this._currentDrawId,wt.#i.startNew(o,a,h,d,c));return}e.updateUIForDefaultProperties(this),wt.#i=this.createDrawerInstance(o,a,h,d,c),wt.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(wt.#r.toSVGProperties(),wt.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Et.isSameTimeStamp(t.timeStamp),!wt.#i)return;const{offsetX:e,offsetY:i,pointerId:s}=t;if(Et.isSamePointerId(s)){if(Et.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,wt.#i.add(e,i)),Et.setTimeStamp(t.timeStamp),jt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,wt.#i=null,wt.#r=null,Et.clearTimeStamp()),wt.#n&&(wt.#n.abort(),wt.#n=null,Et.clearPointerIds())}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,wt.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=wt.#i,s=this._currentDrawId,r=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(s,i.setLastElement(r))},undo:()=>{e.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:yt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(yt.DRAW_STEP),!wt.#i.isEmpty()){const{pageDimensions:[i,s],scale:r}=e,o=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:wt.#i.getOutlines(i*r,s*r,r,this._INNER_MARGIN),drawingOptions:wt.#r,mustBeCommitted:!t});return this._cleanup(!0),o}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,s,r,o){St("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:s,pageHeight:r,pageX:o,pageY:a}}=e.viewport,u=this.deserializeDraw(o,a,s,r,this._INNER_MARGIN,t),l=await super.deserialize(t,e,i);return l.createDrawingOptions(t),l.#o({drawOutlines:u}),l.#l(),l.onScaleChanging(),l.rotate(),l}serializeDraw(t){const[e,i]=this.pageTranslation,[s,r]=this.pageDimensions;return this.#t.serialize([e,i,s,r],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class Vy{#t=new Float64Array(6);#e;#i;#n;#r;#o;#s="";#a=0;#l=new Gs;#u;#d;constructor(t,e,i,s,r,o){this.#u=i,this.#d=s,this.#n=r,this.#r=o,[t,e]=this.#h(t,e);const a=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#o=[t,e],this.#i=[{line:a,points:this.#o}],this.#t.set(a,0)}updateProperty(t,e){t==="stroke-width"&&(this.#r=e)}#h(t,e){return K._normalizePoint(t,e,this.#u,this.#d,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#o.length<=10}add(t,e){[t,e]=this.#h(t,e);const[i,s,r,o]=this.#t.subarray(2,6),a=t-r,u=e-o;return Math.hypot(this.#u*a,this.#d*u)<=2?null:(this.#o.push(t,e),isNaN(i)?(this.#t.set([r,o,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,s,r,o,t,e],0),this.#e.push(...K.createBezierPoints(i,s,r,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#o.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,s,r){this.#u=i,this.#d=s,this.#n=r,[t,e]=this.#h(t,e);const o=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#o=[t,e];const a=this.#i.at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),this.#i.push({line:o,points:this.#o}),this.#t.set(o,0),this.#a=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#o=t.points,this.#a=0,{path:{d:this.toSVGPath()}}):this.#l.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#l.removeLastElement();this.#i.pop(),this.#s="";for(let t=0,e=this.#i.length;t<e;t++){const{line:i,points:s}=this.#i[t];this.#e=i,this.#o=s,this.#a=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=K.svgRound(this.#e[4]),e=K.svgRound(this.#e[5]);if(this.#o.length===2)return this.#s=`${this.#s} M ${t} ${e} Z`,this.#s;if(this.#o.length<=6){const s=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,s)} M ${t} ${e}`,this.#a=6}if(this.#o.length===4){const s=K.svgRound(this.#e[10]),r=K.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${s} ${r}`,this.#a=12,this.#s}const i=[];this.#a===0&&(i.push(`M ${t} ${e}`),this.#a=6);for(let s=this.#a,r=this.#e.length;s<r;s+=6){const[o,a,u,l,c,h]=this.#e.slice(s,s+6).map(K.svgRound);i.push(`C${o} ${a} ${u} ${l} ${c} ${h}`)}return this.#s+=i.join(" "),this.#a=this.#e.length,this.#s}getOutlines(t,e,i,s){const r=this.#i.at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),this.#l.build(this.#i,t,e,i,this.#n,this.#r,s),this.#t=null,this.#e=null,this.#i=null,this.#s=null,this.#l}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Gs extends K{#t;#e=0;#i;#n;#r;#o;#s;#a;#l;build(t,e,i,s,r,o,a){this.#r=e,this.#o=i,this.#s=s,this.#a=r,this.#l=o,this.#i=a??0,this.#n=t,this.#h()}get thickness(){return this.#l}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${K.svgRound(e[4])} ${K.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${K.svgRound(e[10])} ${K.svgRound(e[11])}`);continue}for(let i=6,s=e.length;i<s;i+=6){const[r,o,a,u,l,c]=e.subarray(i,i+6).map(K.svgRound);t.push(`C${r} ${o} ${a} ${u} ${l} ${c}`)}}return t.join("")}serialize([t,e,i,s],r){const o=[],a=[],[u,l,c,h]=this.#d();let d,f,p,g,b,m,A,y,_;switch(this.#a){case 0:_=K._rescale,d=t,f=e+s,p=i,g=-s,b=t+u*i,m=e+(1-l-h)*s,A=t+(u+c)*i,y=e+(1-l)*s;break;case 90:_=K._rescaleAndSwap,d=t,f=e,p=i,g=s,b=t+l*i,m=e+u*s,A=t+(l+h)*i,y=e+(u+c)*s;break;case 180:_=K._rescale,d=t+i,f=e,p=-i,g=s,b=t+(1-u-c)*i,m=e+l*s,A=t+(1-u)*i,y=e+(l+h)*s;break;case 270:_=K._rescaleAndSwap,d=t+i,f=e+s,p=-i,g=-s,b=t+(1-l-h)*i,m=e+(1-u-c)*s,A=t+(1-l)*i,y=e+(1-u)*s;break}for(const{line:x,points:v}of this.#n)o.push(_(x,d,f,p,g,r?new Array(x.length):null)),a.push(_(v,d,f,p,g,r?new Array(v.length):null));return{lines:o,points:a,rect:[b,m,A,y]}}static deserialize(t,e,i,s,r,{paths:{lines:o,points:a},rotation:u,thickness:l}){const c=[];let h,d,f,p,g;switch(u){case 0:g=K._rescale,h=-t/i,d=e/s+1,f=1/i,p=-1/s;break;case 90:g=K._rescaleAndSwap,h=-e/s,d=-t/i,f=1/s,p=1/i;break;case 180:g=K._rescale,h=t/i+1,d=-e/s,f=-1/i,p=1/s;break;case 270:g=K._rescaleAndSwap,h=e/s+1,d=t/i+1,f=-1/s,p=-1/i;break}if(!o){o=[];for(const m of a){const A=m.length;if(A===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,m[0],m[1]]));continue}if(A===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,m[0],m[1],NaN,NaN,NaN,NaN,m[2],m[3]]));continue}const y=new Float32Array(3*(A-2));o.push(y);let[_,x,v,S]=m.subarray(0,4);y.set([NaN,NaN,NaN,NaN,_,x],0);for(let M=4;M<A;M+=2){const R=m[M],j=m[M+1];y.set(K.createBezierPoints(_,x,v,S,R,j),(M-2)*3),[_,x,v,S]=[v,S,R,j]}}}for(let m=0,A=o.length;m<A;m++)c.push({line:g(o[m].map(y=>y??NaN),h,d,f,p),points:g(a[m].map(y=>y??NaN),h,d,f,p)});const b=new this.prototype.constructor;return b.build(c,i,s,1,u,l,r),b}#u(t=this.#l){const e=this.#i+t/2*this.#s;return this.#a%180===0?[e/this.#r,e/this.#o]:[e/this.#o,e/this.#r]}#d(){const[t,e,i,s]=this.#t,[r,o]=this.#u(0);return[t+r,e+o,i-2*r,s-2*o]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#n){if(s.length<=12){for(let a=4,u=s.length;a<u;a+=6)X.pointBoundingBox(s[a],s[a+1],t);continue}let r=s[4],o=s[5];for(let a=6,u=s.length;a<u;a+=6){const[l,c,h,d,f,p]=s.subarray(a,a+6);X.bezierBoundingBox(r,o,l,c,h,d,f,p,t),r=f,o=p}}const[e,i]=this.#u();t[0]=ue(t[0]-e,0,1),t[1]=ue(t[1]-i,0,1),t[2]=ue(t[2]+e,0,1),t[3]=ue(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,i]=this.#u();this.#l=t;const[s,r]=this.#u(),[o,a]=[s-e,r-i],u=this.#t;return u[0]-=o,u[1]-=a,u[2]+=2*o,u[3]+=2*a,u}updateParentDimensions([t,e],i){const[s,r]=this.#u();this.#r=t,this.#o=e,this.#s=i;const[o,a]=this.#u(),u=o-s,l=a-r,c=this.#t;return c[0]-=u,c[1]-=l,c[2]+=2*u,c[3]+=2*l,c}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(K.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${K.svgRound(t)} ${K.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,s=0,r=0,o=0,a=0,u=0;switch(this.#e){case 90:s=e/t,r=-t/e,a=t;break;case 180:i=-1,o=-1,a=t,u=e;break;case 270:s=-e/t,r=t/e,u=e;break;default:return""}return`matrix(${i} ${s} ${r} ${o} ${K.svgRound(a)} ${K.svgRound(u)})`}getPathResizingSVGProperties([t,e,i,s]){const[r,o]=this.#u(),[a,u,l,c]=this.#t;if(Math.abs(l-r)<=K.PRECISION||Math.abs(c-o)<=K.PRECISION){const g=t+i/2-(a+l/2),b=e+s/2-(u+c/2);return{path:{"transform-origin":`${K.svgRound(t)} ${K.svgRound(e)}`,transform:`${this.rotationTransform} translate(${g} ${b})`}}}const h=(i-2*r)/(l-2*r),d=(s-2*o)/(c-2*o),f=l/i,p=c/s;return{path:{"transform-origin":`${K.svgRound(a)} ${K.svgRound(u)}`,transform:`${this.rotationTransform} scale(${f} ${p}) translate(${K.svgRound(r)} ${K.svgRound(o)}) scale(${h} ${d}) translate(${K.svgRound(-r)} ${K.svgRound(-o)})`}}}getPathResizedSVGProperties([t,e,i,s]){const[r,o]=this.#u(),a=this.#t,[u,l,c,h]=a;if(a[0]=t,a[1]=e,a[2]=i,a[3]=s,Math.abs(c-r)<=K.PRECISION||Math.abs(h-o)<=K.PRECISION){const b=t+i/2-(u+c/2),m=e+s/2-(l+h/2);for(const{line:A,points:y}of this.#n)K._translate(A,b,m,A),K._translate(y,b,m,y);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${K.svgRound(t)} ${K.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const d=(i-2*r)/(c-2*r),f=(s-2*o)/(h-2*o),p=-d*(u+r)+t+r,g=-f*(l+o)+e+o;if(d!==1||f!==1||p!==0||g!==0)for(const{line:b,points:m}of this.#n)K._rescale(b,p,g,d,f,b),K._rescale(m,p,g,d,f,m);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${K.svgRound(t)} ${K.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[s,r]=i,o=this.#t,a=t-o[0],u=e-o[1];if(this.#r===s&&this.#o===r)for(const{line:l,points:c}of this.#n)K._translate(l,a,u,l),K._translate(c,a,u,c);else{const l=this.#r/s,c=this.#o/r;this.#r=s,this.#o=r;for(const{line:h,points:d}of this.#n)K._rescale(h,a,u,l,c,h),K._rescale(d,a,u,l,c,d);o[2]*=l,o[3]*=c}return o[0]=t,o[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${K.svgRound(t)} ${K.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${K.svgRound(t[0])} ${K.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class ao extends sf{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:tt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new ao(this._viewParameters);return t.updateAll(this),t}}class xu extends wt{static _type="ink";static _editorType=ct.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){tt.initialize(t,e),this._defaultDrawingOptions=new ao(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return ut(this,"typesMap",new Map([[yt.INK_THICKNESS,"stroke-width"],[yt.INK_COLOR,"stroke"],[yt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,s,r){return new Vy(t,e,i,s,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,s,r,o){return Gs.deserialize(t,e,i,s,r,o)}static async deserialize(t,e,i){let s=null;if(t instanceof Au){const{data:{inkLists:o,rect:a,rotation:u,id:l,color:c,opacity:h,borderStyle:{rawWidth:d},popupRef:f,richText:p,contentsObj:g,creationDate:b,modificationDate:m},parent:{page:{pageNumber:A}}}=t;s=t={annotationType:ct.INK,color:Array.from(c),thickness:d,opacity:h,paths:{points:o},boxes:null,pageIndex:A-1,rect:a.slice(0),rotation:u,annotationElementId:l,id:l,deleted:!1,popupRef:f,richText:p,comment:g?.str||null,creationDate:b,modificationDate:m}}const r=await super.deserialize(t,e,i);return r._initialData=s,t.comment&&r.setCommentData(t),r}get toolbarButtons(){return this._colorPicker||=new Is(this),[["colorPicker",this._colorPicker]]}get colorType(){return yt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=xu.getDefaultDrawingOptions({stroke:X.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":r,"stroke-width":o}}=this,a=Object.assign(super.serialize(t),{color:tt._colorManager.convert(s),opacity:r,thickness:o,paths:{lines:e,points:i}});return this.addComment(a),t?(a.isCopy=!0,a):this.annotationElementId&&!this.#t(a)?null:(a.id=this.annotationElementId,a)}#t(t){const{color:e,thickness:i,opacity:s,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,a)=>o!==e[a])||t.thickness!==i||t.opacity!==s||t.pageIndex!==r}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class Ma extends Gs{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const cr=8,us=3;class Ei{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,s){return i-=t,s-=e,i===0?s>0?0:4:i===1?s+6:2-s}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,i,s,r,o,a){const u=this.#e(i,s,r,o);for(let l=0;l<8;l++){const c=(-l+u-a+16)%8,h=this.#i[2*c],d=this.#i[2*c+1];if(t[(i+h)*e+(s+d)]!==0)return c}return-1}static#r(t,e,i,s,r,o,a){const u=this.#e(i,s,r,o);for(let l=0;l<8;l++){const c=(l+u+a+16)%8,h=this.#i[2*c],d=this.#i[2*c+1];if(t[(i+h)*e+(s+d)]!==0)return c}return-1}static#o(t,e,i,s){const r=t.length,o=new Int32Array(r);for(let c=0;c<r;c++)o[c]=t[c]<=s?1:0;for(let c=1;c<i-1;c++)o[c*e]=o[c*e+e-1]=0;for(let c=0;c<e;c++)o[c]=o[e*i-1-c]=0;let a=1,u;const l=[];for(let c=1;c<i-1;c++){u=1;for(let h=1;h<e-1;h++){const d=c*e+h,f=o[d];if(f===0)continue;let p=c,g=h;if(f===1&&o[d-1]===0)a+=1,g-=1;else if(f>=1&&o[d+1]===0)a+=1,g+=1,f>1&&(u=f);else{f!==1&&(u=Math.abs(f));continue}const b=[h,c],m=g===h+1,A={isHole:m,points:b,id:a,parent:0};l.push(A);let y;for(const I of l)if(I.id===u){y=I;break}y?y.isHole?A.parent=m?y.parent:u:A.parent=m?u:y.parent:A.parent=m?u:0;const _=this.#n(o,e,c,h,p,g,0);if(_===-1){o[d]=-a,o[d]!==1&&(u=Math.abs(o[d]));continue}let x=this.#i[2*_],v=this.#i[2*_+1];const S=c+x,M=h+v;p=S,g=M;let R=c,j=h;for(;;){const I=this.#r(o,e,R,j,p,g,1);x=this.#i[2*I],v=this.#i[2*I+1];const Y=R+x,dt=j+v;b.push(dt,Y);const et=R*e+j;if(o[et+1]===0?o[et]=-a:o[et]===1&&(o[et]=a),Y===c&&dt===h&&R===S&&j===M){o[d]!==1&&(u=Math.abs(o[d]));break}else p=R,g=j,R=Y,j=dt}}}return l}static#s(t,e,i,s){if(i-e<=4){for(let S=e;S<i-2;S+=2)s.push(t[S],t[S+1]);return}const r=t[e],o=t[e+1],a=t[i-4]-r,u=t[i-3]-o,l=Math.hypot(a,u),c=a/l,h=u/l,d=c*o-h*r,f=u/a,p=1/l,g=Math.atan(f),b=Math.cos(g),m=Math.sin(g),A=p*(Math.abs(b)+Math.abs(m)),y=p*(1-A+A**2),_=Math.max(Math.atan(Math.abs(m+b)*y),Math.atan(Math.abs(m-b)*y));let x=0,v=e;for(let S=e+2;S<i-2;S+=2){const M=Math.abs(d-c*t[S+1]+h*t[S]);M>x&&(v=S,x=M)}x>(l*_)**2?(this.#s(t,e,v+2,s),this.#s(t,v,i,s)):s.push(r,o)}static#a(t){const e=[],i=t.length;return this.#s(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#l(t,e,i,s,r,o){const a=new Float32Array(o**2),u=-2*s**2,l=o>>1;for(let g=0;g<o;g++){const b=(g-l)**2;for(let m=0;m<o;m++)a[g*o+m]=Math.exp((b+(m-l)**2)/u)}const c=new Float32Array(256),h=-2*r**2;for(let g=0;g<256;g++)c[g]=Math.exp(g**2/h);const d=t.length,f=new Uint8Array(d),p=new Uint32Array(256);for(let g=0;g<i;g++)for(let b=0;b<e;b++){const m=g*e+b,A=t[m];let y=0,_=0;for(let v=0;v<o;v++){const S=g+v-l;if(!(S<0||S>=i))for(let M=0;M<o;M++){const R=b+M-l;if(R<0||R>=e)continue;const j=t[S*e+R],I=a[v*o+M]*c[Math.abs(j-A)];y+=j*I,_+=I}}const x=f[m]=Math.round(y/_);p[x]++}return[f,p]}static#u(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let s=-1/0,r=1/0;for(let a=0,u=i.length;a<u;a++){const l=i[a]=t[a<<2];s=Math.max(s,l),r=Math.min(r,l)}const o=255/(s-r);for(let a=0,u=i.length;a<u;a++)i[a]=(i[a]-r)*o;return i}static#h(t){let e,i=-1/0,s=-1/0;const r=t.findIndex(u=>u!==0);let o=r,a=r;for(e=r;e<256;e++){const u=t[e];u>i&&(e-o>s&&(s=e-o,a=e-1),i=u,o=e)}for(e=a-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:i,height:s}=t,{maxDim:r}=this.#t;let o=i,a=s;if(i>r||s>r){let d=i,f=s,p=Math.log2(Math.max(i,s)/r);const g=Math.floor(p);p=p===g?g-1:g;for(let m=0;m<p;m++){o=Math.ceil(d/2),a=Math.ceil(f/2);const A=new OffscreenCanvas(o,a);A.getContext("2d").drawImage(t,0,0,d,f,0,0,o,a),d=o,f=a,t!==e&&t.close(),t=A.transferToImageBitmap()}const b=Math.min(r/o,r/a);o=Math.round(o*b),a=Math.round(a*b)}const l=new OffscreenCanvas(o,a).getContext("2d",{willReadFrequently:!0});l.fillStyle="white",l.fillRect(0,0,o,a),l.filter="grayscale(1)",l.drawImage(t,0,0,t.width,t.height,0,0,o,a);const c=l.getImageData(0,0,o,a).data;return[this.#d(c),o,a]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:s},r,o,a,u){let l=new OffscreenCanvas(1,1),c=l.getContext("2d",{alpha:!1});const h=200,d=c.font=`${i} ${s} ${h}px ${e}`,{actualBoundingBoxLeft:f,actualBoundingBoxRight:p,actualBoundingBoxAscent:g,actualBoundingBoxDescent:b,fontBoundingBoxAscent:m,fontBoundingBoxDescent:A,width:y}=c.measureText(t),_=1.5,x=Math.ceil(Math.max(Math.abs(f)+Math.abs(p)||0,y)*_),v=Math.ceil(Math.max(Math.abs(g)+Math.abs(b)||h,Math.abs(m)+Math.abs(A)||h)*_);l=new OffscreenCanvas(x,v),c=l.getContext("2d",{alpha:!0,willReadFrequently:!0}),c.font=d,c.filter="grayscale(1)",c.fillStyle="white",c.fillRect(0,0,x,v),c.fillStyle="black",c.fillText(t,x*(_-1)/2,v*(3-_)/2);const S=this.#d(c.getImageData(0,0,x,v).data),M=this.#u(S),R=this.#h(M),j=this.#o(S,x,v,R);return this.processDrawnLines({lines:{curves:j,width:x,height:v},pageWidth:r,pageHeight:o,rotation:a,innerMargin:u,mustSmooth:!0,areContours:!0})}static process(t,e,i,s,r){const[o,a,u]=this.#f(t),[l,c]=this.#l(o,a,u,Math.hypot(a,u)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),h=this.#h(c),d=this.#o(l,a,u,h);return this.processDrawnLines({lines:{curves:d,width:a,height:u},pageWidth:e,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:o,areContours:a}){s%180!==0&&([e,i]=[i,e]);const{curves:u,width:l,height:c}=t,h=t.thickness??0,d=[],f=Math.min(e/l,i/c),p=f/e,g=f/i,b=[];for(const{points:A}of u){const y=o?this.#a(A):A;if(!y)continue;b.push(y);const _=y.length,x=new Float32Array(_),v=new Float32Array(3*(_===2?2:_-2));if(d.push({line:v,points:x}),_===2){x[0]=y[0]*p,x[1]=y[1]*g,v.set([NaN,NaN,NaN,NaN,x[0],x[1]],0);continue}let[S,M,R,j]=y;S*=p,M*=g,R*=p,j*=g,x.set([S,M,R,j],0),v.set([NaN,NaN,NaN,NaN,S,M],0);for(let I=4;I<_;I+=2){const Y=x[I]=y[I]*p,dt=x[I+1]=y[I+1]*g;v.set(K.createBezierPoints(S,M,R,j,Y,dt),(I-2)*3),[S,M,R,j]=[R,j,Y,dt]}}if(d.length===0)return null;const m=a?new Ma:new Gs;return m.build(d,e,i,1,s,a?0:h,r),{outline:m,newCurves:b,areContours:a,thickness:h,width:l,height:c}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:s,height:r}){let o=1/0,a=-1/0,u=0;for(const y of t){u+=y.length;for(let _=2,x=y.length;_<x;_++){const v=y[_]-y[_-2];o=Math.min(o,v),a=Math.max(a,v)}}let l;o>=-128&&a<=127?l=Int8Array:o>=-32768&&a<=32767?l=Int16Array:l=Int32Array;const c=t.length,h=cr+us*c,d=new Uint32Array(h);let f=0;d[f++]=h*Uint32Array.BYTES_PER_ELEMENT+(u-2*c)*l.BYTES_PER_ELEMENT,d[f++]=0,d[f++]=s,d[f++]=r,d[f++]=e?0:1,d[f++]=Math.max(0,Math.floor(i??0)),d[f++]=c,d[f++]=l.BYTES_PER_ELEMENT;for(const y of t)d[f++]=y.length-2,d[f++]=y[0],d[f++]=y[1];const p=new CompressionStream("deflate-raw"),g=p.writable.getWriter();await g.ready,g.write(d);const b=l.prototype.constructor;for(const y of t){const _=new b(y.length-2);for(let x=2,v=y.length;x<v;x++)_[x-2]=y[x]-y[x-2];g.write(_)}g.close();const m=await new Response(p.readable).arrayBuffer();return new Uint8Array(m).toBase64()}static async decompressSignature(t){try{const e=Uint8Array.fromBase64(t),{readable:i,writable:s}=new DecompressionStream("deflate-raw"),r=s.getWriter();await r.ready,r.write(e).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let o=null,a=0;for await(const y of i)o||=new Uint8Array(new Uint32Array(y.buffer,0,4)[0]),o.set(y,a),a+=y.length;const u=new Uint32Array(o.buffer,0,o.length>>2),l=u[1];if(l!==0)throw new Error(`Invalid version: ${l}`);const c=u[2],h=u[3],d=u[4]===0,f=u[5],p=u[6],g=u[7],b=[],m=(cr+us*p)*Uint32Array.BYTES_PER_ELEMENT;let A;switch(g){case Int8Array.BYTES_PER_ELEMENT:A=new Int8Array(o.buffer,m);break;case Int16Array.BYTES_PER_ELEMENT:A=new Int16Array(o.buffer,m);break;case Int32Array.BYTES_PER_ELEMENT:A=new Int32Array(o.buffer,m);break}a=0;for(let y=0;y<p;y++){const _=u[us*y+cr],x=new Float32Array(_+2);b.push(x);for(let v=0;v<us-1;v++)x[v]=u[us*y+cr+v+1];for(let v=0;v<_;v++)x[v+2]=x[v]+A[a++]}return{areContours:d,thickness:f,outlines:b,width:c,height:h}}catch(e){return at(`decompressSignature: ${e}`),null}}}class wu extends sf{constructor(){super(),super.updateProperties({fill:tt._defaultLineColor,"stroke-width":0})}clone(){const t=new wu;return t.updateAll(this),t}}class vu extends ao{constructor(t){super(t),super.updateProperties({stroke:tt._defaultLineColor,"stroke-width":1})}clone(){const t=new vu(this._viewParameters);return t.updateAll(this),t}}class cn extends wt{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=ct.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){tt.initialize(t,e),this._defaultDrawingOptions=new wu,this._defaultDrawnSignatureOptions=new vu(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return ut(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:s,mustSmooth:r,areContours:o,description:a,uuid:u,heightInPage:l}=this.#i,{rawDims:{pageWidth:c,pageHeight:h},rotation:d}=this.parent.viewport,f=Ei.processDrawnLines({lines:s,pageWidth:c,pageHeight:h,rotation:d,innerMargin:cn._INNER_MARGIN,mustSmooth:r,areContours:o});this.addSignature(f,l,a,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:s,height:r}=this.#i,o=Math.max(s,r),a=Ei.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:s,height:r},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:a.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,s){const{x:r,y:o}=this,{outline:a}=this.#i=t;this.#t=a instanceof Ma,this.description=i;let u;this.#t?u=cn.getDefaultDrawingOptions():(u=cn._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":a.thickness})),this._addOutlines({drawOutlines:a,drawingOptions:u});const[,l]=this.pageDimensions;let c=e/l;c=c>=1?.5:c,this.width*=c/this.height,this.width>=1&&(c*=.9/this.width,this.width=.9),this.height=c,this.setDims(),this.x=r,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:s}=this.parent.viewport;return Ei.process(t,e,i,s,cn._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return Ei.extractContoursFromText(t,e,i,s,r,cn._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:s}=this.parent.viewport;return Ei.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:s,innerMargin:cn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=cn.getDefaultDrawingOptions():(this._drawingOptions=cn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,r=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:s});return this.addComment(r),t?(r.paths={lines:e,points:i},r.uuid=this.#n,r.isCopy=!0):r.lines=e,this.#e&&(r.accessibilityData={type:"Figure",alt:this.#e}),r}static deserializeDraw(t,e,i,s,r,o){return o.areContours?Ma.deserialize(t,e,i,s,r,o):Gs.deserialize(t,e,i,s,r,o)}static async deserialize(t,e,i){const s=await super.deserialize(t,e,i);return s.#t=t.areContours,s.description=t.accessibilityData?.alt||"",s.#n=t.uuid,s}}class Wy extends tt{#t=null;#e=null;#i=null;#n=null;#r=null;#o="";#s=null;#a=!1;#l=null;#u=!1;#d=!1;static _type="stamp";static _editorType=ct.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){tt.initialize(t,e)}static isHandlingMimeForPasting(t){return xa.includes(t)}static paste(t,e){e.pasteEditor({mode:ct.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#u=t.isSvg),t.file&&(this.#o=t.file.name),this.#g()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:r,height:o}=t||this.copyCanvas(null,null,!0).imageData,a=await i.guess({name:"altText",request:{data:s,width:r,height:o,channels:s.length/(r*o)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");const u=a.output;return await this.setGuessedAltText(u),e&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#h(i,!0)).finally(()=>this.#f());return}if(this.#n){const i=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(i).then(s=>this.#h(s)).finally(()=>this.#f());return}if(this.#r){const i=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(i).then(s=>this.#h(s)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=xa.join(",");const e=this._uiManager._signal;this.#i=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(s)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#l&&(clearTimeout(this.#l),this.#l=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#r||this.#e||this.#a)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#a||(this.#t?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,s&&(this.#t=s),this.#a=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#l!==null&&clearTimeout(this.#l);const t=200;this.#l=setTimeout(()=>{this.#l=null,this.#p()},t)}#g(){const{div:t}=this;let{width:e,height:i}=this.#t;const[s,r]=this.pageDimensions,o=.75;if(this.width)e=this.width*s,i=this.height*r;else if(e>o*s||i>o*r){const u=Math.min(o*s/e,o*r/i);e*=u,i*=u}this._uiManager.enableWaiting(!1);const a=this.#s=document.createElement("canvas");a.setAttribute("role","img"),this.addContainer(a),this.width=e/s,this.height=i/r,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#o&&this.div.setAttribute("aria-description",this.#o),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:s,height:r}=this.#t,o=new bn;let a=this.#t,u=s,l=r,c=null;if(e){if(s>e||r>e){const v=Math.min(e/s,e/r);u=Math.floor(s*v),l=Math.floor(r*v)}c=document.createElement("canvas");const d=c.width=Math.ceil(u*o.sx),f=c.height=Math.ceil(l*o.sy);this.#u||(a=this.#c(d,f));const p=c.getContext("2d");p.filter=this._uiManager.hcmFilter;let g="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":f2.isDarkMode&&(g="#8f8f9d",b="#42414d");const m=15,A=m*o.sx,y=m*o.sy,_=new OffscreenCanvas(A*2,y*2),x=_.getContext("2d");x.fillStyle=g,x.fillRect(0,0,A*2,y*2),x.fillStyle=b,x.fillRect(0,0,A,y),x.fillRect(A,y,A,y),p.fillStyle=p.createPattern(_,"repeat"),p.fillRect(0,0,d,f),p.drawImage(a,0,0,a.width,a.height,0,0,d,f)}let h=null;if(i){let d,f;if(o.symmetric&&a.width<t&&a.height<t)d=a.width,f=a.height;else if(a=this.#t,s>t||r>t){const b=Math.min(t/s,t/r);d=Math.floor(s*b),f=Math.floor(r*b),this.#u||(a=this.#c(d,f))}const g=new OffscreenCanvas(d,f).getContext("2d",{willReadFrequently:!0});g.drawImage(a,0,0,a.width,a.height,0,0,d,f),h={width:d,height:f,data:g.getImageData(0,0,d,f).data}}return{canvas:c,width:u,height:l,imageData:h}}#c(t,e){const{width:i,height:s}=this.#t;let r=i,o=s,a=this.#t;for(;r>2*t||o>2*e;){const u=r,l=o;r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const c=new OffscreenCanvas(r,o);c.getContext("2d").drawImage(a,0,0,u,l,0,0,r,o),a=c.transferToImageBitmap()}return a}#p(){const[t,e]=this.parentDimensions,{width:i,height:s}=this,r=new bn,o=Math.ceil(i*t*r.sx),a=Math.ceil(s*e*r.sy),u=this.#s;if(!u||u.width===o&&u.height===a)return;u.width=o,u.height=a;const l=this.#u?this.#t:this.#c(o,a),c=u.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,o,a)}#b(t){if(t){if(this.#u){const s=this._uiManager.imageManager.getSvgUrl(this.#e);if(s)return s}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#u){const[e,i]=this.pageDimensions,s=Math.round(this.width*e*ji.PDF_TO_CSS_UNITS),r=Math.round(this.height*i*ji.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,r);return o.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,s,r),o.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let s=null,r=!1;if(t instanceof ef){const{data:{rect:g,rotation:b,id:m,structParent:A,popupRef:y,richText:_,contentsObj:x,creationDate:v,modificationDate:S},container:M,parent:{page:{pageNumber:R}},canvas:j}=t;let I,Y;j?(delete t.canvas,{id:I,bitmap:Y}=i.imageManager.getFromCanvas(M.id,j),j.remove()):(r=!0,t._hasNoCanvas=!0);const dt=(await e._structTree.getAriaAttributes(`${Ci}${m}`))?.get("aria-label")||"";s=t={annotationType:ct.STAMP,bitmapId:I,bitmap:Y,pageIndex:R-1,rect:g.slice(0),rotation:b,annotationElementId:m,id:m,deleted:!1,accessibilityData:{decorative:!1,altText:dt},isSvg:!1,structParent:A,popupRef:y,richText:_,comment:x?.str||null,creationDate:v,modificationDate:S}}const o=await super.deserialize(t,e,i),{rect:a,bitmap:u,bitmapUrl:l,bitmapId:c,isSvg:h,accessibilityData:d}=t;r?(i.addMissingCanvas(t.id,o),o.#a=!0):c&&i.imageManager.isValidId(c)?(o.#e=c,u&&(o.#t=u)):o.#n=l,o.#u=h;const[f,p]=o.pageDimensions;return o.width=(a[2]-a[0])/f,o.height=(a[3]-a[1])/p,d&&(o.altTextData=d),o._initialData=s,t.comment&&o.setCommentData(t),o.#d=!!s,o}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#u});if(this.addComment(i),t)return i.bitmapUrl=this.#b(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:s,altText:r}=this.serializeAltText(!1);if(!s&&r&&(i.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const a=this.#A(i);return a.isSame?null:(a.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(e===null)return i;e.stamps||=new Map;const o=this.#u?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:o,serialized:i}),i.bitmap=this.#b(!1);else if(this.#u){const a=e.stamps.get(this.#e);o>a.area&&(a.area=o,a.serialized.bitmap.close(),a.serialized.bitmap=this.#b(!1))}return i}#A(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,s=t.pageIndex===e,r=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&r,isSameAltText:r}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Tn{#t;#e=!1;#i=null;#n=null;#r=null;#o=new Map;#s=!1;#a=!1;#l=!1;#u=null;#d=null;#h=null;#f=null;#m=null;#g=-1;#c;static _initialized=!1;static#p=new Map([ie,xu,Wy,Vt,cn].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:u,viewport:l,l10n:c}){const h=[...Tn.#p.values()];if(!Tn._initialized){Tn._initialized=!0;for(const d of h)d.initialize(c,t)}t.registerEditorTypes(h),this.#c=t,this.pageIndex=e,this.div=i,this.#t=r,this.#i=o,this.viewport=l,this.#h=u,this.drawLayer=a,this._structTree=s,this.#c.addLayer(this)}updatePageIndex(t){this.pageIndex=t}get isEmpty(){return this.#o.size===0}get isInvisible(){return this.isEmpty&&this.#c.getMode()===ct.NONE}updateToolbar(t){this.#c.updateToolbar(t)}updateMode(t=this.#c.getMode()){switch(this.#x(),t){case ct.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ct.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ct.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===ct.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of Tn.#p.values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#c.setEditingState(t)}addCommands(t){this.#c.addCommands(t)}cleanUndoStack(t){this.#c.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.togglePointerEvents(t)}get#b(){return this.#o.size!==0?this.#o.values():this.#c.getEditors(this.pageIndex)}async enable(){this.#l=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const i of this.#b)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#c.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=this.#i;if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),this.#c.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}this.#l=!1,this.#c._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#a=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const s=this.#c.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",r=>{const{clientX:a,clientY:u,timeStamp:l}=r,c=this.#g;if(l-c>500){this.#g=l;return}this.#g=-1;const{classList:h}=this.div;h.toggle("getElements",!0);const d=document.elementsFromPoint(a,u);if(h.toggle("getElements",!1),!this.div.contains(d[0]))return;let f;const p=new RegExp(`^${Ms}[0-9]+$`);for(const b of d)if(p.test(b.id)){f=b.id;break}if(!f)return;const g=this.#o.get(f);g?.annotationElementId===null&&(r.stopPropagation(),r.preventDefault(),g.dblclick(r))},{signal:s,capture:!0})}const t=this.#i,e=[];if(t){const s=new Map,r=new Map;for(const a of this.#b){if(a.disableEditing(),!a.annotationElementId){e.push(a);continue}if(a.serialize()!==null){s.set(a.annotationElementId,a);continue}else r.set(a.annotationElementId,a);this.getEditableAnnotation(a.annotationElementId)?.show(),a.remove()}const o=t.getEditableAnnotations();for(const a of o){const{id:u}=a.data;if(this.#c.isDeletedAnnotationElement(u)){a.updateEdited({deleted:!0});continue}let l=r.get(u);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=s.get(u),l&&(this.#c.addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}this.#x(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of Tn.#p.values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(e),this.#a=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#c.getActive()!==t&&this.#c.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#c.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#A.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#A(t){this.#c.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:i}=Zt.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#c.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),Vt.startHighlighting(this,this.#c.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#c._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#c.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#o.set(t.id,t);const{annotationElementId:e}=t;e&&this.#c.isDeletedAnnotationElement(e)&&this.#c.removeDeletedAnnotationElement(t)}detach(t){this.#o.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#a&&t.annotationElementId&&this.#c.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#c.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#c.addDeletedAnnotationElement(t),tt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#c.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#l),this.#c.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#c._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of this.#o.values())if(e.uid===t)return e;return null}getNextId(){return this.#c.getId()}get#y(){return Tn.#p.get(this.#c.getMode())}combinedSignal(t){return this.#c.combinedSignal(t)}#C(t){const e=this.#y;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#c.updateMode(t.mode);const{offsetX:i,offsetY:s}=this.#v(),r=this.getNextId(),o=this.#C({parent:this,id:r,x:i,y:s,uiManager:this.#c,isCentered:!0,...e});o&&this.add(o)}async deserialize(t){return await Tn.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#c)||null}createAndAddNewEditor(t,e,i={}){const s=this.getNextId(),r=this.#C({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#c,isCentered:e,...i});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}#v(){const{x:t,y:e,width:i,height:s}=this.boundingClientRect,r=Math.max(0,t),o=Math.max(0,e),a=Math.min(window.innerWidth,t+i),u=Math.min(window.innerHeight,e+s),l=(r+a)/2-t,c=(o+u)/2-e,[h,d]=this.viewport.rotation%180===0?[l,c]:[c,l];return{offsetX:h,offsetY:d}}addNewEditor(t={}){this.createAndAddNewEditor(this.#v(),!0,t)}setSelected(t){this.#c.setSelected(t)}toggleSelected(t){this.#c.toggleSelected(t)}unselect(t){this.#c.unselect(t)}pointerup(t){const{isMac:e}=Zt.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#s||(this.#s=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#c.getMode();if(i===ct.STAMP||i===ct.SIGNATURE){this.#c.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#c.getMode()===ct.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:e}=Zt.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#s=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const i=this.#c.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#u){this.#y.startDrawing(this,this.#c,!1,t);return}this.#c.setCurrentDrawingSession(this),this.#u=new AbortController;const e=this.#c.combinedSignal(this.#u);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#y.startDrawing(this,this.#c,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#u?(this.#c.setCurrentDrawingSession(null),this.#u.abort(),this.#u=null,this.#d=null,this.#y.endDrawing(t)):null}findNewParent(t,e,i){const s=this.#c.findParent(e,i);return s===null||s===this?!1:(s.changeParent(t),!0)}commitOrRemove(){return this.#u?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#u&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#c.getActive()?.parent===this&&(this.#c.commitOrRemove(),this.#c.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#o.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#o.clear(),this.#c.removeLayer(this)}#x(){for(const t of this.#o.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,ui(this.div,t);for(const e of this.#c.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#c.commitOrRemove(),this.#x();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,ui(this.div,{rotation:i}),e!==i)for(const s of this.#o.values())s.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#c.viewParameters.realScale}}class ae{#t=null;#e=new Map;#i=new Map;static#n=0;setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return ut(this,"_svgFactory",new Lr)}static#r(t,[e,i,s,r]){const{style:o}=t;o.top=`${100*i}%`,o.left=`${100*e}%`,o.width=`${100*s}%`,o.height=`${100*r}%`}#o(){const t=ae._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,e){const i=ae._svgFactory.createElement("clipPath");t.append(i);const s=`clip_${e}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=ae._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),s}#a(t,e){for(const[i,s]of Object.entries(e))s===null?t.removeAttribute(i):t.setAttribute(i,s)}draw(t,e=!1,i=!1){const s=ae.#n++,r=this.#o(),o=ae._svgFactory.createElement("defs");r.append(o);const a=ae._svgFactory.createElement("path");o.append(a);const u=`path_${s}`;a.setAttribute("id",u),a.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(s,a);const l=i?this.#s(o,u):null,c=ae._svgFactory.createElement("use");return r.append(c),c.setAttribute("href",`#${u}`),this.updateProperties(r,t),this.#e.set(s,r),{id:s,clipPathId:`url(#${l})`}}drawOutline(t,e){const i=ae.#n++,s=this.#o(),r=ae._svgFactory.createElement("defs");s.append(r);const o=ae._svgFactory.createElement("path");r.append(o);const a=`path_${i}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let u;if(e){const h=ae._svgFactory.createElement("mask");r.append(h),u=`mask_${i}`,h.setAttribute("id",u),h.setAttribute("maskUnits","objectBoundingBox");const d=ae._svgFactory.createElement("rect");h.append(d),d.setAttribute("width","1"),d.setAttribute("height","1"),d.setAttribute("fill","white");const f=ae._svgFactory.createElement("use");h.append(f),f.setAttribute("href",`#${a}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const l=ae._svgFactory.createElement("use");s.append(l),l.setAttribute("href",`#${a}`),u&&l.setAttribute("mask",`url(#${u})`);const c=l.cloneNode();return s.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.updateProperties(s,t),this.#e.set(i,s),i}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:s,rootClass:r,path:o}=e,a=typeof t=="number"?this.#e.get(t):t;if(a){if(i&&this.#a(a,i),s&&ae.#r(a,s),r){const{classList:u}=a;for(const[l,c]of Object.entries(r))u.toggle(l,c)}if(o){const l=a.firstElementChild.firstElementChild;this.#a(l,o)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:ka};globalThis.pdfjsLib={AbortException:Yn,AnnotationEditorLayer:Tn,AnnotationEditorParamsType:yt,AnnotationEditorType:ct,AnnotationEditorUIManager:Kn,AnnotationLayer:_u,AnnotationMode:jn,AnnotationType:Xt,applyOpacity:g2,build:wy,ColorPicker:Ge,createValidAbsoluteUrl:vd,CSSConstants:p2,DOMSVGFactory:Lr,DrawLayer:ae,FeatureTest:Zt,fetchData:Hs,findContrastColor:m2,getDocument:qd,getFilenameFromUrl:u2,getPdfFilenameFromUrl:l2,getRGB:$s,getUuid:Cd,getXfaPageViewport:h2,GlobalWorkerOptions:Bi,ImageKind:yr,InvalidPDFException:Aa,isDataScheme:to,isPdfFile:cu,isValidExplicitDest:T2,MathClamp:ue,noContextMenu:Xe,normalizeUnicode:o2,OPS:Ps,OutputScale:bn,PagesMapper:vt,PasswordResponses:K1,PDFDataRangeTransport:Xd,PDFDateString:_a,PDFWorker:Rs,PermissionFlag:Y1,PixelsPerInch:ji,RenderingCancelledException:lu,renderRichText:Td,ResponseException:Rr,setLayerDimensions:ui,shadow:ut,SignatureExtractor:Ei,stopEvent:jt,SupportedImageMimeTypes:xa,TextLayer:Ne,TouchManager:eo,updateUrlHash:Ed,Util:X,VerbosityLevel:Kr,version:xy,XfaLayer:Sd};const qy="/md-editor/assets/pdf.worker.min-wgc6bjNh.mjs";var wc=/highlight-(?:text|source)-([a-z0-9]+)/;function Xy(n){n.addRule("highlightedCodeBlock",{filter:function(t){var e=t.firstChild;return t.nodeName==="DIV"&&wc.test(t.className)&&e&&e.nodeName==="PRE"},replacement:function(t,e,i){var s=e.className||"",r=(s.match(wc)||[null,""])[1];return`

`+i.fence+r+`
`+e.firstChild.textContent+`
`+i.fence+`

`}})}function Yy(n){n.addRule("strikethrough",{filter:["del","s","strike"],replacement:function(t){return"~"+t+"~"}})}var Ky=Array.prototype.indexOf,Zy=Array.prototype.every,Gi={};Gi.tableCell={filter:["th","td"],replacement:function(n,t){return rf(n,t)}};Gi.tableRow={filter:"tr",replacement:function(n,t){var e="",i={left:":--",right:"--:",center:":-:"};if(Eu(t))for(var s=0;s<t.childNodes.length;s++){var r="---",o=(t.childNodes[s].getAttribute("align")||"").toLowerCase();o&&(r=i[o]||r),e+=rf(r,t.childNodes[s])}return`
`+n+(e?`
`+e:"")}};Gi.table={filter:function(n){return n.nodeName==="TABLE"&&Eu(n.rows[0])},replacement:function(n){return n=n.replace(`

`,`
`),`

`+n+`

`}};Gi.tableSection={filter:["thead","tbody","tfoot"],replacement:function(n){return n}};function Eu(n){var t=n.parentNode;return t.nodeName==="THEAD"||t.firstChild===n&&(t.nodeName==="TABLE"||Jy(t))&&Zy.call(n.childNodes,function(e){return e.nodeName==="TH"})}function Jy(n){var t=n.previousSibling;return n.nodeName==="TBODY"&&(!t||t.nodeName==="THEAD"&&/^\s*$/i.test(t.textContent))}function rf(n,t){var e=Ky.call(t.parentNode.childNodes,t),i=" ";return e===0&&(i="| "),i+n+" |"}function Qy(n){n.keep(function(e){return e.nodeName==="TABLE"&&!Eu(e.rows[0])});for(var t in Gi)n.addRule(t,Gi[t])}function tA(n){n.addRule("taskListItems",{filter:function(t){return t.type==="checkbox"&&t.parentNode.nodeName==="LI"},replacement:function(t,e){return(e.checked?"[x]":"[ ]")+" "}})}function eA(n){n.use([Xy,Yy,Qy,tA])}const nA={class:"border-b bg-card/50 backdrop-blur supports-[backdrop-filter]:bg-card/60"},iA={class:"container flex h-14 items-center justify-between"},sA={class:"flex items-center gap-2"},rA={class:"inline-flex rounded-md border bg-background p-0.5"},oA=["aria-pressed"],aA=["aria-pressed"],uA=["aria-pressed"],lA={class:"container py-6"},cA={key:0,class:"mb-4 rounded-md border bg-card p-3 text-sm"},hA={key:0,class:"text-muted-foreground"},dA={key:1,class:"text-destructive"},fA={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},pA={class:"flex flex-col rounded-lg border bg-card shadow-sm"},gA={class:"p-3 md:p-4"},mA={class:"flex flex-col rounded-lg border bg-card shadow-sm"},bA={class:"flex items-center justify-between gap-2 border-b p-3 md:p-4"},yA={class:"flex items-center gap-2"},AA={class:"p-3 md:p-4"},_A=["innerHTML"],xA={key:0,class:"pointer-events-none absolute inset-0 z-30 flex items-center justify-center bg-background/70 backdrop-blur-sm"},wA={class:"rounded-lg border bg-card px-5 py-4 text-center shadow-lg"},vA={class:"text-sm font-medium"},EA=10*1024*1024,vc=100,Ko="theme",CA=nh({__name:"App",setup(n){Bi.workerSrc=qy;const t=new We({html:!1,linkify:!0,typographer:!0,breaks:!0}),e=Zn(`# Markdown Editor

Live preview on the right. Try editing this text.

## Features

- 50/50 split layout (desktop-first)
- Instant preview while typing
- One-click rich copy for Google Docs

### Formatting examples

**Bold**, _italic_, and \`code\`.

> Blockquotes work too.

1. Ordered list
2. Keeps formatting when pasted into Google Docs

[Vue](https://vuejs.org/)  [Tailwind](https://tailwindcss.com/)`),i=Tr(()=>{const T=t.render(e.value);return No.sanitize(T)}),s=Zn(null),r=Zn(!1),o=Zn(""),a=Zn(""),u=Zn(0),l=Tr(()=>u.value>0),c=new Fr({headingStyle:"atx",codeBlockStyle:"fenced",emDelimiter:"*",bulletListMarker:"-"});c.use(eA),c.addRule("tables",{filter:"table",replacement:function(T,D){const B=Array.from(D.querySelectorAll("tr"));if(B.length===0)return T;let rt=`
`;return B.forEach((W,ot)=>{const nt=Array.from(W.querySelectorAll("td, th"));if(nt.length===0)return;const Ft=nt.map($t=>{let lt=$t.textContent||"";return lt=lt.trim().replace(/\s+/g," "),lt||" "});rt+="| "+Ft.join(" | ")+` |
`,ot===0&&(rt+="| "+Ft.map(()=>"---").join(" | ")+` |
`)}),rt+`
`}}),c.addRule("cleanSpans",{filter:["span"],replacement:function(T){return T}}),c.addRule("cleanDivs",{filter:["div","p"],replacement:function(T,D){return T+`
`}});function h(T){if(!T.clipboardData)return;T.preventDefault();const D=T.clipboardData.getData("text/html"),B=T.clipboardData.getData("text/plain");try{if(D){let rt=No.sanitize(D,{ALLOWED_TAGS:["table","tbody","thead","tr","td","th","p","div","span","strong","b","em","i","u","a","ul","ol","li","h1","h2","h3","h4","h5","h6","br"],ALLOWED_ATTR:["href"]});const ot=c.turndown(rt).replace(/\n{3,}/g,`

`).replace(/^\s+|\s+$/g,"").replace(/\|\s*\|\s*\|/g,"| | |");e.value=ot}else B&&(e.value=B)}catch(rt){if(console.error("Error converting HTML to Markdown:",rt),B)e.value=B;else{const W=document.createElement("div");W.innerHTML=No.sanitize(D),e.value=W.textContent||W.innerText||""}}}function d(T){return T.type==="application/pdf"||/\.pdf$/i.test(T.name)}function f(T){if(!T)return null;for(const D of Array.from(T))if(d(D))return D;return null}function p(T){if(T.length===0)return 0;const D=[...T].sort((rt,W)=>rt-W),B=Math.floor(D.length/2);return D.length%2===0?(D[B-1]+D[B])/2:D[B]}function g(T){return Math.round(T/2)*2}function b(T){const D=new Map;for(const W of T.items||[]){const ot=String(W.str||"").replace(/\s+/g," ").trim();if(!ot)continue;const nt=Array.isArray(W.transform)?W.transform:[],Ft=Number(nt[4]||0),$t=Number(nt[5]||0),lt=Number(W.width||Math.max(4,ot.length*4)),re=Math.abs(Number(nt[0]||nt[3]||W.height||12)),w=g($t),E=D.get(w)||[];E.push({text:ot,x:Ft,width:lt,fontSize:re}),D.set(w,E)}const B=Array.from(D.entries()).map(([W,ot])=>({y:W,segments:ot.sort((nt,Ft)=>nt.x-Ft.x)})).sort((W,ot)=>ot.y-W.y),rt=[];for(let W=0;W<B.length;W+=1){const ot=B[W];let nt="",Ft=!1,$t=0,lt=5;ot.segments.forEach((P,F)=>{if(F>0){const G=P.x-$t,$=Math.max(24,lt*6),z=Math.max(6,lt*1.75);G>$?(nt+="	",Ft=!0):G>z&&(nt+=" ")}nt+=P.text,$t=P.x+P.width,lt=P.width/Math.max(P.text.length,1)});const re=nt.replace(/[ \t]+$/g,"").replace(/[ ]{2,}/g," ");if(!re)continue;const w=ot.segments.reduce((P,F)=>P+F.fontSize,0)/ot.segments.length,E=B[W+1],L=(E?Math.abs(ot.y-E.y):0)>w*1.7;rt.push({text:re,hasTabs:Ft,fontSize:w,breakAfter:L})}return rt}function m(T,D,B){const rt=T.trim();return!rt||rt.length>90||/^[-*]\s+/.test(rt)||/^\d+[\.\)]\s+/.test(rt)||rt.includes("	")||D/Math.max(B,1)<1.28?!1:rt.split(/\s+/).length<=14}function A(T,D){const B=T/Math.max(D,1);return B>=1.95?1:B>=1.65?2:3}function y(T){return T.replace(/^[]\s*/u,"- ").replace(/^\((\d+)\)\s+/,"$1. ")}function _(T){return T.split("	").map(D=>D.trim())}function x(T){return T.map(D=>y(D.text.replace(/\t+/g," ").replace(/[ ]{2,}/g," ").trim()))}function v(T){const D=T.map(lt=>_(lt.text)),B=Math.min(...D.map(lt=>lt.length)),rt=Math.max(...D.map(lt=>lt.length));if(D.length<2||rt<2||rt-B>1)return x(T);const W=rt,ot=D.map(lt=>{const re=lt.map(w=>w.replace(/\|/g,"\\|").trim());for(;re.length<W;)re.push("");return re.slice(0,W)}),nt=`| ${ot[0].join(" | ")} |`,Ft=`| ${Array.from({length:W},()=>"---").join(" | ")} |`,$t=ot.slice(1).map(lt=>`| ${lt.join(" | ")} |`);return[nt,Ft,...$t]}function S(T,D){const B=[];for(let rt=0;rt<T.length;rt+=1){const W=T[rt];if(W.hasTabs){const nt=[W];for(;rt+1<T.length&&T[rt+1].hasTabs;)nt.push(T[rt+1]),rt+=1;B.push(...v(nt)),B.push("");continue}const ot=y(W.text.trim());if(!ot){B.push("");continue}if(m(ot,W.fontSize,D)){const nt=A(W.fontSize,D);B.push(`${"#".repeat(nt)} ${ot}`)}else B.push(ot);W.breakAfter&&B.push("")}return B.join(`
`).replace(/\n{3,}/g,`

`).replace(/[ \t]+\n/g,`
`).trim()}async function M(T){const D=new Uint8Array(await T.arrayBuffer()),B=await qd({data:D,useSystemFonts:!0}).promise;if(B.numPages>vc)throw new Error(`This PDF has ${B.numPages} pages. Limit is ${vc}.`);const rt=[];for(let lt=1;lt<=B.numPages;lt+=1){o.value=`Reading page ${lt}/${B.numPages}...`;const w=await(await B.getPage(lt)).getTextContent({normalizeWhitespace:!0,disableCombineTextItems:!1});rt.push(b(w))}const W=rt.flat();if(W.length===0)throw new Error("No selectable text was found. This PDF may be scanned; OCR is not enabled yet.");const ot=W.filter(lt=>lt.text.length>=20&&!lt.hasTabs).map(lt=>lt.fontSize),nt=W.map(lt=>lt.fontSize),Ft=p(ot.length>0?ot:nt)||12;return rt.map(lt=>S(lt,Ft)).filter(Boolean).join(`

---

`).trim()}async function R(T){if(a.value="",o.value="",!d(T)){a.value="Only PDF files are supported.";return}if(T.size>EA){a.value=`File is too large (${(T.size/(1024*1024)).toFixed(1)} MB). Limit is 10 MB.`;return}r.value=!0;try{o.value="Loading PDF parser...";const D=await M(T);e.value=D,o.value=`Imported ${T.name}`}catch(D){console.error("PDF import failed:",D),a.value=D instanceof Error?D.message:"PDF import failed.",o.value=""}finally{r.value=!1}}function j(T){T.dataTransfer&&Array.from(T.dataTransfer.types).includes("Files")&&(u.value+=1)}function I(T){T.dataTransfer&&(T.preventDefault(),T.dataTransfer.dropEffect="copy")}function Y(){u.value=Math.max(0,u.value-1)}async function dt(T){T.preventDefault(),u.value=0;const D=f(T.dataTransfer?.files||null);if(!D){a.value="Drop a PDF file to import.";return}await R(D)}function et(T){["insertFromPaste","insertFromDrop"].includes(T.inputType)||T.preventDefault()}async function mt(){const T=i.value,D=e.value;if(s.value){const B=document.createRange();B.selectNodeContents(s.value);const rt=window.getSelection();rt?.removeAllRanges(),rt?.addRange(B)}try{if(navigator.clipboard&&window.ClipboardItem){const B=new window.ClipboardItem({"text/html":new Blob([T],{type:"text/html"}),"text/plain":new Blob([D],{type:"text/plain"})});await navigator.clipboard.write([B])}else document.execCommand("copy")}catch{await navigator.clipboard.writeText(D)}}const U=Zn(localStorage.getItem(Ko)||"auto");let O=null,q=null;function At(T){if(typeof window.__setTheme=="function"){window.__setTheme(T);return}O||(O=window.matchMedia("(prefers-color-scheme: dark)")),T==="dark"?document.documentElement.classList.add("dark"):T==="light"?document.documentElement.classList.remove("dark"):document.documentElement.classList.toggle("dark",!!O.matches)}function Ot(T){U.value=T}return pr(U,T=>{try{T==="auto"?localStorage.removeItem(Ko):localStorage.setItem(Ko,T)}catch{}At(T)}),oh(()=>{O=window.matchMedia("(prefers-color-scheme: dark)"),q=()=>{U.value==="auto"&&At("auto")},typeof O.addEventListener=="function"?O.addEventListener("change",q):typeof O.addListener=="function"&&O.addListener(q),At(U.value)}),ah(()=>{O&&q&&(typeof O.removeEventListener=="function"?O.removeEventListener("change",q):typeof O.removeListener=="function"&&O.removeListener(q))}),(T,D)=>(Pn(),_i("div",{class:"relative min-h-screen w-full bg-background bg-app-gradient",onDragenter:j,onDragover:Eo(I,["prevent"]),onDragleave:Y,onDrop:dt},[xt("header",nA,[xt("div",iA,[D[6]||(D[6]=xt("div",{class:"flex items-center gap-2"},[xt("img",{src:Op,alt:"MD Editor",class:"h-6 w-6","aria-hidden":"true"}),xt("span",{class:"font-semibold tracking-tight"},"MD Editor")],-1)),xt("div",sA,[D[5]||(D[5]=xt("span",{class:"hidden text-xs text-muted-foreground sm:inline"},"Theme",-1)),xt("div",rA,[xt("button",{type:"button",class:ri(["px-2.5 py-1 text-xs rounded-md transition-colors",U.value==="auto"?"bg-secondary text-secondary-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"]),onClick:D[0]||(D[0]=B=>Ot("auto")),"aria-pressed":U.value==="auto"},"Auto",10,oA),xt("button",{type:"button",class:ri(["px-2.5 py-1 text-xs rounded-md transition-colors",U.value==="light"?"bg-secondary text-secondary-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"]),onClick:D[1]||(D[1]=B=>Ot("light")),"aria-pressed":U.value==="light"},"Light",10,aA),xt("button",{type:"button",class:ri(["px-2.5 py-1 text-xs rounded-md transition-colors",U.value==="dark"?"bg-secondary text-secondary-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"]),onClick:D[2]||(D[2]=B=>Ot("dark")),"aria-pressed":U.value==="dark"},"Dark",10,uA)])])])]),xt("main",lA,[o.value||a.value?(Pn(),_i("div",cA,[o.value?(Pn(),_i("p",hA,dr(o.value),1)):Zs("",!0),a.value?(Pn(),_i("p",dA,dr(a.value),1)):Zs("",!0)])):Zs("",!0),xt("div",fA,[xt("section",pA,[D[7]||(D[7]=xt("div",{class:"flex items-center justify-between border-b p-3 md:p-4"},[xt("h2",{class:"text-sm font-medium tracking-tight"},"Markdown"),xt("span",{class:"text-xs text-muted-foreground"},"Editable")],-1)),xt("div",gA,[n0(xt("textarea",{"onUpdate:modelValue":D[3]||(D[3]=B=>e.value=B),class:"min-h-[65vh] w-full resize-vertical rounded-md border bg-background p-3 font-mono text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",spellcheck:"false",placeholder:"Type your Markdown here..."},null,512),[[kp,e.value]])])]),xt("section",mA,[xt("div",bA,[D[10]||(D[10]=xt("h2",{class:"text-sm font-medium tracking-tight"},"Preview",-1)),xt("div",yA,[D[9]||(D[9]=xt("span",{class:"hidden text-xs text-muted-foreground sm:inline"},"Drop PDF anywhere to import",-1)),Qe(v1,{size:"sm",variant:"secondary",onClick:mt},{default:eh(()=>[...D[8]||(D[8]=[Dh("Copy formatted",-1)])]),_:1})])]),xt("div",AA,[xt("div",{ref_key:"previewRef",ref:s,class:"print-content prose max-w-none leading-relaxed outline-none",innerHTML:i.value,contenteditable:!0,tabindex:"0",role:"textbox","aria-label":"Markdown preview. Paste rich text here to convert to Markdown.",onPaste:Eo(h,["prevent"]),onBeforeinput:et,onDrop:D[4]||(D[4]=Eo(()=>{},["prevent"]))},null,40,_A)])])])]),l.value||r.value?(Pn(),_i("div",xA,[xt("div",wA,[xt("p",vA,dr(r.value?"Importing PDF...":"Drop PDF to import"),1),D[11]||(D[11]=xt("p",{class:"mt-1 text-xs text-muted-foreground"},"Up to 10 MB and 100 pages",-1))])])):Zs("",!0)],32))}}),SA=(n,t)=>{const e=n.__vccOpts||n;for(const[i,s]of t)e[i]=s;return e},TA=SA(CA,[["__scopeId","data-v-664dd0f4"]]);Rp(TA).mount("#app");
